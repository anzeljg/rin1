(function(Hb,Ib,Jb,Kb,Lb,Mb,Nb,Ob,Pb,Qb,Rb,Sb,Tb,Ub,Vb,Wb,Xb,Yb,Zb,$b,ac,bc,k,cc,dc,ec,fc,gc,hc,ic,jc,kc,R,lc,mc,nc,oc,ja,ua,C,Na,Oa,Pa,M,Qa,pc,S,Y,Fb,I,qc,rc,sc,tc,Gb){ua("J.script");Gb(J.script,"JmolScriptExtension");ua("J.scriptext");Na(["J.script.JmolScriptExtension"],"J.scriptext.ScriptExt","java.lang.Boolean $.Float $.Long $.Short java.util.Date $.Hashtable JU.AU $.BS $.CU $.List $.M3 $.M4 $.P3 $.P4 $.PT $.SB $.V3 J.api.Interface J.atomdata.RadiusData J.constant.EnumAxesMode $.EnumStereoMode $.EnumVdw J.i18n.GT J.modelset.Atom $.AtomCollection $.BondSet $.LabelToken J.script.SV $.ScriptCompiler $.ScriptEvaluator $.ScriptInterruption $.ScriptMathProcessor $.T J.util.BSUtil $.BoxInfo $.C $.ColorEncoder $.Elements $.Escape $.JmolEdge $.JmolMolecule $.Logger $.Measure $.Parser $.Point3fi $.Quaternion $.TempArray $.Txt J.viewer.FileManager $.JC $.StateManager $.Viewer".split(" "),
function(){c$=Pa(function(){this.sm=this.eval=this.viewer=null;this.chk=!1;this.st=this.thisCommand=this.fullCommand=null;this.slen=0;this.pm=this.$data=null;Oa(this,arguments)},J.scriptext,"ScriptExt",null,J.script.JmolScriptExtension);Qa(c$,function(){});R(c$,"init",function(b){this.eval=b;this.viewer=this.eval.viewer;this.sm=this.eval.sm;return this},"~O");R(c$,"dispatch",function(b,a,c){this.chk=this.eval.chk;this.fullCommand=this.eval.fullCommand;this.thisCommand=this.eval.thisCommand;this.slen=
this.eval.slen;this.st=c;switch(b){case 4098:this.assign();break;case 135270423:this.cache();break;case 4102:this.calculate();break;case 4103:this.capture();break;case 4105:this.centerAt();break;case 135270405:this.compare();break;case 528395:this.console();break;case 4106:this.connect(1);break;case 1095766024:this.configuration();break;case 1612189718:this.connect(0);break;case 1052700:this.mapProperty();break;case 4126:this.minimize();break;case 1276121113:this.modulation();break;case 4133:case 135270418:case 1052714:this.plot(c);
break;case 528443:this.stereo();break;case 4131:this.navigate();break;case 135270408:this.data();break;case 4148:this.show();break;case 135270422:this.write(null);break;case 23:return this.cgo();case 25:return this.contact();case 17:return this.dipole();case 22:return this.draw();case 24:case 29:case 28:return this.isosurface(b);case 26:return this.lcaoCartoon();case 6:return this.measure(),!0;case 27:return this.mo(a);case 21:return this.polyhedra();case 4:return this.struts()}return!1},"~N,~B,~A");
k(c$,"atomExpressionAt",function(b){return this.eval.atomExpressionAt(b)},"~N");k(c$,"error",function(b){this.eval.error(b)},"~N");k(c$,"invArg",function(){this.error(22)});k(c$,"invPO",function(){this.error(23)});k(c$,"getShapeProperty",function(b,a){return this.eval.getShapeProperty(b,a)},"~N,~S");k(c$,"parameterAsString",function(b){return this.eval.parameterAsString(b)},"~N");k(c$,"centerParameter",function(b){return this.eval.centerParameter(b)},"~N");k(c$,"floatParameter",function(b){return this.eval.floatParameter(b)},
"~N");k(c$,"getPoint3f",function(b,a){return this.eval.getPoint3f(b,a)},"~N,~B");k(c$,"getPoint4f",function(b){return this.eval.getPoint4f(b)},"~N");k(c$,"intParameter",function(b){return this.eval.intParameter(b)},"~N");k(c$,"isFloatParameter",function(b){return this.eval.isFloatParameter(b)},"~N");k(c$,"setShapeId",function(b,a,c){return this.eval.setShapeId(b,a,c)},"~N,~N,~B");k(c$,"setShapeProperty",function(b,a,c){this.eval.setShapeProperty(b,a,c)},"~N,~S,~O");k(c$,"stringParameter",function(b){return this.eval.stringParameter(b)},
"~N");k(c$,"getToken",function(b){return this.eval.getToken(b)},"~N");k(c$,"tokAt",function(b){return this.eval.tokAt(b)},"~N");k(c$,"cgo",function(){var b=this.eval;this.sm.loadShape(23);if(1073742001==this.tokAt(1)&&this.listIsosurface(23))return!1;var a=0,c=null!=this.initIsosurface(23),d=c&&null==this.getShapeProperty(23,"ID"),e=!1,f=null,g=3.4028235E38;b.colorArgb[0]=-2147483648;for(var h=0,j=b.iToken;j<this.slen;++j){var p=null,r=null;switch(this.getToken(j).tok){case 7:case 269484096:case 1073742195:(null!=
f||d)&&this.invArg();f=b.listParameter(j,2,2147483647);j=b.iToken;continue;case 1073742138:++j>=this.slen&&this.error(34);switch(this.getToken(j).tok){case 2:h=this.intParameter(j);continue;case 3:h=Math.round(100*this.floatParameter(j));continue}this.error(34);break;case 1766856708:case 603979967:case 1073742074:g=b.getColorTrans(j,!1);j=b.iToken;c=!0;continue;case 1074790550:this.setShapeId(23,++j,c);d=null==this.getShapeProperty(23,"ID");j=b.iToken;break;default:if(!b.setMeshDisplayProperty(23,
0,b.theTok)){if(269484209==b.theTok||J.script.T.tokAttr(b.theTok,1073741824)){this.setShapeId(23,j,c);j=b.iToken;break}this.invArg()}0==a&&(a=j);j=b.iToken;continue}c=12291!=b.theTok;null!=f&&!e&&(p="points",r=Integer.$valueOf(h),e=!0,h=0);null!=p&&this.setShapeProperty(23,p,r)}b.finalizeObject(23,b.colorArgb[0],g,h,null!=f,f,a,null);return!0});k(c$,"contact",function(){var b=this.eval;this.sm.loadShape(25);if(1073742001==this.tokAt(1)&&this.listIsosurface(25))return!1;var a=0;b.iToken=1;for(var c=
null!=this.initIsosurface(25),d=c&&null==this.getShapeProperty(25,"ID"),e=null,f=null,g=null,h=null,j=null,p=!1,r=new JU.SB,m=2147483647,n=135266319,k=0,q=NaN,y=NaN,w=!0,s=null,v=null,u=0,G=!1,B=1<b.iToken,x=b.iToken;x<this.slen;++x){switch(g=this.getToken(x).tok){default:B=!0;if(!b.setMeshDisplayProperty(25,0,b.theTok)){269484209!=b.theTok&&!J.script.T.tokAttr(b.theTok,1073741824)&&this.invArg();this.setShapeId(25,x,c);x=b.iToken;break}0==a&&(a=x);x=b.iToken;continue;case 1074790550:B=!0;this.setShapeId(25,
++x,c);d=null==this.getShapeProperty(25,"ID");x=b.iToken;break;case 1766856708:switch(this.tokAt(x+1)){case 1073741914:g=0;p=!0;r.append(" color density");x++;break;case 1141899272:g=0,G=!0,r.append(" color type"),x++}if(0==g)break;case 603979967:case 1073742074:B=!0;0==u&&(u=x);b.setMeshDisplayProperty(25,x,b.theTok);x=b.iToken;break;case 554176565:B=!0;v=this.getCapSlabObject(x,!1);this.setShapeProperty(25,"slab",v);x=b.iToken;break;case 1073741914:p=!0;r.append(" density");this.isFloatParameter(x+
1)&&(null==j&&(j=I(1,0)),j[0]=-Math.abs(this.floatParameter(++x)),r.append(" "+-j[0]));break;case 1073742122:c=this.floatParameter(++x);0<c&&(r.append(" resolution ").appendF(c),this.setShapeProperty(25,"resolution",Float.$valueOf(c)));break;case 135266325:case 1276118018:q=this.floatParameter(++x);r.append(" within ").appendF(q);break;case 269484193:case 2:case 3:h=b.encodeRadiusParameter(x,!1,!1);r.append(" ").appendO(h);x=b.iToken;break;case 1073741990:case 1073741989:s=1073741989==g?Boolean.TRUE:
Boolean.FALSE;r.append(" ").appendO(b.theToken.value);break;case 1073742020:m=this.intParameter(++x);break;case 1612189718:case 1073741881:case 1649412120:k=g;r.append(" ").appendO(b.theToken.value);break;case 1073742136:this.isFloatParameter(x+1)&&(y=this.floatParameter(++x));case 1074790451:case 1073742036:case 3145756:w=!1;case 1276117512:case 1073741961:case 135266319:case 4106:n=g;r.append(" ").appendO(b.theToken.value);1073742136==g&&r.append(" ").appendF(y);break;case 1073742083:j=b.floatParameterSet(++x,
1,10);x=b.iToken;break;case 10:case 1048577:(d||null!=f)&&this.invArg(),g=J.util.BSUtil.copy(this.atomExpressionAt(x)),x=b.iToken,null==e?e=g:f=g,r.append(" ").append(J.util.Escape.eBS(g))}c=12291!=b.theTok}!B&&null==e&&this.error(13);if(this.chk)return!1;if(null!=e){1649412120==k&&null==h&&(h=new J.atomdata.RadiusData(null,0,J.atomdata.RadiusData.EnumType.OFFSET,J.constant.EnumVdw.AUTO));x=null==h?new J.atomdata.RadiusData(null,0.26,J.atomdata.RadiusData.EnumType.OFFSET,J.constant.EnumVdw.AUTO):
h;f=1073742036==n&&null==f&&null!=s&&s.booleanValue()?e:this.setContactBitSets(e,f,w,q,x,!0);switch(n){case 1074790451:case 1073742136:x=b.lookupIdentifierValue("solvent");e.andNot(x);f.andNot(x);f.andNot(e);break;case 3145756:f.andNot(e);break;case 1073742036:2147483647==m&&(m=100),this.setShapeProperty(25,"minset",Integer.$valueOf(m)),r.append(" minSet ").appendI(m),null==j&&(j=[0.5,2])}null!=s&&(j=null==j?I(2,0):JU.AU.ensureLengthA(j,2),j[1]=s.booleanValue()?1:2);null!=j&&r.append(" parameters ").append(J.util.Escape.eAF(j));
this.setShapeProperty(25,"set",[Integer.$valueOf(k),Integer.$valueOf(n),Boolean.$valueOf(p),Boolean.$valueOf(G),e,f,h,Float.$valueOf(y),j,r.toString()]);0<u&&b.setMeshDisplayProperty(25,u,0)}0<a&&(b.setMeshDisplayProperty(25,a,0)||this.invArg());null!=v&&null!=e&&this.setShapeProperty(25,"slab",v);if(null!=e&&(1073742036==n||w)){b=this.getShapeProperty(25,"volume");if(JU.PT.isAD(b)){for(x=a=0;x<b.length;x++)a+=Math.abs(b[x]);b=Float.$valueOf(a)}a=this.getShapeProperty(25,"nSets").intValue();if(p||
1276117512!=n)this.showString((0==a?"":a+" contacts with ")+"net volume "+b+" A^3")}return!0});k(c$,"dipole",function(){var b=this.eval,a=null,c=null,d=!1,e=!1,f=!1;this.sm.loadShape(17);if(1073742001==this.tokAt(1)&&this.listIsosurface(17))return!1;this.setShapeProperty(17,"init",null);if(1==this.slen)return this.setShapeProperty(17,"thisID",null),!1;for(var g=1;g<this.slen;++g){c=a=null;switch(this.getToken(g).tok){case 1048589:a="on";break;case 1048588:a="off";break;case 12291:a="delete";break;
case 2:case 3:a="value";c=Float.$valueOf(this.floatParameter(g));break;case 10:a="atomBitset";case 1048577:null==a&&(a=d||e?"endSet":"startSet");c=this.atomExpressionAt(g);g=b.iToken;d=!0;break;case 1048586:case 8:c=this.getPoint3f(g,!0);g=b.iToken;a=d||e?"endCoord":"startCoord";e=!0;break;case 1678770178:a="bonds";break;case 4102:a="calculate";break;case 1074790550:this.setShapeId(17,++g,f);g=b.iToken;break;case 135267329:a="cross";c=Boolean.TRUE;break;case 1073742040:a="cross";c=Boolean.FALSE;break;
case 1073742066:c=this.floatParameter(++g);2==b.theTok?(a="offsetPercent",c=Integer.$valueOf(M(c))):(a="offset",c=Float.$valueOf(c));break;case 1073742068:a="offsetSide";c=Float.$valueOf(this.floatParameter(++g));break;case 1073742188:a="value";c=Float.$valueOf(this.floatParameter(++g));break;case 1073742196:a="width";c=Float.$valueOf(this.floatParameter(++g));break;default:if(269484209==b.theTok||J.script.T.tokAttr(b.theTok,1073741824)){this.setShapeId(17,g,f);g=b.iToken;break}this.invArg()}f=12291!=
b.theTok&&4102!=b.theTok;null!=a&&this.setShapeProperty(17,a,c)}(e||d)&&this.setShapeProperty(17,"set",null);return!0});k(c$,"draw",function(){var b=this.eval;this.sm.loadShape(22);switch(this.tokAt(1)){case 1073742001:if(this.listIsosurface(22))return!1;break;case 1073742102:return this.pointGroup(),!1;case 137363467:case 135270418:case 1052714:return this.plot(this.st),!1}var a=!1,c=!1,d=!1,e=!1,f=!1,g,h=0,j=3.4028235E38;b.colorArgb[0]=-2147483648;for(var p=0,r="",m=0,n=null,k=this.initIsosurface(22),
q=(g=null!=k)&&null==this.getShapeProperty(22,"ID"),y=null,w=0,s=b.iToken;s<this.slen;++s){var v=null,u=null;switch(this.getToken(s).tok){case 1614417948:case 1679429641:if(this.chk)break;a=this.viewer.getPlaneIntersection(b.theTok,null,p/100,0);p=0;v="polygon";u=a;a=!0;break;case 4106:y=Y(4,0);w=4;a=b.floatParameterSet(++s,4,4);s=b.iToken;for(g=0;4>g;g++)y[g]=M(a[g]);a=!0;break;case 1678770178:case 1141899265:if(null==y||w>(1095761924==b.theTok?2:3))w=0,y=[-1,-1,-1,-1];y[w++]=this.atomExpressionAt(++s).nextSetBit(0);
s=b.iToken;y[w++]=1678770178==b.theTok?this.atomExpressionAt(++s).nextSetBit(0):-1;s=b.iToken;a=!0;break;case 554176565:switch(this.getToken(++s).tok){case 1048583:v="slab";u=b.objectNameParameter(++s);s=b.iToken;a=!0;break;default:this.invArg()}break;case 135267842:switch(this.getToken(++s).tok){case 1614417948:case 1679429641:h=b.theTok;e=!0;continue;case 1048583:v="intersect";u=b.objectNameParameter(++s);s=b.iToken;a=e=!0;break;default:this.invArg()}break;case 1073742106:var v="polygon",a=!0,u=
new JU.List,G=0,B=0,x=null,H=null;if(b.isArrayParameter(++s))x=b.getPointArray(s,-1),G=x.length;else{G=Math.max(0,this.intParameter(s));x=Array(G);for(g=0;g<G;g++)x[g]=this.centerParameter(++b.iToken)}switch(this.getToken(++b.iToken).tok){case 11:case 12:s=J.script.SV.newT(b.theToken);s.toArray();H=s.getList();B=H.size();break;case 7:H=b.theToken.getList();B=H.size();break;default:B=Math.max(0,this.intParameter(b.iToken))}s=JU.AU.newInt2(B);for(g=0;g<B;g++){var E=null==H?b.floatParameterSet(++b.iToken,
3,4):J.script.SV.flistValue(H.get(g),0);(3>E.length||4<E.length)&&this.invArg();s[g]=[M(E[0]),M(E[1]),M(E[2]),3==E.length?7:M(E[3])]}0<G?(u.addLast(x),u.addLast(s)):u=null;s=b.iToken;break;case 1297090050:c=null;d=0;e=null;switch(this.tokAt(++s)){case 4:c=this.stringParameter(s);break;case 12:c=J.script.SV.sValue(this.getToken(s));break;default:b.isCenterParameter(s)||(d=this.intParameter(s++));b.isCenterParameter(s)&&(n=this.centerParameter(s));b.isCenterParameter(b.iToken+1)&&(e=this.centerParameter(++b.iToken));
if(this.chk)return!1;s=b.iToken}f=null;null==n&&s+1<this.slen&&(n=this.centerParameter(++s),f=10==this.tokAt(s)||1048577==this.tokAt(s)?this.atomExpressionAt(s):null);b.checkLast(b.iToken);this.chk||b.runScript(this.viewer.getSymmetryInfo(f,c,d,n,e,k,135176));return!1;case 4115:f=!0;continue;case 1048586:case 9:case 8:if(9==b.theTok||!b.isPoint3f(s)){u=this.getPoint4f(s);if(f)return b.checkLast(b.iToken),this.chk||b.runScript(J.util.Quaternion.newP4(u).draw(null==k?"frame":k," "+r,null==n?new JU.P3:
n,p/100)),!1;v="planedef"}else u=n=this.getPoint3f(s,!0),v="coord";s=b.iToken;a=!0;break;case 135267841:case 135266319:if(!a&&!e&&0==h&&135267841!=b.theTok){v="plane";break}g=135266319==b.theTok?b.planeParameter(++s):b.hklParameter(++s);s=b.iToken;if(0!=h){if(this.chk)break;a=this.viewer.getPlaneIntersection(h,g,p/100,0);p=0;v="polygon";u=a}else u=g,v="planedef";a=!0;break;case 1073742E3:v="lineData";u=b.floatParameterSet(++s,0,2147483647);s=b.iToken;a=!0;break;case 10:case 1048577:v="atomSet";u=
this.atomExpressionAt(s);f&&(n=this.centerParameter(s));s=b.iToken;a=!0;break;case 7:v="modelBasedPoints";u=J.script.SV.listValue(b.theToken);a=!0;break;case 1073742195:case 269484080:break;case 269484096:u=b.xypParameter(s);if(null!=u){s=b.iToken;v="coord";a=!0;break}d&&this.invArg();d=!0;break;case 269484097:d||this.invArg();d=!1;break;case 1141899269:v="reverse";break;case 4:u=this.stringParameter(s);v="title";break;case 135198:v="vector";break;case 1141899267:u=Float.$valueOf(this.floatParameter(++s));
v="length";break;case 3:u=Float.$valueOf(this.floatParameter(s));v="length";break;case 1095761935:v="modelIndex";u=Integer.$valueOf(this.intParameter(++s));break;case 2:d?(v="modelIndex",u=Integer.$valueOf(this.intParameter(s))):p=this.intParameter(s);break;case 1073742138:++s>=this.slen&&this.error(34);switch(this.getToken(s).tok){case 2:p=this.intParameter(s);continue;case 3:p=Math.round(100*this.floatParameter(s));continue}this.error(34);break;case 1074790550:k=this.setShapeId(22,++s,g);q=null==
this.getShapeProperty(22,"ID");s=b.iToken;break;case 1073742027:v="fixed";u=Boolean.FALSE;break;case 1060869:v="fixed";u=Boolean.TRUE;break;case 1073742066:g=this.getPoint3f(++s,!0);s=b.iToken;v="offset";u=g;break;case 1073741906:v="crossed";break;case 1073742196:u=Float.$valueOf(this.floatParameter(++s));v="width";r=v+" "+u;break;case 1073741998:v="line";u=Boolean.TRUE;break;case 1073741908:v="curve";break;case 1074790416:v="arc";break;case 1073741846:v="arrow";break;case 1073741880:v="circle";break;
case 1073741912:v="cylinder";break;case 1073742194:v="vertices";break;case 1073742048:v="nohead";break;case 1073741861:v="isbarb";break;case 1073742130:v="rotate45";break;case 1073742092:v="perp";break;case 1666189314:case 1073741916:r=1666189314==b.theTok;E=this.floatParameter(++s);r&&(E*=2);u=Float.$valueOf(E);v=r||3==this.tokAt(s)?"width":"diameter";r=v+(3==this.tokAt(s)?" "+E:" "+M(E));break;case 1048583:if(269484096==this.tokAt(s+2)||f){a=n=this.centerParameter(s);s=b.iToken;v="coord";u=a;a=
!0;break}u=b.objectNameParameter(++s);v="identifier";a=!0;break;case 1766856708:case 603979967:case 1073742074:g=!0;j=b.getColorTrans(s,!1);s=b.iToken;continue;default:if(!b.setMeshDisplayProperty(22,0,b.theTok)){if(269484209==b.theTok||J.script.T.tokAttr(b.theTok,1073741824)){k=this.setShapeId(22,s,g);s=b.iToken;break}this.invArg()}0==m&&(m=s);s=b.iToken;continue}g=12291!=b.theTok;a&&(!c&&!f)&&(this.setShapeProperty(22,"points",Integer.$valueOf(p)),c=!0,p=0);a&&q&&this.invArg();null!=v&&this.setShapeProperty(22,
v,u)}b.finalizeObject(22,b.colorArgb[0],j,p,a,y,m,null);return!0});k(c$,"isosurface",function(b){var a=this.eval;this.sm.loadShape(b);if(1073742001==this.tokAt(1)&&this.listIsosurface(b))return!1;var c=0,d=24==b,e=28==b,f=29==b,g=26==b,h=!1,j=!1,p=!1,r=!1,m=!1,n=!1,k=!1,q=!1,y=!1,w=!1,s=!1,v=!1,u=!1,G=!1,B=null,x=null,H=-2147483648,E,K,fa,z,L,ma=NaN,T=NaN,Y=0,R=null,va=2147483647,O=null,P=null,Z=null,t=new JU.SB,N,wa=null,ja=null,na,ba=0,$=null,Q=this.chk?0:-2147483648;a.setCursorWait(!0);var ka=
null!=this.initIsosurface(b),ua=ka&&null==this.getShapeProperty(b,"ID"),ib=!1,Sa=!1,xa=null,Ta=null,ca=null,Ua=null,ra=null,ya=null,F=new JU.List,jb=!1;(e||f)&&this.addShapeProperty(F,"fileType","Pmesh");for(var l=a.iToken;l<this.slen;++l){var D=null,A=null;this.getToken(l);1073741824==a.theTok&&($=this.parameterAsString(l));switch(a.theTok){case 603979871:R=1048589==this.getToken(++l).tok?Boolean.TRUE:1048588==a.theTok?Boolean.FALSE:null;null==R&&this.invArg();continue;case 553648149:va=this.intParameter(++l);
continue;case 4128:D="moveIsosurface";12!=this.tokAt(++l)&&this.invArg();A=this.getToken(l++).value;break;case 1297090050:for(var kb=this.floatArraySet(l+2,this.intParameter(l+1),16),ra=Array(kb.length),da=ra.length;0<=--da;)ra[da]=JU.M4.newA16(kb[da]);l=a.iToken;break;case 1089470478:0>Q&&(Q=Math.min(this.viewer.getCurrentModelIndex(),0));var lb=null==Z;null==P&&(P=J.util.BSUtil.copy(this.viewer.getSelectedAtoms()));P.and(this.viewer.getAtomBits(1297090050,Integer.$valueOf(1)));lb||P.andNot(Z);this.addShapeProperty(F,
"select",P);lb&&(Z=J.util.BSUtil.copy(P),J.util.BSUtil.invertInPlace(Z,this.viewer.getAtomCount()),G=!0,this.addShapeProperty(F,"ignore",Z),t.append(" ignore ").append(J.util.Escape.eBS(Z)));t.append(" symmetry");0==ba&&this.addShapeProperty(F,"colorRGB",Integer.$valueOf(1297090050));ra=this.viewer.modelSet.getSymMatrices(Q);break;case 1073742066:D="offset";A=this.centerParameter(++l);l=a.iToken;break;case 528432:D="rotate";A=1048587==this.tokAt(a.iToken=++l)?null:this.getPoint4f(l);l=a.iToken;break;
case 1610612740:D="scale3d";A=Float.$valueOf(this.floatParameter(++l));break;case 1073742090:t.append(" periodic");D="periodic";break;case 1073742078:case 266298:case 135266320:D=a.theToken.value.toString();t.append(" ").appendO(a.theToken.value);A=this.centerParameter(++l);t.append(" ").append(J.util.Escape.eP(A));l=a.iToken;break;case 1679429641:if(0<=this.fullCommand.indexOf("# BBOX=")){var mb=JU.PT.split(JU.PT.getQuotedAttribute(this.fullCommand,"# BBOX"),",");na=[J.util.Escape.uP(mb[0]),J.util.Escape.uP(mb[1])]}else a.isCenterParameter(l+
1)?(na=[this.getPoint3f(l+1,!0),this.getPoint3f(a.iToken+1,!0)],l=a.iToken):na=this.viewer.getBoundBoxVertices();t.append(" boundBox "+J.util.Escape.eP(na[0])+" "+J.util.Escape.eP(na[na.length-1]));D="boundingBox";A=na;break;case 135188:e=!0;t.append(" pmesh");D="fileType";A="Pmesh";break;case 135267842:P=this.atomExpressionAt(++l);this.chk?O=new JU.BS:1048577==this.tokAt(a.iToken+1)||10==this.tokAt(a.iToken+1)?(O=this.atomExpressionAt(++a.iToken),O.and(this.viewer.getAtomsWithinRadius(5,P,!1,null))):
(O=this.viewer.getAtomsWithinRadius(5,P,!0,null),O.andNot(this.viewer.getAtomBits(1095761936,P)));O.andNot(P);t.append(" intersection ").append(J.util.Escape.eBS(P)).append(" ").append(J.util.Escape.eBS(O));l=a.iToken;if(135368713==this.tokAt(l+1)){l++;var za=this.getToken(++l).value;t.append(" function ").append(JU.PT.esc(za));this.chk||this.addShapeProperty(F,"func",za.equals("a+b")||za.equals("a-b")?za:this.createFunction("__iso__","a,b",za))}else u=!0;D="intersection";A=[P,O];break;case 1610625028:case 135266325:var Va=
1610625028==a.theTok;if(Va){t.append(" display");var c=l,ga=this.tokAt(l+1);if(0==ga)continue;l++;this.addShapeProperty(F,"token",Integer.$valueOf(1048589));if(10==ga||1048579==ga){D="bsDisplay";1048579==ga?t.append(" all"):(A=this.st[l].value,t.append(" ").append(J.util.Escape.eBS(A)));a.checkLast(l);break}else 135266325!=ga&&(a.iToken=l,this.invArg())}else Y=l;var Ga,oa=null,O=null,Wa=!1;1048577==this.tokAt(l+1)?(Ga=this.floatParameter(l+3),a.isPoint3f(l+4)?(oa=this.centerParameter(l+4),Wa=!0,a.iToken+=
2):a.isPoint3f(l+5)?(oa=this.centerParameter(l+5),Wa=!0,a.iToken+=2):(O=a.atomExpression(this.st,l+5,this.slen,!0,!1,!1,!0),null==O&&this.invArg())):(Ga=this.floatParameter(++l),oa=this.centerParameter(++l));Va&&a.checkLast(a.iToken);l=a.iToken;0<=this.fullCommand.indexOf("# WITHIN=")?O=JU.BS.unescape(JU.PT.getQuotedAttribute(this.fullCommand,"# WITHIN")):Wa||(O=C(a.expressionResult,JU.BS)?a.expressionResult:null);this.chk||(null!=O&&0<=Q&&O.and(this.viewer.getModelUndeletedAtomsBitSet(Q)),null==
oa&&(oa=null==O?new JU.P3:this.viewer.getAtomSetCenter(O)),this.getWithinDistanceVector(F,Ga,oa,O,Va),t.append(" within ").appendF(Ga).append(" ").append(null==O?J.util.Escape.eP(oa):J.util.Escape.eBS(O)));continue;case 1073742083:var D="parameters",nb=a.floatParameterSet(++l,1,10),l=a.iToken,A=nb;t.append(" parameters ").append(J.util.Escape.eAF(nb));break;case 1716520985:case 1073742190:var xa=a.theToken.value,Na=1073742190==a.theTok,Aa=this.tokAt(l+1);null==Ua?(!h&&(!p&&!j)&&(this.addShapeProperty(F,
"sasurface",Float.$valueOf(0)),t.append(" vdw"),h=!0),D="property",null==R&&(R=J.script.T.tokAttr(Aa,1112539136)&&1==this.viewer.getIsosurfacePropertySmoothing(!1)?Boolean.TRUE:Boolean.FALSE),this.addShapeProperty(F,"propertySmoothing",R),t.append(" isosurfacePropertySmoothing "+R),R===Boolean.TRUE&&(2147483647==va&&(va=this.viewer.getIsosurfacePropertySmoothing(!0)),this.addShapeProperty(F,"propertySmoothingPower",Integer.$valueOf(va)),t.append(" isosurfacePropertySmoothingPower "+va)),this.viewer.global.rangeSelected&&
this.addShapeProperty(F,"rangeSelected",Boolean.TRUE)):D=Ua;$=this.parameterAsString(l);t.append(" ").append($);if(0==$.toLowerCase().indexOf("property_")){B=I(this.viewer.getAtomCount(),0);if(this.chk)continue;B=this.viewer.getDataFloat($);null==B&&this.invArg();this.addShapeProperty(F,D,B);continue}var Ba=this.viewer.getAtomCount(),B=I(Ba,0);if(Na){var ob=this.parameterAsString(++l);0==ob.length?B=a.floatParameterSet(l,Ba,Ba):(B=I(Ba,0),this.chk||J.util.Parser.parseStringInfestedFloatArray(""+a.getParameter(ob,
4),null,B));this.chk||t.append(' "" ').append(J.util.Escape.eAF(B))}else{this.getToken(++l);if(!this.chk){t.append(" "+a.theToken.value);var Oa=this.viewer.modelSet.atoms;this.viewer.autoCalculate(Aa);if(1766856708!=Aa)for(var Xa=Ba;0<=--Xa;)B[Xa]=J.modelset.Atom.atomPropertyFloat(this.viewer,Oa[Xa],Aa)}1766856708==Aa&&(ca="inherit");if(135266325==this.tokAt(l+1)){var pb=this.floatParameter(l+=2);t.append(" within "+pb);this.addShapeProperty(F,"propertyDistanceMax",Float.$valueOf(pb))}}A=B;break;
case 1095761935:case 1095766030:h&&this.invArg();Q=1095761935==a.theTok?this.intParameter(++l):a.modelNumberParameter(++l);t.append(" modelIndex "+Q);if(0>Q){D="fixed";A=Boolean.TRUE;break}D="modelIndex";A=Integer.$valueOf(Q);break;case 135280132:var D="select",Ya=this.atomExpressionAt(++l),A=Ya,l=a.iToken;1073742072==this.tokAt(l+1)&&(l++,Z=J.util.BSUtil.copy(Ya),J.util.BSUtil.invertInPlace(Z,this.viewer.getAtomCount()),this.addShapeProperty(F,"ignore",Z),t.append(" ignore ").append(J.util.Escape.eBS(Z)),
G=!0);h||p?t.append(" select "+J.util.Escape.eBS(Ya)):(P=A,0>Q&&0<=P.nextSetBit(0)&&(Q=this.viewer.getAtomModelIndex(P.nextSetBit(0))));break;case 1085443:H=this.intParameter(++l);break;case 12289:D="center";A=this.centerParameter(++l);t.append(" center "+J.util.Escape.eP(A));l=a.iToken;break;case 1073742147:case 1766856708:var ka=!0,Za=1073742147==a.theTok;if(Za)t.append(" sign"),this.addShapeProperty(F,"sign",Boolean.TRUE);else{if(1073741914==this.tokAt(l+1)){l++;D="colorDensity";t.append(" color density");
if(this.isFloatParameter(l+1)){var qb=this.floatParameter(++l);t.append(" "+qb);A=Float.$valueOf(qb)}break}if(4==this.getToken(l+1).tok)ca=this.parameterAsString(++l),0<ca.indexOf(" ")&&(ya=J.util.C.getColixArray(ca),null==ya&&this.error(4));else if(1073742018==a.theTok){l++;t.append(" color mesh");ba=a.getArgbParam(++l);this.addShapeProperty(F,"meshcolor",Integer.$valueOf(ba));t.append(" ").append(J.util.Escape.escapeColor(ba));l=a.iToken;continue}if(603979967==(a.theTok=this.tokAt(l+1))||1073742074==
a.theTok){t.append(" color");Ta=this.setColorOptions(t,l+1,24,-2);l=a.iToken;continue}switch(this.tokAt(l+1)){case 1073741826:case 1073742114:this.getToken(++l);t.append(" color range");this.addShapeProperty(F,"rangeAll",null);if(1048579==this.tokAt(l+1)){l++;t.append(" all");continue}var rb=this.floatParameter(++l),sb=this.floatParameter(++l);this.addShapeProperty(F,"red",Float.$valueOf(rb));this.addShapeProperty(F,"blue",Float.$valueOf(sb));t.append(" ").appendF(rb).append(" ").appendF(sb);continue}if(a.isColorParam(l+
1)&&(ba=a.getArgbParam(l+1),1074790746==this.tokAt(l+2))){ca=a.getColorRange(l+1);l=a.iToken;break}t.append(" color")}a.isColorParam(l+1)?(ba=a.getArgbParam(++l),t.append(" ").append(J.util.Escape.escapeColor(ba)),l=a.iToken,this.addShapeProperty(F,"colorRGB",Integer.$valueOf(ba)),ka=!0,a.isColorParam(l+1)?(ba=a.getArgbParam(++l),l=a.iToken,this.addShapeProperty(F,"colorRGB",Integer.$valueOf(ba)),t.append(" ").append(J.util.Escape.escapeColor(ba)),r=!0):Za&&this.invPO()):!Za&&null==ya&&this.invPO();
continue;case 135270423:d||this.invArg();w=!this.chk;continue;case 1229984263:4!=this.tokAt(l+1)&&this.invPO();continue;case 1112541195:case 1649412120:t.append(" ").appendO(a.theToken.value);var Ha=a.encodeRadiusParameter(l,!1,!0);t.append(" ").appendO(Ha);Float.isNaN(Ha.value)&&(Ha.value=100);A=Ha;D="radius";y=!0;p&&(h=!1);l=a.iToken;break;case 135266319:j=!0;D="plane";A=a.planeParameter(++l);l=a.iToken;t.append(" plane ").append(J.util.Escape.eP4(A));break;case 1073742138:D="scale";A=Float.$valueOf(this.floatParameter(++l));
t.append(" scale ").appendO(A);break;case 1048579:ka&&this.invArg();D="thisID";break;case 1113198596:h=!0;++l;A=this.getPoint4f(l);D="ellipsoid";l=a.iToken;t.append(" ellipsoid ").append(J.util.Escape.eP4(A));break;case 135267841:j=!0;D="plane";A=a.hklParameter(++l);l=a.iToken;t.append(" plane ").append(J.util.Escape.eP4(A));break;case 135182:var h=!0,Ia=this.parameterAsString(++l);this.addShapeProperty(F,"lcaoType",Ia);t.append(" lcaocartoon ").append(JU.PT.esc(Ia));switch(this.getToken(++l).tok){case 10:case 1048577:D=
"lcaoCartoon";O=this.atomExpressionAt(l);l=a.iToken;if(this.chk)continue;var Ca=O.nextSetBit(0);0>Ca&&this.error(14);t.append(" ({").appendI(Ca).append("})");Q=this.viewer.getAtomModelIndex(Ca);this.addShapeProperty(F,"modelIndex",Integer.$valueOf(Q));var $a=[new JU.V3,new JU.V3,JU.V3.newV(this.viewer.getAtomPoint3f(Ca)),new JU.V3];if(!Ia.equalsIgnoreCase("s")&&null==this.viewer.getHybridizationAndAxes(Ca,$a[0],$a[1],Ia))return!1;A=$a;break;default:this.error(14)}break;case 1183762:var Da=2147483647,
sa=2147483647,ab=269484192==this.tokAt(l+1);ab&&l++;var Ea=null;switch(this.tokAt(++l)){case 0:a.bad();break;case 1073741914:t.append("mo [1] squared ");this.addShapeProperty(F,"squareLinear",Boolean.TRUE);Ea=[1];sa=Da=0;l++;break;case 1073741973:case 1073742008:sa=this.moOffset(l);Da=0;l=a.iToken;t.append(" mo "+(ab?"-":"")+"HOMO ");0<sa&&t.append("+");0!=sa&&t.appendI(sa);break;case 2:Da=this.intParameter(l);t.append(" mo ").appendI(Da);break;default:a.isArrayParameter(l)&&(Ea=a.floatParameterSet(l,
1,2147483647),l=a.iToken)}if(1073742156==this.tokAt(l+1))this.addShapeProperty(F,"squareLinear",Boolean.TRUE),t.append(" squared"),null==Ea&&(Ea=I(0,0));else if(135266320==this.tokAt(l+1)){++l;var tb=this.intParameter(++l),ub=2==this.tokAt(l+1)?this.intParameter(++l):-System.currentTimeMillis()%1E4;this.addShapeProperty(F,"monteCarloCount",Integer.$valueOf(tb));this.addShapeProperty(F,"randomSeed",Integer.$valueOf(ub));t.append(" points ").appendI(tb).appendC(" ").appendI(ub)}this.setMoData(F,Da,
Ea,sa,ab,Q,null);h=!0;continue;case 1073742036:D="nci";t.append(" "+D);var ga=this.tokAt(l+1),vb=1229984263!=ga&&4!=ga&&1073742033!=ga,A=Boolean.$valueOf(vb);vb&&(h=!0);break;case 1073742016:case 1073742022:var wb=1073742016==a.theTok,D=wb?"mep":"mlp";t.append(" "+D);var Ja=null,bb=-1,h=!0;2==this.tokAt(l+1)&&(bb=this.intParameter(++l),t.append(" "+bb),this.addShapeProperty(F,"mepCalcType",Integer.$valueOf(bb)));if(4==this.tokAt(l+1))Ja=this.stringParameter(++l),t.append(" /*file*/"+JU.PT.esc(Ja));
else if(1716520985==this.tokAt(l+1)){Ua=D;continue}if(!this.chk)try{B=null==Ja&&wb?this.viewer.getPartialCharges():this.getAtomicPotentials(P,Z,Ja)}catch(xb){if(!S(xb,Exception))throw xb;}!this.chk&&null==B&&this.error(32);A=B;break;case 1313866249:k=!this.chk;t.append(" volume");break;case 1074790550:this.setShapeId(b,++l,ka);ua=null==this.getShapeProperty(b,"ID");l=a.iToken;break;case 1073741888:603979967==this.tokAt(l+1)&&(ib=!0,l++);ca=this.parameterAsString(++l).toLowerCase();ca.equals("sets")?
t.append(' colorScheme "sets"'):a.isColorParam(l)&&(ca=a.getColorRange(l),l=a.iToken);break;case 1073741828:D="addHydrogens";A=Boolean.TRUE;t.append(" mp.addHydrogens");break;case 1073741836:D="angstroms";t.append(" angstroms");break;case 1073741838:D="anisotropy";A=this.getPoint3f(++l,!1);t.append(" anisotropy").append(J.util.Escape.eP(A));l=a.iToken;break;case 1073741842:n=!this.chk;t.append(" area");break;case 1073741850:case 1073742076:h=!0;r&&!m&&(t.append(' phase "_orb"'),this.addShapeProperty(F,
"phase","_orb"));var W=I(7,0);W[0]=this.intParameter(++l);W[1]=this.intParameter(++l);W[2]=this.intParameter(++l);W[3]=this.isFloatParameter(l+1)?this.floatParameter(++l):6;t.append(" atomicOrbital ").appendI(M(W[0])).append(" ").appendI(M(W[1])).append(" ").appendI(M(W[2])).append(" ").appendF(W[3]);135266320==this.tokAt(l+1)&&(l+=2,W[4]=this.intParameter(l),W[5]=3==this.tokAt(l+1)?this.floatParameter(++l):0,W[6]=2==this.tokAt(l+1)?this.intParameter(++l):-System.currentTimeMillis()%1E4,t.append(" points ").appendI(M(W[4])).appendC(" ").appendF(W[5]).appendC(" ").appendI(M(W[6])));
D="hydrogenOrbital";A=W;break;case 1073741866:t.append(" binary");continue;case 1073741868:t.append(" blockData");D="blockData";A=Boolean.TRUE;break;case 1074790451:case 554176565:v=!0;D=a.theToken.value;A=this.getCapSlabObject(l,!1);l=a.iToken;break;case 1073741876:d||this.invArg();q=!0;if(this.chk)continue;var yb=this.isFloatParameter(l+1)?this.floatParameter(++l):1.2,cb=this.isFloatParameter(l+1)?this.floatParameter(++l):10;10<cb&&a.integerOutOfRange(0,10);t.append(" cavity ").appendF(yb).append(" ").appendF(cb);
this.addShapeProperty(F,"envelopeRadius",Float.$valueOf(cb));this.addShapeProperty(F,"cavityRadius",Float.$valueOf(yb));D="cavity";break;case 1073741896:case 1073741900:D="contour";t.append(" contour");switch(this.tokAt(l+1)){case 1073741920:A=a.floatParameterSet(l+2,1,2147483647);t.append(" discrete ").append(J.util.Escape.eAF(A));l=a.iToken;break;case 1073741981:N=this.getPoint3f(l+2,!1);(0>=N.z||N.y<N.x)&&this.invArg();N.z==M(N.z)&&N.z>N.y-N.x&&(N.z=(N.y-N.x)/N.z);A=N;l=a.iToken;t.append(" increment ").append(J.util.Escape.eP(N));
break;default:A=Integer.$valueOf(2==this.tokAt(l+1)?this.intParameter(++l):0),t.append(" ").appendO(A)}break;case 3:case 2:case 269484193:case 1073741910:t.append(" cutoff ");1073741910==a.theTok&&l++;269484193==this.tokAt(l)?(D="cutoffPositive",A=Float.$valueOf(T=this.floatParameter(++l)),t.append("+").appendO(A)):this.isFloatParameter(l)?(D="cutoff",A=Float.$valueOf(T=this.floatParameter(l)),t.appendO(A)):(D="cutoffRange",A=a.floatParameterSet(l,2,2),this.addShapeProperty(F,"cutoff",Float.$valueOf(0)),
t.append(J.util.Escape.eAF(A)),l=a.iToken);break;case 1073741928:D="downsample";A=Integer.$valueOf(this.intParameter(++l));t.append(" downsample ").appendO(A);break;case 1073741930:D="eccentricity";A=this.getPoint4f(++l);t.append(" eccentricity ").append(J.util.Escape.eP4(A));l=a.iToken;break;case 1074790508:t.append(" ed");this.setMoData(F,-1,null,0,!1,Q,null);h=!0;continue;case 536870916:case 1073742041:t.append(" ").appendO(a.theToken.value);D="debug";A=536870916==a.theTok?Boolean.TRUE:Boolean.FALSE;
break;case 1060869:t.append(" fixed");D="fixed";A=Boolean.TRUE;break;case 1073741962:t.append(" fullPlane");D="fullPlane";A=Boolean.TRUE;break;case 1073741966:case 1073741968:var Pa=1073741968==a.theTok,D=""+a.theToken.value,ha=new JU.List,A=ha,s=h=!0;t.append(" ").append(D);var X=this.parameterAsString(++l);if(X.equals("=")){t.append(" =");X=this.parameterAsString(++l);t.append(" ").append(JU.PT.esc(X));ha.addLast(X);this.chk||this.addShapeProperty(F,"func",this.createFunction("__iso__","x,y,z",
X));break}var db=JU.PT.getQuotedAttribute(this.fullCommand,"# DATA"+(s?"2":""));null==db?db="inline":X=db;var zb=0==X.indexOf("data2d_"),Qa=0==X.indexOf("data3d_"),Sa=X.equals("inline");t.append(" inline");ha.addLast(X);var Ab=this.getPoint3f(++l,!1);t.append(" ").append(J.util.Escape.eP(Ab));ha.addLast(Ab);var ia;z=++a.iToken;ha.addLast(ia=this.getPoint4f(z));t.append(" ").append(J.util.Escape.eP4(ia));E=M(ia.x);L=++a.iToken;ha.addLast(ia=this.getPoint4f(L));t.append(" ").append(J.util.Escape.eP4(ia));
K=M(ia.x);ha.addLast(ia=this.getPoint4f(++a.iToken));t.append(" ").append(J.util.Escape.eP4(ia));fa=M(ia.x);(0==E||0==K||0==fa)&&this.invArg();if(!this.chk){var aa=null,ea=null;if(Pa){Sa?(E=Math.abs(E),K=Math.abs(K),fa=Math.abs(fa),ea=this.floatArraySetXYZ(++a.iToken,E,K,fa)):ea=Qa?this.viewer.getDataFloat3D(X):this.viewer.functionXYZ(X,E,K,fa);E=Math.abs(E);K=Math.abs(K);fa=Math.abs(fa);null==ea&&(a.iToken=z,a.errorStr(53,"xyzdata is null."));if(ea.length!=E||ea[0].length!=K||ea[0][0].length!=fa)a.iToken=
z,a.errorStr(53,"xyzdata["+ea.length+"]["+ea[0].length+"]["+ea[0][0].length+"] is not of size ["+E+"]["+K+"]["+fa+"]");ha.addLast(ea);t.append(" ").append(J.util.Escape.e(ea))}else{Sa?(E=Math.abs(E),K=Math.abs(K),aa=this.floatArraySet(++a.iToken,E,K)):zb?(aa=this.viewer.getDataFloat2D(X),E=null==aa?0:aa.length,K=3):(aa=this.viewer.functionXY(X,E,K),E=Math.abs(E),K=Math.abs(K));null==aa&&(a.iToken=z,a.errorStr(53,"fdata is null."));aa.length!=E&&!zb&&(a.iToken=z,a.errorStr(53,"fdata length is not correct: "+
aa.length+" "+E+"."));for(da=0;da<E;da++)null==aa[da]&&(a.iToken=L,a.errorStr(53,"fdata["+da+"] is null.")),aa[da].length!=K&&(a.iToken=L,a.errorStr(53,"fdata["+da+"] is not the right length: "+aa[da].length+" "+K+"."));ha.addLast(aa);t.append(" ").append(J.util.Escape.e(aa))}}l=a.iToken;break;case 1073741970:D="gridPoints";t.append(" gridPoints");break;case 1073741976:D="ignore";A=Z=this.atomExpressionAt(++l);t.append(" ignore ").append(J.util.Escape.eBS(Z));l=a.iToken;break;case 1073741984:D="insideOut";
t.append(" insideout");break;case 1073741988:case 1073741986:case 1073742100:t.append(" ").appendO(a.theToken.value);D="pocket";A=1073742100==a.theTok?Boolean.TRUE:Boolean.FALSE;break;case 1073742002:D="lobe";A=this.getPoint4f(++l);l=a.iToken;t.append(" lobe ").append(J.util.Escape.eP4(A));h=!0;break;case 1073742004:case 1073742006:D="lp";A=this.getPoint4f(++l);l=a.iToken;t.append(" lp ").append(J.util.Escape.eP4(A));h=!0;break;case 1052700:(p||this.slen==l+1)&&this.invArg();p=!0;if((q||y||u)&&!h)h=
!0,this.addShapeProperty(F,"bsSolvent",y||u?new JU.BS:a.lookupIdentifierValue("solvent")),this.addShapeProperty(F,"sasurface",Float.$valueOf(0));0==t.length()?(wa=this.getShapeProperty(24,"plane"),null==wa?null!=this.getShapeProperty(24,"contours")&&this.addShapeProperty(F,"nocontour",null):(this.addShapeProperty(F,"plane",wa),t.append("plane ").append(J.util.Escape.eP4(wa)),j=!0,wa=null)):!h&&!j&&this.invArg();t.append("; isosurface map");this.addShapeProperty(F,"map",h?Boolean.TRUE:Boolean.FALSE);
break;case 1073742014:D="maxset";A=Integer.$valueOf(this.intParameter(++l));t.append(" maxSet ").appendO(A);break;case 1073742020:D="minset";A=Integer.$valueOf(this.intParameter(++l));t.append(" minSet ").appendO(A);break;case 1073742112:h=!0;D="rad";A=this.getPoint4f(++l);l=a.iToken;t.append(" radical ").append(J.util.Escape.eP4(A));break;case 1073742027:D="fixed";A=Boolean.FALSE;t.append(" modelBased");break;case 1073742028:case 1073742136:case 1613758488:var xa=a.theToken.value,Ka;1073742028==
a.theTok?(D="molecular",t.append(" molecular"),Ka=this.isFloatParameter(l+1)?this.floatParameter(++l):1.4):(this.addShapeProperty(F,"bsSolvent",a.lookupIdentifierValue("solvent")),D=1073742136==a.theTok?"sasurface":"solvent",t.append(" ").appendO(a.theToken.value),Ka=this.isFloatParameter(l+1)?this.floatParameter(++l):this.viewer.getFloat(570425394));t.append(" ").appendF(Ka);A=Float.$valueOf(Ka);1073741961==this.tokAt(l+1)&&(this.addShapeProperty(F,"doFullMolecular",null),t.append(" full"),l++);
h=!0;break;case 1073742033:this.addShapeProperty(F,"fileType","Mrc");t.append(" mrc");continue;case 1073742064:case 1073742062:this.addShapeProperty(F,"fileType","Obj");t.append(" obj");continue;case 1073742034:this.addShapeProperty(F,"fileType","Msms");t.append(" msms");continue;case 1073742094:h&&this.invArg();D="phase";m=!0;A=4==this.tokAt(l+1)?this.stringParameter(++l):"_orb";t.append(" phase ").append(JU.PT.esc(A));break;case 1073742104:case 1073742122:D="resolution";A=Float.$valueOf(this.floatParameter(++l));
t.append(" resolution ").appendO(A);break;case 1073742124:D="reverseColor";A=Boolean.TRUE;t.append(" reversecolor");break;case 1073742146:D="sigma";A=Float.$valueOf(ma=this.floatParameter(++l));t.append(" sigma ").appendO(A);break;case 1113198597:D="geodesic";A=Float.$valueOf(this.floatParameter(++l));t.append(" geosurface ").appendO(A);h=!0;break;case 1073742154:D="sphere";A=Float.$valueOf(this.floatParameter(++l));t.append(" sphere ").appendO(A);h=!0;break;case 1073742156:D="squareData";A=Boolean.TRUE;
t.append(" squared");break;case 1073741983:D=!h&&!j&&!p?"readFile":"mapColor";$=this.stringParameter(++l);null==$&&this.invArg();e&&($=JU.PT.replaceWithCharacter($,"{,}|"," "));a.debugHigh&&J.util.Logger.debug("pmesh inline data:\n"+$);A=this.chk?null:$;this.addShapeProperty(F,"fileName","");t.append(" INLINE ").append(JU.PT.esc($));h=!0;break;case 4:var La=!h&&!j,D=La&&!p?"readFile":"mapColor",V=this.parameterAsString(l);if(V.startsWith("=")&&1<V.length){var Bb=this.viewer.setLoadFormat(V,"_",!1),
V=Bb[0],Cb=!La||!Float.isNaN(T)?null:Bb[1];null!=Cb&&!this.chk&&(T=J.script.SV.fValue(J.script.SV.getVariable(this.viewer.evaluateExpression(Cb))),0<T&&(Float.isNaN(ma)||(T*=ma,ma=NaN,this.addShapeProperty(F,"sigma",Float.$valueOf(ma))),this.addShapeProperty(F,"cutoff",Float.$valueOf(T)),t.append(" cutoff ").appendF(T)));0==Y&&(xa="=xxxx",0>Q&&(Q=this.viewer.getCurrentModelIndex()),O=this.viewer.getModelUndeletedAtomsBitSet(Q),this.getWithinDistanceVector(F,2,null,O,!1),t.append(" within 2.0 ").append(J.util.Escape.eBS(O)));
La&&(jb=!0)}La&&(this.viewer.getParameter("_fileType").equals("Pdb")&&Float.isNaN(ma)&&Float.isNaN(T))&&(this.addShapeProperty(F,"sigma",Float.$valueOf(-1)),t.append(" sigma -1.0"));0==V.length&&(0>Q&&(Q=this.viewer.getCurrentModelIndex()),V=a.getFullPathName(),A=this.viewer.getModelAuxiliaryInfoValue(Q,"jmolSurfaceInfo"));var eb=-1;null==A&&2==this.tokAt(l+1)&&this.addShapeProperty(F,"fileIndex",Integer.$valueOf(eb=this.intParameter(++l)));var Fa=4==this.tokAt(l+1)?this.stringParameter(++l):null,
h=!0;if(this.chk)break;var ta,la=null;null==A&&(0<=this.fullCommand.indexOf("# FILE0=")?(V=JU.PT.getQuotedAttribute(this.fullCommand,"# FILE0"),1073741848==this.tokAt(l+1)&&(l+=2)):1073741848==this.tokAt(l+1)&&(la=this.viewer.getFilePath(this.stringParameter(a.iToken=l+=2),!1),ta=this.viewer.getFullPathNameOrError(la),la=ta[0],""!==this.viewer.getPathForAllFiles()?(V=la,la=null):this.addShapeProperty(F,"localName",la)));!V.startsWith("cache://")&&null==Fa&&(ta=this.viewer.getFullPathNameOrError(V),
V=ta[0],null!=ta[1]&&a.errorStr(17,V+":"+ta[1]));J.util.Logger.info("reading isosurface data from "+V);null!=Fa&&(A=this.viewer.cacheGet(V),this.addShapeProperty(F,"calculationType",Fa));null==A&&(this.addShapeProperty(F,"fileName",V),null!=la&&(V=la),0<=eb&&t.append(" ").appendI(eb));t.append(" /*file*/").append(JU.PT.esc(V));null!=Fa&&t.append(" ").append(JU.PT.esc(Fa));break;case 4106:D="connections";switch(this.tokAt(++l)){case 10:case 1048577:A=[this.atomExpressionAt(l).nextSetBit(0)];break;
default:A=[M(a.floatParameterSet(l,1,1)[0])]}l=a.iToken;break;case 1095761923:D="atomIndex";A=Integer.$valueOf(this.intParameter(++l));break;case 1073741999:D="link";t.append(" link");break;case 1073741994:24!=b&&this.invArg();N=this.getPoint3f(a.iToken+1,!1);l=a.iToken;if(0>=N.x||0>=N.y||0>=N.z)break;N.x=M(N.x);N.y=M(N.y);N.z=M(N.z);t.append(" lattice ").append(J.util.Escape.eP(N));p?(D="mapLattice",A=N):ja=N;break;default:1073741824==a.theTok&&(D="thisID",A=$);if(!a.setMeshDisplayProperty(b,0,a.theTok)){if(J.script.T.tokAttr(a.theTok,
1073741824)&&!ka){this.setShapeId(b,l,ka);l=a.iToken;break}this.invArg()}0==c&&(c=l);l=this.slen-1}ka=12291!=a.theTok;ua&&h&&this.invArg();null!=D&&this.addShapeProperty(F,D,A)}if(!this.chk){if((q||y)&&!h)h=!0,this.addShapeProperty(F,"bsSolvent",y?new JU.BS:a.lookupIdentifierValue("solvent")),this.addShapeProperty(F,"sasurface",Float.$valueOf(0));j&&(!h&&!p)&&(this.addShapeProperty(F,"nomap",Float.$valueOf(0)),h=!0);-1<=H&&this.addShapeProperty(F,"getSurfaceSets",Integer.$valueOf(H-1));if(null!=ya)this.addShapeProperty(F,
"colorDiscrete",ya);else if("sets".equals(ca))this.addShapeProperty(F,"setColorScheme",null);else if(null!=ca){var Ma=this.viewer.getColorEncoder(ca);null!=Ma&&(Ma.isTranslucent=ib,Ma.hi=3.4028235E38,this.addShapeProperty(F,"remapColor",Ma))}if(h&&!g&&0!=t.indexOf(";")){F.add(0,["newObject",null]);var Db=null==P;Db&&(P=J.util.BSUtil.copy(this.viewer.getSelectedAtoms()));0>Q&&(Q=this.viewer.getCurrentModelIndex());P.and(this.viewer.getModelUndeletedAtomsBitSet(Q));null!=xa&&(1!=this.viewer.getModelBitSet(P,
!1).cardinality()&&a.errorStr(30,"ISOSURFACE "+xa),Db&&(F.add(0,["select",P]),0==t.indexOf("; isosurface map")&&(t=(new JU.SB).append("; isosurface map select ").append(J.util.Escape.eBS(P)).append(t.substring(16)))))}u&&!v&&(h||this.addShapeProperty(F,"sasurface",Float.$valueOf(0)),p||(this.addShapeProperty(F,"map",Boolean.TRUE),this.addShapeProperty(F,"select",O),this.addShapeProperty(F,"sasurface",Float.$valueOf(0))),this.addShapeProperty(F,"slab",this.getCapSlabObject(-100,!1)));var Eb=h&&this.viewer.getBoolean(603979934);
Eb&&J.util.Logger.startTimer("isosurface");this.setShapeProperty(b,"setProperties",F);Eb&&this.showString(J.util.Logger.getTimerMsg("isosurface",0));jb&&(this.setShapeProperty(b,"token",Integer.$valueOf(1073742018)),this.setShapeProperty(b,"token",Integer.$valueOf(1073742046)),G=!0,t.append(" mesh nofill frontOnly"))}null!=ja&&this.setShapeProperty(b,"lattice",ja);null!=ra&&this.setShapeProperty(b,"symops",ra);G&&this.setShapeProperty(b,"token",Integer.$valueOf(1073741960));0<c&&(a.setMeshDisplayProperty(b,
c,0)||this.invArg());if(this.chk)return!1;var pa=null,qa=null;n&&(pa=this.getShapeProperty(b,"area"),C(pa,Float)?this.viewer.setFloatProperty("isosurfaceArea",pa.floatValue()):this.viewer.setUserVariable("isosurfaceArea",J.script.SV.getVariableAD(pa)));k&&(qa=k?this.getShapeProperty(b,"volume"):null,C(qa,Float)?this.viewer.setFloatProperty("isosurfaceVolume",qa.floatValue()):this.viewer.setUserVariable("isosurfaceVolume",J.script.SV.getVariableAD(qa)));if(!g){var U=null;if(p&&!h)this.setShapeProperty(b,
"finalize",t.toString());else if(h&&(x=t.toString(),this.setShapeProperty(b,"finalize",(0==x.indexOf("; isosurface map")?"":" select "+J.util.Escape.eBS(P)+" ")+x),U=this.getShapeProperty(b,"ID"),null!=U&&!a.tQuiet)){T=this.getShapeProperty(b,"cutoff").floatValue();Float.isNaN(T)&&!Float.isNaN(ma)&&J.util.Logger.error("sigma not supported");U+=" created";d&&(U+=" with cutoff="+T);var fb=this.getShapeProperty(b,"minMaxInfo");3.4028235E38!=fb[0]&&(U+=" min="+fb[0]+" max="+fb[1]);U+="; "+J.viewer.JC.shapeClassBases[b].toLowerCase()+
" count: "+this.getShapeProperty(b,"count");U+=a.getIsosurfaceDataRange(b,"\n")}var gb,hb;if(n||k)gb=n?"isosurfaceArea = "+(C(pa,Float)?""+pa:J.util.Escape.eAD(pa)):null,hb=k?"isosurfaceVolume = "+(C(qa,Float)?""+qa:J.util.Escape.eAD(qa)):null,null==U?(n&&this.showString(gb),k&&this.showString(hb)):(n&&(U+="\n"+gb),k&&(U+="\n"+hb));null!=U&&this.showString(U)}null!=Ta&&this.setShapeProperty(b,"translucency",Ta);this.setShapeProperty(b,"clear",null);w&&this.setShapeProperty(b,"cache",null);26!=b&&
this.listIsosurface(b);return!0},"~N");k(c$,"getAtomicPotentials",function(b,a,c){var d=I(this.viewer.getAtomCount(),0),e=J.api.Interface.getOptionInterface("quantum.MlpCalculation");e.set(this.viewer);c=null==c?null:this.viewer.getFileAsString(c,!1);e.assignPotentials(this.viewer.modelSet.atoms,d,this.viewer.getSmartsMatch("a",b),this.viewer.getSmartsMatch("/noAromatic/[$(C=O),$(O=C),$(NC=O)]",b),a,c);return d},"JU.BS,JU.BS,~S");k(c$,"lcaoCartoon",function(){var b=this.eval;this.sm.loadShape(26);
if(1073742001==this.tokAt(1)&&this.listIsosurface(26))return!1;this.setShapeProperty(26,"init",this.fullCommand);if(1==this.slen)return this.setShapeProperty(26,"lcaoID",null),!1;for(var a=!1,c=null,c=1;c<this.slen;c++){var d=null,e=null;switch(this.getToken(c).tok){case 1074790451:case 554176565:d=b.theToken.value;1048588==this.tokAt(c+1)&&(b.iToken=c+1);e=this.getCapSlabObject(c,!0);c=b.iToken;break;case 12289:return this.isosurface(26),!1;case 528432:var f=e=0,g=0;switch(this.getToken(++c).tok){case 1112541205:e=
0.017453292*this.floatParameter(++c);break;case 1112541206:f=0.017453292*this.floatParameter(++c);break;case 1112541207:g=0.017453292*this.floatParameter(++c);break;default:this.invArg()}d="rotationAxis";e=JU.V3.new3(e,f,g);break;case 1048589:case 1610625028:case 3145768:d="on";break;case 1048588:case 12294:case 3145770:d="off";break;case 12291:d="delete";break;case 10:case 1048577:d="select";e=this.atomExpressionAt(c);c=b.iToken;break;case 1766856708:c=this.setColorOptions(null,c+1,26,-2);null!=
c&&this.setShapeProperty(26,"settranslucency",c);c=b.iToken;a=!0;continue;case 603979967:case 1073742074:b.setMeshDisplayProperty(26,c,b.theTok);c=b.iToken;a=!0;continue;case 1113200651:case 4:e=this.parameterAsString(c).toLowerCase();e.equals("spacefill")&&(e="cpk");d="create";b.optParameterAsString(c+1).equalsIgnoreCase("molecular")&&(c++,d="molecular");break;case 135280132:10==this.tokAt(c+1)||1048577==this.tokAt(c+1)?(d="select",e=this.atomExpressionAt(c+1),c=b.iToken):(d="selectType",e=this.parameterAsString(++c),
e.equals("spacefill")&&(e="cpk"));break;case 1073742138:d="scale";e=Float.$valueOf(this.floatParameter(++c));break;case 1073742004:case 1073742006:d="lonePair";break;case 1073742112:case 1073742111:d="radical";break;case 1073742028:d="molecular";break;case 1073741904:e=this.parameterAsString(++c);d="create";b.optParameterAsString(c+1).equalsIgnoreCase("molecular")&&(c++,d="molecular");break;case 1074790550:e=b.getShapeNameParameter(++c);c=b.iToken;a&&this.invArg();d="lcaoID";break;default:if(269484209==
b.theTok||J.script.T.tokAttr(b.theTok,1073741824))269484209!=b.theTok&&(e=this.parameterAsString(c)),a&&this.invArg(),d="lcaoID"}12291!=b.theTok&&(a=!0);null==d&&this.invArg();this.setShapeProperty(26,d,e)}this.setShapeProperty(26,"clear",null);return!0});k(c$,"getCapSlabObject",function(b,a){if(0>b)return J.util.TempArray.getSlabWithinRange(b,0);var c=this.eval,d=null,e=554176565==this.tokAt(b),f=this.tokAt(b+1),g=null,h=g=null,j=null,p=null;if(603979967==f)switch(j=this.isFloatParameter(++b+1)?
this.floatParameter(++b):0.5,c.isColorParam(b+1)?(j=Short.$valueOf(J.util.C.getColixTranslucent3(J.util.C.getColix(c.getArgbParam(b+1)),0!=j,j)),b=c.iToken):j=Short.$valueOf(J.util.C.getColixTranslucent3(1,0!=j,j)),f=this.tokAt(b+1)){case 1073742018:case 1073741938:p=Integer.$valueOf(f);f=this.tokAt(++b+1);break;default:p=Integer.$valueOf(1073741938)}switch(f){case 10:case 1048577:d=this.atomExpressionAt(b+1);f=3;c.iToken++;break;case 1048588:return c.iToken=b+1,Integer.$valueOf(-2147483648);case 1048587:c.iToken=
b+1;break;case 1048583:b++;d=[Float.$valueOf(1),this.parameterAsString(++b)];f=1073742018;break;case 135266325:b++;if(1073742114==this.tokAt(++b))d=this.floatParameter(++b),f=this.floatParameter(++b),d=[Float.$valueOf(d),Float.$valueOf(f)],f=1073742114;else if(this.isFloatParameter(b)){d=this.floatParameter(b);if(c.isCenterParameter(++b))if(g=this.centerParameter(b),this.chk||!C(c.expressionResult,JU.BS))g=[g];else for(var r=this.viewer.modelSet.atoms,h=c.expressionResult,g=Array(h.cardinality()),
m=0,n=h.nextSetBit(0);0<=n;n=h.nextSetBit(n+1),m++)g[m]=r[n];else g=c.getPointArray(b,-1);0==g.length&&(c.iToken=b,this.invArg());d=[Float.$valueOf(d),g,h]}else d=c.getPointArray(b,4),f=1679429641;break;case 1679429641:c.iToken=b+1;d=J.util.BoxInfo.getCriticalPoints(this.viewer.getBoundBoxVertices(),null);break;case 1073741872:case 1614417948:c.iToken=b+1;c=this.viewer.getCurrentUnitCell();if(null==c)1614417948==f&&this.invArg();else{g=J.util.BoxInfo.getCriticalPoints(c.getUnitCellVertices(),c.getCartesianOffset());
c=M(c.getUnitCellInfoType(6));d=h=null;switch(c){case 1:d=JU.V3.newVsub(g[2],g[0]),d.scale(1E3);case 2:h=JU.V3.newVsub(g[1],g[0]),h.scale(1E3),g[0].sub(h),g[1].scale(2E3),1==c&&(g[0].sub(d),g[2].scale(2E3))}d=g}break;default:if(!a&&e&&this.isFloatParameter(b+1)){d=this.floatParameter(++b);if(!this.isFloatParameter(b+1))return Integer.$valueOf(M(d));f=this.floatParameter(++b);d=[Float.$valueOf(d),Float.$valueOf(f)];f=1073742114;break}g=c.planeParameter(++b);f=this.isFloatParameter(c.iToken+1)?this.floatParameter(++c.iToken):
NaN;Float.isNaN(f)||(g.w-=f);d=g;f=135266319}return J.util.TempArray.getSlabObjectType(f,d,!e,null==p?null:[p,j])},"~N,~B");k(c$,"mo",function(b){var a=this.eval,c=2147483647,d=!1,e=this.viewer.getVisibleFramesBitSet(),f=new JU.List,g=1;if(1095766030==this.tokAt(1)||4115==this.tokAt(1))g=a.modelNumberParameter(2),0>g&&this.invArg(),e.clearAll(),e.set(g),g=3;for(var h=e.nextSetBit(0);0<=h;h=e.nextSetBit(h+1)){this.sm.loadShape(27);var j=g;if(1073742001==this.tokAt(j)&&this.listIsosurface(27))break;
this.setShapeProperty(27,"init",Integer.$valueOf(h));var p=null,r=this.getShapeProperty(27,"moNumber").intValue(),m=this.getShapeProperty(27,"moLinearCombination");if(b)break;0==r&&(r=2147483647);var n=null,k=null;switch(this.getToken(j).tok){case 1074790451:case 554176565:n=a.theToken.value;k=this.getCapSlabObject(j,!1);break;case 1073741914:n="squareLinear";k=Boolean.TRUE;m=[1];c=r=0;break;case 2:r=this.intParameter(j);m=this.moCombo(f);null==m&&0>r&&(m=[-100,-r]);break;case 269484192:switch(this.tokAt(++j)){case 1073741973:case 1073742008:break;
default:this.invArg()}d=!0;case 1073741973:case 1073742008:2147483647==(c=this.moOffset(j))&&this.invArg();r=0;m=this.moCombo(f);break;case 1073742037:r=1073742037;m=this.moCombo(f);break;case 1073742108:r=1073742108;m=this.moCombo(f);break;case 1766856708:this.setColorOptions(null,j+1,27,2);break;case 135266319:n="plane";k=a.planeParameter(j+1);break;case 135266320:this.addShapeProperty(f,"randomSeed",2==this.tokAt(j+2)?Integer.$valueOf(this.intParameter(j+2)):null);n="monteCarloCount";k=Integer.$valueOf(this.intParameter(j+
1));break;case 1073742138:n="scale";k=Float.$valueOf(this.floatParameter(j+1));break;case 1073741910:269484193==this.tokAt(j+1)?(n="cutoffPositive",k=Float.$valueOf(this.floatParameter(j+2))):(n="cutoff",k=Float.$valueOf(this.floatParameter(j+1)));break;case 536870916:n="debug";break;case 1073742054:n="plane";break;case 1073742104:case 1073742122:n="resolution";k=Float.$valueOf(this.floatParameter(j+1));break;case 1073742156:n="squareData";k=Boolean.TRUE;break;case 1073742168:j+1<this.slen&&4==this.tokAt(j+
1)&&(n="titleFormat",k=this.parameterAsString(j+1));break;case 1073741824:this.invArg();break;default:if(a.isArrayParameter(j)){m=a.floatParameterSet(j,1,2147483647);1073742156==this.tokAt(a.iToken+1)&&(this.addShapeProperty(f,"squareLinear",Boolean.TRUE),a.iToken++);break}b=a.iToken;a.setMeshDisplayProperty(27,0,a.theTok)||this.invArg();this.setShapeProperty(27,"setProperties",f);a.setMeshDisplayProperty(27,b,this.tokAt(b));return!0}null!=n&&this.addShapeProperty(f,n,k);if(2147483647!=r||null!=m)4==
this.tokAt(a.iToken+1)&&(p=this.parameterAsString(++a.iToken)),a.setCursorWait(!0),this.setMoData(f,r,m,c,d,h,p),this.addShapeProperty(f,"finalize",null);0<f.size()&&this.setShapeProperty(27,"setProperties",f);f.clear()}return!0},"~B");k(c$,"moCombo",function(b){if(1073742156!=this.tokAt(this.eval.iToken+1))return null;this.addShapeProperty(b,"squareLinear",Boolean.TRUE);this.eval.iToken++;return I(0,0)},"JU.List");k(c$,"moOffset",function(b){var a=1073741973==this.getToken(b).tok?0:1,c=this.tokAt(++b);
2==c&&0>this.intParameter(b)?a+=this.intParameter(b):269484193==c?a+=this.intParameter(++b):269484192==c&&(a-=this.intParameter(++b));return a},"~N");k(c$,"setMoData",function(b,a,c,d,e,f,g){var h=this.eval;if(!this.chk){0>f&&(f=this.viewer.getCurrentModelIndex(),0>f&&h.errorStr(30,"MO isosurfaces"));f=this.viewer.getModelAuxiliaryInfoValue(f,"moData");var j=null,p,r,m=0;if(null==c||2>c.length){null!=c&&1==c.length&&(d=0);null==f&&this.error(27);var n=f.containsKey("lastMoNumber")?f.get("lastMoNumber").intValue():
0,j=f.containsKey("lastMoCount")?f.get("lastMoCount").intValue():1;1073742108==a?a=n-1:1073742037==a&&(a=n+j);j=f.get("mos");m=null==j?0:j.size();0==m&&this.error(25);1==m&&1<a&&this.error(29);if(2147483647!=d){if(f.containsKey("HOMO"))a=f.get("HOMO").intValue()+d;else{a=-1;for(n=0;n<m;n++)if(p=j.get(n),null!=(r=p.get("occupancy"))){if(0.5>r.floatValue()){a=n;break}}else if(null!=(r=p.get("energy"))){if(0<r.floatValue()){a=n;break}}else break;0>a&&this.error(28);a+=d}J.util.Logger.info("MO "+a)}(1>
a||a>m)&&h.errorStr(26,""+m)}a=Math.abs(a);f.put("lastMoNumber",Integer.$valueOf(a));f.put("lastMoCount",Integer.$valueOf(1));e&&null==c&&(c=[-100,a]);if(null!=c&&2>c.length){p=j.get(a-1);if(null==(r=p.get("energy")))c=[100,a];else{h=r.floatValue();d=JU.BS.newN(m);e=0;c=1==c.length&&1==c[0];for(n=0;n<m;n++)if(null!=(r=j.get(n).get("energy")))if(r=r.floatValue(),c?r<=h:r==h)d.set(n+1),e+=2;c=I(e,0);for(j=n=0;n<e;n+=2)c[n]=1,c[n+1]=j=d.nextSetBit(j+1);f.put("lastMoNumber",Integer.$valueOf(d.nextSetBit(0)));
f.put("lastMoCount",Integer.$valueOf(ja(e/2)))}this.addShapeProperty(b,"squareLinear",Boolean.TRUE)}this.addShapeProperty(b,"moData",f);null!=g&&this.addShapeProperty(b,"title",g);this.addShapeProperty(b,"molecularOrbital",null!=c?c:Integer.$valueOf(Math.abs(a)));this.addShapeProperty(b,"clear",null)}},"JU.List,~N,~A,~N,~B,~N,~S");R(c$,"plot",function(b){this.st=this.eval.st;this.chk=this.eval.chk;var a=this.viewer.getCurrentModelIndex();0>a&&this.eval.errorStr(30,"plot");var a=this.viewer.getJmolDataSourceFrame(a),
c=b.length-1,d=b!==this.st,e=this.st;d&&(this.eval.st=this.st=b);var f=d?4148:b[0].tok,g=d||135270418==f||1052714==f?0:1,h=null,j=!0,p=!1;switch(f){case 135176:j=!1;p=!0;break;case 4148:j=!1;break;case 135270422:j=!1,4==J.scriptext.ScriptExt.tokAtArray(c,b)?h=this.stringParameter(c--):1048584==J.scriptext.ScriptExt.tokAtArray(c-1,b)?(h=this.parameterAsString(c-2)+"."+this.parameterAsString(c),c-=3):(this.eval.st=this.st=e,this.eval.iToken=this.st.length,this.error(13))}var d="",r=null,m="",n=!1,k=
!1,q=!1,y=!1,w=0,s=0,v=0,u=J.util.BSUtil.copy(this.viewer.getSelectedAtoms()),G="; select "+J.util.Escape.eBS(u)+";\n ",y=this.eval.optParameterAsString(c).toLowerCase(),B=null,x=null,H=J.scriptext.ScriptExt.tokAtArray(g,b);4==H&&(H=J.script.T.getTokFromName(b[g].value));switch(H){default:this.eval.iToken=1;this.invArg();break;case 135270408:this.eval.iToken=1;y="data";G="";break;case 1716520985:this.eval.iToken=g+1;(!J.script.T.tokAttr(w=this.tokAt(this.eval.iToken++),1078984704)||!J.script.T.tokAttr(s=
this.tokAt(this.eval.iToken++),1078984704))&&this.invArg();J.script.T.tokAttr(v=this.tokAt(this.eval.iToken),1078984704)?this.eval.iToken++:v=0;32==this.tokAt(this.eval.iToken)&&(B=this.getPoint3f(++this.eval.iToken,!1),this.eval.iToken++);64==this.tokAt(this.eval.iToken)&&(x=this.getPoint3f(++this.eval.iToken,!1),this.eval.iToken++);y="property "+J.script.T.nameOf(w)+" "+J.script.T.nameOf(s)+(0==v?"":" "+J.script.T.nameOf(v));0>u.nextSetBit(0)&&(u=this.viewer.getModelUndeletedAtomsBitSet(a));m="select "+
J.util.Escape.eBS(u)+";\n ";break;case 1052714:y.equalsIgnoreCase("draw")&&(y=this.eval.optParameterAsString(--c).toLowerCase());y=c>g&&y.startsWith("r");y="ramachandran"+(y?" r":"")+(135176==f?" draw":"");break;case 135270418:case 137363467:d=' "'+this.viewer.getQuaternionFrame()+'"';m="set quaternionFrame"+d+";\n  ";n=!0;y.equalsIgnoreCase("draw")&&(p=!0,y=this.eval.optParameterAsString(--c).toLowerCase());q=(k=y.startsWith("deriv")||y.startsWith("diff"))&&0<y.indexOf("2");k&&c--;if(y.equalsIgnoreCase("helix")||
y.equalsIgnoreCase("axis"))k=p=!0,c=-1;y=((c<=g?"":this.eval.optParameterAsString(c))+"w").substring(0,1);if(y.equals("a")||y.equals("r"))k=!0;JU.PT.isOneOf(y,";w;x;y;z;r;a;")||this.eval.evalError("QUATERNION [w,x,y,z,a,r] [difference][2]",null);y="quaternion "+y+(k?" difference":"")+(q?"2":"")+(p?" draw":"")}this.st=e;if(this.chk)return"";if(j&&(m+="plot "+y,b=this.viewer.getJmolDataFrameIndex(a,m),0<b&&135270422!=f&&4148!=f))return this.viewer.setCurrentModelIndexClear(b,!0),"";e=c=b=null;g=JU.P3.new3(1,
1,1);if(1716520985==H){b=this.eval.getBitsetPropertyFloat(u,w|224,null==B?NaN:B.x,null==x?NaN:x.x);c=this.eval.getBitsetPropertyFloat(u,s|224,null==B?NaN:B.y,null==x?NaN:x.y);0!=v&&(e=this.eval.getBitsetPropertyFloat(u,v|224,null==B?NaN:B.z,null==x?NaN:x.z));null==B&&(B=JU.P3.new3(this.getPlotMinMax(b,!1,w),this.getPlotMinMax(c,!1,s),this.getPlotMinMax(e,!1,v)));null==x&&(x=JU.P3.new3(this.getPlotMinMax(b,!0,w),this.getPlotMinMax(c,!0,s),this.getPlotMinMax(e,!0,v)));J.util.Logger.info("plot min/max: "+
B+" "+x);r=new JU.P3;r.ave(x,B);g.sub2(x,B);g.set(g.x/200,g.y/200,g.z/200);J.script.T.tokAttr(w,1095761920)?(g.x=1,r.x=0):0.1<g.x&&10>=g.x&&(g.x=1);J.script.T.tokAttr(s,1095761920)?(g.y=1,r.y=0):0.1<g.y&&10>=g.y&&(g.y=1);J.script.T.tokAttr(v,1095761920)?(g.z=1,r.z=0):0.1<g.z&&10>=g.z&&(g.z=1);0==v&&(r.z=B.z=x.z=g.z=0);for(j=0;j<b.length;j++)b[j]=(b[j]-r.x)/g.x;for(j=0;j<c.length;j++)c[j]=(c[j]-r.y)/g.y;if(0!=v)for(j=0;j<e.length;j++)e[j]=(e[j]-r.z)/g.z;r=[u,b,c,e,B,x,g,r]}if(135270422==f)return this.viewer.writeFileData(h,
"PLOT_"+y,a,r);h=y.equals("data")?"1 0 H 0 0 0 # Jmol PDB-encoded data":this.viewer.getPdbData(a,y,r);if(4148==f)return h;J.util.Logger.debugging&&J.util.Logger.debug(h);if(135176==f)return this.eval.runScript(h),"";f=this.viewer.getFileInfo();u=this.viewer.getBoolean(603979792);this.viewer.setAppendNew(!0);h=null!=h&&null==this.viewer.openStringInlineParamsAppend(h,null,!0);this.viewer.setAppendNew(u);this.viewer.setFileInfo(f);if(!h)return"";f=this.viewer.getModelCount();this.viewer.setJmolDataFrame(m,
a,f-1);1716520985!=H&&(m+=";\n"+G);m=this.viewer.addStateScript(m,!0,!1);h=150;switch(H){default:a="frame 0.0; frame last; reset;select visible;wireframe only;";h=10;break;case 1716520985:this.viewer.setFrameTitle(f-1,y+" plot for model "+this.viewer.getModelNumberDotted(a));a="frame 0.0; frame last; reset;select visible; spacefill 3; wireframe 0;draw plotAxisX"+f+' {100 -100 -100} {-100 -100 -100} "'+J.script.T.nameOf(w)+'";draw plotAxisY'+f+' {-100 100 -100} {-100 -100 -100} "'+J.script.T.nameOf(s)+
'";';0!=v&&(a+="draw plotAxisZ"+f+' {-100 -100 100} {-100 -100 -100} "'+J.script.T.nameOf(v)+'";');break;case 1052714:this.viewer.setFrameTitle(f-1,"ramachandran plot for model "+this.viewer.getModelNumberDotted(a));a="frame 0.0; frame last; reset;select visible; color structure; spacefill 3.0; wireframe 0;draw ramaAxisX"+f+' {100 0 0} {-100 0 0} "phi";draw ramaAxisY'+f+' {0 100 0} {0 -100 0} "psi";';break;case 135270418:case 137363467:this.viewer.setFrameTitle(f-1,y.$replace("w"," ")+d+" for model "+
this.viewer.getModelNumberDotted(a)),a=J.util.C.getHexCode(this.viewer.getColixBackgroundContrast()),a="frame 0.0; frame last; reset;select visible; wireframe 0; spacefill 3.0; isosurface quatSphere"+f+" color "+a+" sphere 100.0 mesh nofill frontonly translucent 0.8;draw quatAxis"+f+'X {100 0 0} {-100 0 0} color red "x";draw quatAxis'+f+'Y {0 100 0} {0 -100 0} color green "y";draw quatAxis'+f+'Z {0 0 100} {0 0 -100} color blue "z";color structure;draw quatCenter'+f+"{0 0 0} scale 0.02;"}this.eval.runScript(a+
G);m.setModelIndex(this.viewer.getCurrentModelIndex());this.viewer.setRotationRadius(h,!0);this.sm.loadShape(30);this.showString("frame "+this.viewer.getModelNumberDotted(f-1)+(0<y.length?" created: "+y+(n?d:""):""));return""},"~A");k(c$,"getPlotMinMax",function(b,a,c){if(null==b)return 0;switch(c){case 1112539144:case 1112539145:case 1112539146:return a?180:-180;case 1112539141:case 1112539152:return a?360:0;case 1112539150:return a?1:-1}c=a?-1E10:1E10;for(var d=b.length;0<=--d;){var e=b[d];Float.isNaN(e)||
a==e>c&&(c=e)}return c},"~A,~B,~N");k(c$,"polyhedra",function(){var b=this.eval,a=!1,c=!1,d=!1,e=!1,f=!1,g=0,h=0;this.sm.loadShape(21);this.setShapeProperty(21,"init",Boolean.TRUE);var j="centers",p="radius_",r=3.4028235E38;b.colorArgb[0]=-2147483648;for(var m=1;m<this.slen;++m){var n=null,k=null;switch(this.getToken(m).tok){case 12291:case 1048589:case 1048588:(m+1!=this.slen||a||1<h||0==h&&"to".equals(j))&&this.error(18);n=1048588==b.theTok?"off":1048589==b.theTok?"on":"delete";c=!0;break;case 269484436:case 269484080:continue;
case 1678770178:0<h&&this.invPO();a=!0;n="bonds";break;case 1666189314:p="radius";continue;case 2:case 3:0<h&&!f&&this.invPO();if(2==b.theTok&&"radius_"===p){n="nVertices";k=Integer.$valueOf(this.intParameter(m));a=!0;break}n="radius_"===p?"radius":p;k=Float.$valueOf(this.floatParameter(m));p="radius_";f=!1;a=!0;break;case 10:case 1048577:d&&this.invPO();2<++h&&b.bad();"to".equals(j)&&(a=!0);n=j;j="to";k=this.atomExpressionAt(m);m=b.iToken;break;case 1074790746:1<h&&this.invPO();if(10==this.tokAt(m+
1)||1048577==this.tokAt(m+1)&&!a){n="toBitSet";k=this.atomExpressionAt(++m);m=b.iToken;a=!0;break}else a||this.error(19);j="to";continue;case 1073741937:a||this.error(19);p="faceCenterOffset";f=!0;continue;case 1073741924:0==h&&this.error(19);p="distanceFactor";f=!0;continue;case 1766856708:case 603979967:case 1073742074:r=b.getColorTrans(m,!0);m=b.iToken;continue;case 1073741886:case 1073741948:n="collapsed";k=1073741886==b.theTok?Boolean.TRUE:Boolean.FALSE;d&&this.error(18);d=!0;break;case 1073742044:case 1073741933:case 1073741956:e&&
this.error(18);n=this.parameterAsString(m);e=!0;break;case 1073741964:g=b.theTok;continue;default:if(b.isColorParam(m)){b.colorArgb[0]=b.getArgbParam(m);m=b.iToken;continue}this.invArg()}this.setShapeProperty(21,n,k);if(c)return!1}!a&&(!d&&!e&&0==g)&&this.error(19);a&&this.setShapeProperty(21,"generate",null);-2147483648!=b.colorArgb[0]&&this.setShapeProperty(21,"colorThis",Integer.$valueOf(b.colorArgb[0]));3.4028235E38!=r&&b.setShapeTranslucency(21,"","translucentThis",r,null);0!=g&&this.setShapeProperty(21,
"token",Integer.$valueOf(g));this.setShapeProperty(21,"init",Boolean.FALSE);return!0});k(c$,"struts",function(){var b=this.eval,a=1073742072==this.tokAt(1)||1048589==this.tokAt(1)||1==this.slen,c=b.getMadParameter();a&&(c=Math.round(2E3*this.viewer.getFloat(570425406)));this.setShapeProperty(1,"type",Integer.$valueOf(32768));b.setShapeSizeBs(1,c,null);this.setShapeProperty(1,"type",Integer.$valueOf(1023));return!0});k(c$,"initIsosurface",function(b){var a=this.eval;this.setShapeProperty(b,"init",
this.fullCommand);a.iToken=0;var c=this.tokAt(1),d=this.tokAt(2);if(12291==c||12291==d&&1048579==this.tokAt(++a.iToken))return this.setShapeProperty(b,"delete",null),a.iToken+=2,this.slen>a.iToken&&(this.setShapeProperty(b,"init",this.fullCommand),this.setShapeProperty(b,"thisID","+PREVIOUS_MESH+")),null;a.iToken=1;return!a.setMeshDisplayProperty(b,0,c)&&(this.setShapeProperty(b,"thisID","+PREVIOUS_MESH+"),22!=b&&this.setShapeProperty(b,"title",[this.thisCommand]),1074790550!=c&&(269484209==d||269484209==
c&&a.setMeshDisplayProperty(b,0,d)))?(b=this.setShapeId(b,1,!1),a.iToken++,b):null},"~N");k(c$,"getWithinDistanceVector",function(b,a,c,d,e){var f=new JU.List,g=Array(2);if(null==d){var h=JU.P3.new3(a,a,a),j=JU.P3.newP(c);j.sub(h);h.add(c);g[0]=j;g[1]=h;f.addLast(c)}else c=this.viewer.getBoxInfo(d,-Math.abs(a)),g[0]=c.getBoundBoxVertices()[0],g[1]=c.getBoundBoxVertices()[7],1==d.cardinality()&&f.addLast(this.viewer.getAtomPoint3f(d.nextSetBit(0)));1==f.size()&&!e&&(this.addShapeProperty(b,"withinDistance",
Float.$valueOf(a)),this.addShapeProperty(b,"withinPoint",f.get(0)));this.addShapeProperty(b,e?"displayWithin":"withinPoints",[Float.$valueOf(a),g,d,f])},"JU.List,~N,JU.P3,JU.BS,~B");k(c$,"setColorOptions",function(b,a,c,d){var e=this.eval;this.getToken(a);var f="opaque";if(603979967==e.theTok)if(f="translucent",0>d){var g=this.isFloatParameter(a+1)?this.floatParameter(++a):3.4028235E38;e.setShapeTranslucency(c,null,"translucent",g,null);null!=b&&(b.append(" translucent"),3.4028235E38!=g&&b.append(" ").appendF(g))}else e.setMeshDisplayProperty(c,
a,e.theTok);else 1073742074==e.theTok?0<=d&&e.setMeshDisplayProperty(c,a,e.theTok):e.iToken--;d=Math.abs(d);for(g=0;g<d;g++)if(e.isColorParam(e.iToken+1)){var h=e.getArgbParam(++e.iToken);this.setShapeProperty(c,"colorRGB",Integer.$valueOf(h));null!=b&&b.append(" ").append(J.util.Escape.escapeColor(h))}else if(e.iToken<a)this.invArg();else break;return f},"JU.SB,~N,~N,~N");k(c$,"addShapeProperty",function(b,a,c){this.chk||b.addLast([a,c])},"JU.List,~S,~O");k(c$,"createFunction",function(b,a,c){var d=
new J.script.ScriptEvaluator;d.setViewer(this.viewer);try{d.compileScript(null,"function "+b+"("+a+") { return "+c+"}",!1);var e=new JU.List;for(b=0;b<a.length;b+=2)e.addLast(J.script.SV.newV(3,Float.$valueOf(0)).setName(a.substring(b,b+1)));return[d.aatoken[0][1].value,e]}catch(f){if(S(f,Exception))return null;throw f;}},"~S,~S,~S");k(c$,"floatArraySet",function(b,a,c){var d=this.tokAt(b++);1073742195==d&&(d=this.tokAt(b++));269484096!=d&&this.invArg();for(var e=JU.AU.newFloat2(a),f=0;269484097!=
d;)switch(d=this.getToken(b).tok,d){case 1073742195:case 269484097:continue;case 269484080:b++;break;case 269484096:b++;d=I(c,0);e[f++]=d;for(var g=0;g<c;g++)d[g]=this.floatParameter(b++),269484080==this.tokAt(b)&&b++;269484097!=this.tokAt(b++)&&this.invArg();d=0;f==a&&269484097!=this.tokAt(b)&&this.invArg();break;default:this.invArg()}return e},"~N,~N,~N");k(c$,"floatArraySetXYZ",function(b,a,c,d){var e=this.eval,f=this.tokAt(b++);1073742195==f&&(f=this.tokAt(b++));(269484096!=f||0>=a)&&this.invArg();
for(var g=JU.AU.newFloat3(a,-1),h=0;269484097!=f;)switch(f=this.getToken(b).tok,f){case 1073742195:case 269484097:continue;case 269484080:b++;break;case 269484096:g[h++]=this.floatArraySet(b,c,d);b=++e.iToken;f=0;h==a&&269484097!=this.tokAt(b)&&this.invArg();break;default:this.invArg()}return g},"~N,~N,~N,~N");k(c$,"listIsosurface",function(b){var a=3<this.slen?"0":0==this.tokAt(2)?"":" "+this.getToken(2).value;this.chk||this.showString(this.getShapeProperty(b,"list"+a));return!0},"~N");R(c$,"getBitsetIdent",
function(b,a,c,d,e,f){var g=!C(c,J.modelset.BondSet);g&&(null==a?a=this.viewer.getStandardLabelFormat(0):0==a.length&&(a="%[label]"));var h=null==a?-1:a.indexOf("%"),j=2147483647!=e;if(null==b||this.chk||g&&0>h)return null==a&&(a=""),f?[a]:a;var h=this.viewer.modelSet,p=0,r=h.getLabeler();c=g||!d?null:c.getAssociatedAtoms();null==c&&(null!=a&&0<a.indexOf("%D"))&&(c=this.viewer.getAtomIndices(b));d=null==a||0==a.length;var m=g||d?null:J.modelset.LabelToken.getBondLabelValues();a=d?null:g?r.compile(this.viewer,
a,"\x00",null):r.compile(this.viewer,a,"\u0001",m);var n=j?1:J.util.BSUtil.cardinalityOf(b),k=Array(n);for(e=j?e:b.nextSetBit(0);0<=e;e=b.nextSetBit(e+1)){var q;g?q=d?h.atoms[e].getInfo():r.formatLabelAtomArray(this.viewer,h.atoms[e],a,"\x00",c):(q=h.getBondAt(e),q=d?q.getIdentity():r.formatLabelBond(this.viewer,q,a,m,c));q=J.util.Txt.formatStringI(q,"#",p+1);k[p++]=q;if(j)break}return 1==n&&!f?k[0]:k},"JU.BS,~S,~O,~B,~N,~B");k(c$,"data",function(){var b=this.eval,a=null,c=null,d=!1,e;switch(b.iToken=
this.slen){case 5:a=this.parameterAsString(2);case 4:case 2:c=this.parameterAsString(1);if(c.equalsIgnoreCase("clear")){this.chk||this.viewer.setData(null,null,0,0,0,0,0);return}if(0<=(e=c.indexOf("@")))a=""+b.getParameter(c.substring(e+1),4),c=c.substring(0,e).trim();else if(null==a&&0<=(e=c.indexOf(" ")))a=c.substring(e+1).trim(),c=c.substring(0,e).trim(),d=!0;break;default:b.bad()}e=c+" ";e=e.substring(0,e.indexOf(" ")).toLowerCase();if(e.equals("model")||e.equals("append"))b.load();else if(!this.chk)if(b=
0<=c.toLowerCase().indexOf("(default)"),e.equals("connect_atoms"))this.viewer.connect(J.util.Parser.parseFloatArray2d(a));else if(0==e.indexOf("ligand_"))this.viewer.setLigandModel(c.substring(7).toUpperCase()+"_data",a.trim());else if(0==e.indexOf("file_"))this.viewer.setLigandModel(c.substring(5).toUpperCase()+"_file",a.trim());else if(this.$data=Array(4),e.equals("element_vdw")){this.$data[0]=e;this.$data[1]=a.$replace(";","\n");a=J.util.Elements.elementNumberMax;e=Y(a+1,0);for(b=1;b<=a;b++)e[b]=
b;this.$data[2]=e;this.$data[3]=Integer.$valueOf(0);this.viewer.setData("element_vdw",this.$data,a,0,0,0,0)}else if(0==e.indexOf("data2d_"))this.$data[0]=c,this.$data[1]=J.util.Parser.parseFloatArray2d(a),this.$data[3]=Integer.$valueOf(2),this.viewer.setData(c,this.$data,0,0,0,0,0);else if(0==e.indexOf("data3d_"))this.$data[0]=c,this.$data[1]=J.util.Parser.parseFloatArray3d(a),this.$data[3]=Integer.$valueOf(3),this.viewer.setData(c,this.$data,0,0,0,0,0);else{var f=JU.PT.getTokens(c);if(0==e.indexOf("property_")&&
!(2==f.length&&f[1].equals("set"))){b=this.viewer.getSelectedAtoms();this.$data[0]=e;var g=d?0:this.viewer.getParameter("propertyAtomNumberField").intValue(),h=d?0:this.viewer.getParameter("propertyAtomNumberColumnCount").intValue(),j=d?-2147483648:this.viewer.getParameter("propertyDataField").intValue(),p=d?0:this.viewer.getParameter("propertyDataColumnCount").intValue();!d&&0<=c.indexOf(" ")&&(3==f.length&&(g=JU.PT.parseInt(f[1]),j=JU.PT.parseInt(f[2])),5==f.length&&(g=JU.PT.parseInt(f[1]),h=JU.PT.parseInt(f[2]),
j=JU.PT.parseInt(f[3]),p=JU.PT.parseInt(f[4])));0>g&&(g=0);0>j&&(j=0);c=this.viewer.getAtomCount();d=null;f=JU.BS.newN(c);if(0<g){for(var d=Y(c+2,0),r=0;r<=c;r++)d[r]=-1;for(r=b.nextSetBit(0);0<=r;r=b.nextSetBit(r+1)){var m=this.viewer.getAtomNumber(r);m>c+1||(0>m||f.get(m))||(f.set(m),d[m]=r)}this.$data[2]=d}else this.$data[2]=J.util.BSUtil.copy(b);this.$data[1]=a;this.$data[3]=Integer.$valueOf(0);this.viewer.setData(e,this.$data,c,g,h,j,p)}else g=J.modelset.AtomCollection.getUserSettableType(e),
0<=g?this.viewer.setAtomData(g,e,a,b):(this.$data[0]=c,this.$data[1]=a,this.$data[3]=Integer.$valueOf(0),this.viewer.setData(e,this.$data,0,0,0,0,0))}});k(c$,"navigate",function(){var b=this.eval;if(1==this.slen)b.setBooleanProperty("navigationMode",!0);else{var a=JU.V3.new3(0,1,0),c=new JU.List,d;if(2==this.slen)switch(this.getToken(1).tok){case 1048589:case 1048588:if(this.chk)return;b.setObjectMad(31,"axes",1);this.setShapeProperty(31,"position",JU.P3.new3(50,50,3.4028235E38));b.setBooleanProperty("navigationMode",
!0);this.viewer.setNavOn(1048589==b.theTok);return;case 1073742162:this.chk||this.viewer.setNavXYZ(0,0,0);return;case 8:case 1113200654:break;default:this.invArg()}!this.chk&&!this.viewer.getBoolean(603979887)&&b.setBooleanProperty("navigationMode",!0);for(var e=1;e<this.slen;e++){var f=this.isFloatParameter(e)?this.floatParameter(e++):2;0>f&&this.invArg();!this.chk&&0<f&&b.refresh(!1);switch(this.getToken(e).tok){case 8:case 1048586:d=this.getPoint3f(e,!0);b.iToken++;b.iToken!=this.slen&&this.invArg();
this.chk||this.viewer.setNavXYZ(d.x,d.y,d.z);return;case 554176526:d=this.floatParameter(++e);this.chk||c.addLast([Integer.$valueOf(554176526),Float.$valueOf(f),Float.$valueOf(d)]);continue;case 12289:d=this.centerParameter(++e);e=b.iToken;this.chk||c.addLast([Integer.$valueOf(135266320),Float.$valueOf(f),d]);continue;case 528432:switch(this.getToken(++e).tok){case 1112541205:a.set(1,0,0);e++;break;case 1112541206:a.set(0,1,0);e++;break;case 1112541207:a.set(0,0,1);e++;break;case 8:case 1048586:a.setT(this.getPoint3f(e,
!0));e=b.iToken+1;break;case 1073741824:this.invArg()}d=this.floatParameter(e);this.chk||c.addLast([Integer.$valueOf(528432),Float.$valueOf(f),a,Float.$valueOf(d)]);continue;case 4160:var g=d=NaN;if(this.isFloatParameter(++e))d=this.floatParameter(e),g=this.floatParameter(++e);else switch(this.tokAt(e)){case 1112541205:d=this.floatParameter(++e);break;case 1112541206:g=this.floatParameter(++e);break;default:d=this.centerParameter(e);e=b.iToken;this.chk||c.addLast([Integer.$valueOf(4160),Float.$valueOf(f),
d]);continue}this.chk||c.addLast([Integer.$valueOf(269484210),Float.$valueOf(f),Float.$valueOf(d),Float.$valueOf(g)]);continue;case 269484208:continue;case 1113200654:d=new JU.List;10==this.tokAt(e+1)||1048577==this.tokAt(e+1)?(g=this.atomExpressionAt(++e),e=b.iToken):g=this.viewer.getSelectedAtoms();if(this.chk)return;this.viewer.getPolymerPointsAndVectors(g,d);var h;if(0<(h=d.size())){for(var g=Array(h),j=0;j<h;j++)g[j]=d.get(j);c.addLast([Integer.$valueOf(1113200654),Float.$valueOf(f),g]);continue}break;
case 1073742084:if(1048583==this.getToken(e+1).tok){e++;d=b.objectNameParameter(++e);if(this.chk)return;this.setShapeProperty(22,"thisID",d);d=this.getShapeProperty(22,"vertices");b.refresh(!1);null==d&&this.invArg();g=M(this.isFloatParameter(e+1)?this.floatParameter(++e):0);h=M(this.isFloatParameter(e+1)?this.floatParameter(++e):2147483647);c.addLast([Integer.$valueOf(1073742084),Float.$valueOf(f),d,null,[g,h]]);continue}for(d=new JU.List;b.isCenterParameter(e+1);)d.addLast(this.centerParameter(++e)),
e=b.iToken;if(0<d.size()){d=d.toArray(Array(d.size()));this.chk||c.addLast([Integer.$valueOf(1073742084),Float.$valueOf(f),d,null,[0,2147483647]]);continue}default:this.invArg()}}this.chk||this.viewer.navigateList(b,c)}});R(c$,"evaluateParallel",function(b,a){var c=new J.script.ScriptEvaluator;c.setViewer(this.viewer);c.historyDisabled=!0;c.compiler=new J.script.ScriptCompiler(this.viewer);c.sm=a;try{c.restoreScriptContext(b,!0,!1,!1),c.allowJSThreads=!1,c.dispatchCommands(!1,!1)}catch(d){if(S(d,
Exception))return this.eval.viewer.setStringProperty("_errormessage",""+d),null==c.thisContext&&(J.util.Logger.error("Error evaluating context "+d),this.viewer.isJS||d.printStackTrace()),!1;throw d;}return!0},"J.script.ScriptContext,J.viewer.ShapeManager");R(c$,"write",function(b){var a=0,c=0,d,e;null==b?(b=this.st,a=c=1,d=!0,e=this.viewer.isApplet()&&!this.viewer.isSignedApplet()||!this.viewer.haveAccess(J.viewer.Viewer.ACCESS.ALL)||0<this.viewer.getPathForAllFiles().length):(d=!1,e=!0);var f=d?
this.slen:b.length,g=0,h=0,j=-1,p=-1,r=-2147483648,m=this.viewer.getBoolean(603979934),n=this.viewer.getExportDriverList(),k="PNGJ",q=null,y="",w=null,s=null,v=null,u=null,G=null,B=Array(1),x=!1,H=!1,E=!1,K=null,I=null,z="SPT",L=d&&1==b.length?1073741884:J.scriptext.ScriptExt.tokAtArray(a,b);switch(L){case 0:break;case 135271429:this.eval.isArrayParameter(a+1)&&(I=this.eval.stringParameterSet(++a),v=s=".",c=a=this.eval.iToken+1,L=this.tokAt(a));break;default:z=J.script.SV.sValue(this.tokenAt(a,b)).toUpperCase()}d&&
1073741848==this.tokAt(this.slen-2)&&(z=this.parameterAsString(this.slen-1).toUpperCase(),c=f,f-=2,L=0);switch(L){case 135270418:case 1052714:case 1716520985:G=this.plot(b);if(!d)return G;break;case 1073741983:z="INLINE";q=J.script.SV.sValue(this.tokenAt(++a,b));a++;break;case 1073742102:z="PGRP";a++;y=J.script.SV.sValue(this.tokenAt(a,b)).toLowerCase();y.equals("draw")&&a++;break;case 1048582:a++;x=!0;break;case 1073742158:case 135271429:for(u=J.script.SV.sValue(this.tokenAt(++a,b)).toLowerCase();u.equals("localpath")||
u.equals("remotepath");)u.equals("localpath")?s=J.script.SV.sValue(this.tokenAt(++a,b)):v=J.script.SV.sValue(this.tokenAt(++a,b)),u=J.script.SV.sValue(this.tokenAt(++a,b)).toLowerCase();z="SPT";break;case 1229984263:case 135368713:case 1610616855:case 135180:case 1073742015:case 1073742018:case 1183762:case 135188:a++;break;case 1073741992:z="ZIPALL";a++;break;case 36868:z="VAR";a+=2;break;case 4115:case 1073741824:case 1073741979:case 1073742139:case 4:case 4166:switch(L){case 1073741979:a++;break;
case 4166:h=this.eval.intParameterRange(++a,1,10);this.chk||(this.viewer.setVibrationOff(),this.eval.isJS||this.eval.delayScript(100));a++;break;case 4115:var M;a+1<f&&1048577==b[++a].tok||10==b[a].tok?(M=this.eval.atomExpression(b,a,0,!0,!1,!0,!0),a=this.eval.iToken+1):M=this.viewer.getAllAtoms();this.chk||(K=this.viewer.getModelBitSet(M,!0));break;case 1073742139:u=J.script.SV.sValue(this.tokenAt(++a,b)).toUpperCase();JU.PT.isOneOf(u,";PNG;PNGJ;")&&(k=u,a++);break;default:L=1073741979}if(1073741979==
L)if(L=J.script.T.getTokenFromName(J.script.SV.sValue(b[a]).toLowerCase()),null!=L&&(z=J.script.SV.sValue(L).toUpperCase()),JU.PT.isOneOf(z,n.toUpperCase())){a++;z=z.substring(0,1).toUpperCase()+z.substring(1).toLowerCase();H=!0;d&&(w="Jmol."+z.toLowerCase());break}else if(JU.PT.isOneOf(z,";ZIP;ZIPALL;SPT;STATE;")){a++;break}else z="(image)";2==J.scriptext.ScriptExt.tokAtArray(a,b)&&(j=J.script.SV.iValue(this.tokenAt(a++,b)),p=J.script.SV.iValue(this.tokenAt(a++,b)))}if(null==G){if(c<f){u=J.script.SV.sValue(this.tokenAt(a,
b));if(u.equalsIgnoreCase("clipboard")){if(this.chk)return""}else JU.PT.isOneOf(u.toLowerCase(),";jpg;jpeg;jpg64;jpeg64;gif;pdf;ppm;png;pngj;pngt;")?(2==J.scriptext.ScriptExt.tokAtArray(a+1,b)&&2==J.scriptext.ScriptExt.tokAtArray(a+2,b)&&(j=J.script.SV.iValue(this.tokenAt(++a,b)),p=J.script.SV.iValue(this.tokenAt(++a,b))),2==J.scriptext.ScriptExt.tokAtArray(a+1,b)&&(r=J.script.SV.iValue(this.tokenAt(++a,b)))):JU.PT.isOneOf(u.toLowerCase(),";xyz;xyzrn;xyzvib;mol;sdf;v2000;v3000;json;pdb;pqr;cml;")&&
(z=u.toUpperCase(),a+1==f&&a++);z.equals("(image)")&&JU.PT.isOneOf(u.toLowerCase(),";jpg;jpeg;jpg64;jpeg64;gif;pdf;ppm;png;pngj;pngt;scene;")&&(z=u.toUpperCase(),a++)}a+2==f&&(E=J.script.SV.sValue(this.tokenAt(++a,b)),0<E.length&&"."!=E.charAt(0)&&(z=u.toUpperCase()));switch(J.scriptext.ScriptExt.tokAtArray(a,b)){case 0:e=!0;break;case 1073741884:break;case 1073741824:case 4:w=J.script.SV.sValue(this.tokenAt(a,b));a==f-3&&1048584==J.scriptext.ScriptExt.tokAtArray(a+1,b)&&(w+="."+J.script.SV.sValue(this.tokenAt(a+
2,b)));if("VAR"!==z&&a==c)z="IMAGE";else if(0<w.length&&"."==w.charAt(0)&&(a==c+1||a==c+2))w=J.script.SV.sValue(this.tokenAt(a-1,b))+w,"VAR"!==z&&a==c+1&&(z="IMAGE");if(w.equalsIgnoreCase("clipboard")||!this.viewer.haveAccess(J.viewer.Viewer.ACCESS.ALL))w=null;break;default:this.invArg()}if(z.equals("IMAGE")||z.equals("(image)")||z.equals("FRAME")||z.equals("VIBRATION"))z=null!=w&&0<=w.indexOf(".")?w.substring(w.lastIndexOf(".")+1).toUpperCase():"JPG";z.equals("MNU")?z="MENU":z.equals("WRL")||z.equals("VRML")?
(z="Vrml",H=!0):z.equals("X3D")?(z="X3d",H=!0):z.equals("IDTF")?(z="Idtf",H=!0):z.equals("MA")?(z="Maya",H=!0):z.equals("JS")?(z="Js",H=!0):z.equals("OBJ")?(z="Obj",H=!0):z.equals("JVXL")?z="ISOSURFACE":z.equals("XJVXL")?z="ISOSURFACE":z.equals("JMOL")?z="ZIPALL":z.equals("HIS")&&(z="HISTORY");z.equals("COORD")&&(z=null!=w&&0<=w.indexOf(".")?w.substring(w.lastIndexOf(".")+1).toUpperCase():"XYZ");E=JU.PT.isOneOf(z.toLowerCase(),";jpg;jpeg;jpg64;jpeg64;gif;pdf;ppm;png;pngj;pngt;scene;");null!=I&&(z.equals("PNG")&&
(z="PNGJ"),!z.equals("PNGJ")&&!z.equals("ZIPALL")&&this.invArg());!E&&(!H&&!JU.PT.isOneOf(z,";SCENE;JMOL;ZIP;ZIPALL;SPT;HISTORY;MO;ISOSURFACE;MESH;PMESH;VAR;FILE;FUNCTION;CML;JSON;XYZ;XYZRN;XYZVIB;MENU;MOL;PDB;PGRP;PQR;QUAT;RAMA;SDF;V2000;V3000;INLINE;"))&&this.eval.errorStr2(54,"COORDS|FILE|FUNCTIONS|HISTORY|IMAGE|INLINE|ISOSURFACE|JMOL|MENU|MO|POINTGROUP|QUATERNION [w,x,y,z] [derivative]|RAMACHANDRAN|SPT|STATE|VAR x|ZIP|ZIPALL  CLIPBOARD","CML|GIF|JPG|JPG64|JMOL|JVXL|MESH|MOL|PDB|PMESH|PNG|PNGJ|PNGT|PPM|PQR|SDF|CD|JSON|V2000|V3000|SPT|XJVXL|XYZ|XYZRN|XYZVIB|ZIP"+
n.toUpperCase().$replace(";","|"));if(this.chk)return"";a=null;c=!1;if(null==q||H){q=z.intern();if(H){m&&J.util.Logger.startTimer("export");h=new java.util.Hashtable;h.put("type",q);null!=w&&h.put("fileName",w);(d||null!=w)&&h.put("fullPath",B);h.put("width",Integer.$valueOf(j));h.put("height",Integer.$valueOf(p));q=this.viewer.generateOutputForExport(h);if(null==q||0==q.length)return"";if(!d)return q;(z.equals("Povray")||z.equals("Idtf"))&&null!=B[0]?(j=z.equals("Idtf")?".tex":".ini",w=B[0]+j,d=
new java.util.Hashtable,d.put("fileName",w),d.put("type",j),d.put("text",q),d.put("fullPath",B),G=this.viewer.processWriteOrCapture(d),z.equals("Idtf")&&(q=q.substring(0,q.indexOf("\\begin{comment}"))),q="Created "+B[0]+":\n\n"+q,m&&this.showString(J.util.Logger.getTimerMsg("export",0))):G=q;null!=G&&(G.startsWith("OK")||this.eval.evalError(G,null),this.eval.scriptStatusOrBuffer(q));return""}if("MENU"===q)q=this.viewer.getMenu("");else if("PGRP"===q)q=this.viewer.getPointGroupAsString(y.equals("draw"),
null,0,1);else if("PDB"===q||"PQR"===q)e?q=this.viewer.getPdbAtomData(null,null):c=!0;else if("FILE"===q)e?q=this.viewer.getCurrentFileAsString():c=!0,"?".equals(w)&&(w="?Jmol."+this.viewer.getParameter("_fileType"));else if(("SDF"===q||"MOL"===q||"V2000"===q||"V3000"===q||"CD"===q||"JSON"===q)&&x)q=this.viewer.getModelExtract("selected",!0,!1,q),q.startsWith("ERROR:")&&(a=q);else if("XYZ"===q||"XYZRN"===q||"XYZVIB"===q||"MOL"===q||"SDF"===q||"V2000"===q||"V3000"===q||"CML"===q||"CD"===q||"JSON"===
q)q=this.viewer.getData("selected",q),q.startsWith("ERROR:")&&(a=q);else if("FUNCTION"===q)q=this.viewer.getFunctionCalls(null),z="TXT";else if("VAR"===q)q=this.eval.getParameter(J.script.SV.sValue(this.tokenAt(d?2:1,b)),1073742190).asString(),z="TXT";else if("SPT"===q)if(x)b=this.viewer.getTaintedAtoms(2),this.viewer.setAtomCoordsRelative(JU.P3.new3(0,0,0),null),q=this.viewer.getStateInfo(),this.viewer.setTaintedAtoms(b,2);else{if(q=this.viewer.getStateInfo(),null!=s||null!=v)q=J.viewer.FileManager.setScriptFileReferences(q,
s,v,null)}else"ZIP"===q||"ZIPALL"===q?null!=w&&null==(a=q=this.viewer.createZip(w,z,I))&&this.eval.evalError("#CANCELED#",null):"HISTORY"===q?(q=this.viewer.getSetHistory(2147483647),z="SPT"):"MO"===q?(q=this.getMoJvxl(2147483647),z="XJVXL"):"PMESH"===q?(null==(q=this.getIsosurfaceJvxl(!0,28))&&this.error(31),z="XJVXL"):"ISOSURFACE"===q||"MESH"===q?(null==(q=this.getIsosurfaceJvxl("MESH"===q,24))&&this.error(31),z=0<=q.indexOf("<?xml")?"XJVXL":"JVXL",e||this.showString(this.getShapeProperty(24,"jvxlFileInfo"))):
(g=-1,0>r&&(r=-1));null==q&&!c&&(q="");0==g&&!c&&(null==a||C(a,String));E&&(this.eval.refresh(!1),0>j&&(j=this.viewer.getScreenWidth()),0>p&&(p=this.viewer.getScreenHeight()))}if(!d)return q;if(e)return this.eval.showStringPrint(q,!0),"";if(null!=a&&C(a,String))return 0!=a.indexOf("OK")&&alert(a),this.eval.scriptStatusOrBuffer(a),a;if(z.equals("SCENE"))a=k;else if(null==a&&(!E||null!=w))a=q;m&&J.util.Logger.startTimer("write");c?G=this.viewer.writeFileData(w,z,0,null):(d=new java.util.Hashtable,null!=
w&&d.put("fileName",w),d.put("type",z),C(a,String)&&-2147483648==r?d.put("text",a):C(a,Array)&&d.put("bytes",a),null!=I&&d.put("scripts",I),null!=K&&d.put("bsFrames",K),d.put("fullPath",B),d.put("quality",Integer.$valueOf(r)),d.put("width",Integer.$valueOf(j)),d.put("height",Integer.$valueOf(p)),d.put("nVibes",Integer.$valueOf(h)),G=this.viewer.processWriteOrCapture(d));m&&this.showString(J.util.Logger.getTimerMsg("write",0))}return!this.chk&&null!=G?(G.startsWith("OK")||(this.eval.evalError(G,null),
alert(G)),this.eval.scriptStatusOrBuffer(G+(E?"; width="+j+"; height="+p:"")),G):""},"~A");k(c$,"show",function(){var b=null,a=this.parameterAsString(1),c=null,d=null,e=2,f=this.getToken(1),d=C(f,J.script.SV)?0:f.tok;4==d&&(f=J.script.T.getTokenFromName(a.toLowerCase()),null!=f&&(d=f.tok));1297090050!=d&&1073742158!=d&&this.checkLength(-3);if(2==this.slen&&0<=a.indexOf("?"))this.showString(this.viewer.getAllSettings(a.substring(0,a.indexOf("?"))));else{switch(d){case 0:this.chk||(c=this.eval.theToken.escape());
break;case 135270423:this.chk||(c=J.util.Escape.e(this.viewer.cacheList()));break;case 1073741915:this.checkLength(2);this.chk||(c=this.viewer.calculateStructures(null,!0,!1));break;case 545259571:this.checkLength(2);this.chk||(c=this.viewer.getPathForAllFiles());break;case 1073742038:if(this.eval.optParameterAsString(2).equalsIgnoreCase("1H")){e=3;this.chk||(c=this.viewer.getNMRPredict(!1));break}this.chk||this.viewer.getNMRPredict(!0);return;case 135267336:case 1073741929:case 1073741879:this.checkLength(1073741879==
d?3:2);if(this.chk)return;try{c=this.viewer.getSmiles(null)}catch(g){if(S(g,Exception))c=g.getMessage();else throw g;}switch(d){case 1073741929:if(0<c.length){this.viewer.show2D(c);return}c="Could not show drawing -- Either insufficient atoms are selected or the model is a PDB file.";break;case 1073741879:if(e=3,f=null,0<c.length){d="/";switch(this.getToken(2).tok){case 1073741977:d="I";break;case 1073741978:d="K";break;case 1073742035:d="N";break;default:f=this.parameterAsString(2)}c=this.viewer.getChemicalInfo(c,
d,f);0<=c.indexOf("FileNotFound")&&(c="?")}else c="Could not show name -- Either insufficient atoms are selected or the model is a PDB file."}break;case 1297090050:3<this.slen?(e=this.centerParameter(2),f=this.centerParameter(++this.eval.iToken),this.chk||(c=this.viewer.getSymmetryOperation(null,0,e,f,!1)),e=++this.eval.iToken):(e=2==this.eval.checkLength23()?0:this.intParameter(2),this.chk||(c=this.viewer.getSymmetryOperation(null,e,null,null,!1)),e=-3);break;case 1649412120:b=null;2<this.slen&&
(b=J.constant.EnumVdw.getVdwType(this.parameterAsString(2)),null==b&&this.invArg());this.chk||this.showString(this.viewer.getDefaultVdwNameOrData(0,b,null));return;case 135368713:this.eval.checkLength23();this.chk||this.showString(this.viewer.getFunctionCalls(this.eval.optParameterAsString(2)));return;case 1085443:this.checkLength(2);this.chk||this.showString(this.viewer.getAllSettings(null));return;case 1074790760:if(2==this.slen){this.chk||this.viewer.showUrl(this.eval.getFullPathName());return}d=
this.parameterAsString(2);this.chk||this.viewer.showUrl(d);return;case 1766856708:a="defaultColorScheme";break;case 1610612740:a="scaleAngstromsPerInch";break;case 135270418:case 1052714:if(this.chk)return;0>this.viewer.getCurrentModelIndex()&&this.eval.errorStr(30,"show "+this.eval.theToken.value);c=this.plot(this.st);e=this.slen;break;case 1113200654:this.chk||(c=this.getContext(!1));break;case 1073741888:d=this.eval.optParameterAsString(2);0<d.length&&(e=3);this.chk||(b=this.viewer.getColorSchemeList(d));
break;case 1073742192:this.chk||(c=this.viewer.getAtomDefs(this.eval.definedAtomSets)+this.viewer.getVariableList()+this.getContext(!0));break;case 536870926:this.chk||(c=this.viewer.getTrajectoryState());break;case 553648148:b=""+this.eval.commandHistoryLevelMax;break;case 553648150:b=""+J.util.Logger.getLogLevel();break;case 603979825:b=""+this.viewer.getBoolean(603979825);break;case 553648178:c="set strandCountForStrands "+this.viewer.getStrandCount(12)+"; set strandCountForMeshRibbon "+this.viewer.getStrandCount(13);
break;case 536875070:c=this.viewer.showTimeout(2==(e=this.slen)?null:this.parameterAsString(2));break;case 536870918:b=J.util.Escape.eP(this.viewer.getDefaultLattice());break;case 4126:this.chk||(c=this.viewer.getMinimizationInfo());break;case 1611272194:switch(this.viewer.getAxesMode()){case J.constant.EnumAxesMode.UNITCELL:c="set axesUnitcell";break;case J.constant.EnumAxesMode.BOUNDBOX:c="set axesWindow";break;default:c="set axesMolecular"}break;case 1610612737:c="set bondMode "+(this.viewer.getBoolean(603979812)?
"OR":"AND");break;case 1650071565:this.chk||(c="set strandCountForStrands "+this.viewer.getStrandCount(12)+"; set strandCountForMeshRibbon "+this.viewer.getStrandCount(13));break;case 1612189718:c="set hbondsBackbone "+this.viewer.getBoolean(603979852)+";set hbondsSolid "+this.viewer.getBoolean(603979854);break;case 1611141175:this.chk||(c=this.viewer.getSpinState());break;case 1611141176:c="set ssbondsBackbone "+this.viewer.getBoolean(603979952);break;case 1610625028:case 1611141171:c="selectionHalos "+
(this.viewer.getSelectionHaloEnabled(!1)?"ON":"OFF");break;case 1613758470:c="set selectHetero "+this.viewer.getBoolean(1613758470);break;case 1073741828:c=J.util.Escape.eAP(this.viewer.getAdditionalHydrogens(null,!0,!0,null));break;case 1613758476:c="set selectHydrogens "+this.viewer.getBoolean(1613758476);break;case 553648130:case 553648142:case 536870924:case 553648176:case 553648172:case 1073741995:this.chk||(c=this.viewer.getSpecularState());break;case 4146:this.chk||(c=this.viewer.listSavedStates());
break;case 1614417948:this.chk||(c=this.viewer.getUnitCellInfoText());break;case 1048582:if(2==(e=this.slen)){this.chk||(c=this.viewer.getCoordinateState(this.viewer.getSelectedAtoms()));break}f=this.parameterAsString(2);this.chk||(c=this.viewer.getSavedCoordinates(f));break;case 1073742158:this.chk||this.viewer.clearConsole();if(2==(e=this.slen)){this.chk||(c=this.viewer.getStateInfo());break}d=this.parameterAsString(2);if(d.equals("/")&&4==(e=this.slen)){d=this.parameterAsString(3).toLowerCase();
if(!this.chk){for(var f=JU.PT.split(this.viewer.getStateInfo(),"\n"),c=new JU.SB,h=0;h<f.length;h++)0<=f[h].toLowerCase().indexOf(d)&&c.append(f[h]).appendC("\n");c=c.toString()}break}else if(1229984263==this.tokAt(2)&&4==(e=this.slen)){this.chk||(c=this.viewer.getEmbeddedFileState(this.parameterAsString(3)));break}e=3;this.chk||(c=this.viewer.getSavedState(d));break;case 1641025539:if(2==(e=this.slen)){this.chk||(c=this.viewer.getProteinStructureState());break}f=this.parameterAsString(2);this.chk||
(c=this.viewer.getSavedStructure(f));break;case 135270408:d=3==(e=this.slen)?this.parameterAsString(2):null;this.chk||(c=null==d?this.$data:this.viewer.getData(d),c=null==c?"no data":J.util.Escape.encapsulateData(c[0],c[1],c[3].intValue()));break;case 1073742152:f=null;2==(e=this.slen)?this.chk||(f=this.viewer.getSpaceGroupInfo(null)):(d=this.parameterAsString(2),this.chk||(f=this.viewer.getSpaceGroupInfo(JU.PT.rep(d,"''",'"'))));null!=f&&(c=""+f.get("spaceGroupInfo")+f.get("symmetryInfo"));break;
case 1048583:e=3;c=this.eval.setObjectProperty();break;case 1679429641:this.chk||(c=this.viewer.getBoundBoxCommand(!0));break;case 12289:this.chk||(c="center "+J.util.Escape.eP(this.viewer.getRotationCenter()));break;case 135176:this.chk||(c=this.getShapeProperty(22,"command"));break;case 1229984263:this.chk||this.viewer.clearConsole();if(2==this.slen){this.chk||(c=this.viewer.getCurrentFileAsString());null==c&&(c="<unavailable>");break}e=3;b=this.parameterAsString(2);this.chk||(c=this.viewer.getFileAsString(b,
!0));break;case 4115:c=1048579==this.tokAt(2)&&0<(e=3)?this.viewer.getModelFileInfoAll():this.viewer.getModelFileInfo();break;case 1610616855:f=2==(e=this.slen)?2147483647:this.intParameter(2);1>f&&this.invArg();this.chk||(this.viewer.clearConsole(),0==this.eval.scriptLevel&&this.viewer.removeCommand(),c=this.viewer.getSetHistory(f));break;case 135180:this.chk||(c=this.getShapeProperty(24,"jvxlDataXml"));break;case 1183762:this.eval.optParameterAsString(2).equalsIgnoreCase("list")?(c=this.viewer.getMoInfo(-1),
e=3):(f=2==(e=this.slen)?-2147483648:this.intParameter(2),this.chk||(c=this.getMoJvxl(f)));break;case 1095766030:this.chk||(c=this.viewer.getModelInfoAsString());break;case 537006096:this.chk||(c=this.viewer.getMeasurementInfoAsString());break;case 1073741863:e=3;!this.chk&&this.slen==e&&(c=this.viewer.getOrientationText(this.tokAt(2),null));break;case 1073742132:d=this.tokAt(2),0==d?d=1073742132:e=3;case 1073742178:case 4130:this.chk||(c=this.viewer.getOrientationText(d,null));break;case 1073742077:e=
2;if(3<this.slen)break;switch(d=this.tokAt(2)){case 1073742178:case 1073742132:case 4130:case 0:this.chk||(c=this.viewer.getOrientationText(d,null));break;default:d=this.eval.optParameterAsString(2),c=this.viewer.getOrientationText(1073742035,d)}e=this.slen;break;case 1073742088:this.chk||(c=this.viewer.getPDBHeader());break;case 1073742102:this.pointGroup();return;case 1089470478:this.chk||(c=this.viewer.getSymmetryInfoAsString());break;case 1073742176:this.chk||(c="transform:\n"+this.viewer.getTransformText());
break;case 4168:c="zoom "+(this.viewer.getZoomEnabled()?""+this.viewer.getZoomSetting():"off");break;case 1611272202:c=this.viewer.getShowFrank()?"frank ON":"frank OFF";break;case 1666189314:a="solventProbeRadius";break;case 1073741864:case 1087373316:case 1087373320:case 1073742120:case 1114638363:case 1087373318:case 1141899265:case 1073741982:c=this.viewer.getChimeInfo(d);break;case 537022465:case 1610612738:case 1716520985:case 20482:case 1613758488:b="?";break;case 1073742031:f=2==(e=this.slen)?
null:this.parameterAsString(2);this.chk||(c=this.viewer.getBindingInfo(f));break;case 1073742015:this.chk||(b=this.viewer.getMenu(""));break;case 1073741824:a.equalsIgnoreCase("fileHeader")&&(this.chk||(c=this.viewer.getPDBHeader()))}this.checkLength(e);this.chk||(null!=c?this.showString(c):null!=b?this.showString(a+" = "+b):null!=a&&(0<=a.indexOf(" ")?this.showString(a):this.showString(a+" = "+this.getParameterEscaped(a))))}});k(c$,"showString",function(b){this.eval.showString(b)},"~S");k(c$,"checkLength",
function(b){this.eval.checkLength(b)},"~N");k(c$,"getIsosurfaceJvxl",function(b,a){return this.chk?"":this.getShapeProperty(a,b?"jvxlMeshX":"jvxlDataXml")},"~B,~N");k(c$,"getMoJvxl",function(b){this.sm.loadShape(27);var a=this.viewer.getCurrentModelIndex();0>a&&this.eval.errorStr(30,"MO isosurfaces");var c=this.viewer.getModelAuxiliaryInfoValue(a,"moData");null==c&&this.error(27);var d=this.getShapeProperty(27,"moNumber");(null==d||0==d.intValue())&&this.setShapeProperty(27,"init",Integer.$valueOf(a));
this.setShapeProperty(27,"moData",c);return this.getShapePropertyIndex(27,"showMO",b)},"~N");k(c$,"getParameterEscaped",function(b){var a=this.eval.getContextVariableAsVariable(b);return null==a?""+this.viewer.getParameterEscaped(b):a.escape()},"~S");k(c$,"getContext",function(b){for(var a=new JU.SB,c=this.eval.thisContext;null!=c;)b?null!=c.contextVariables&&(a.append(this.getScriptID(c)),a.append(J.viewer.StateManager.getVariableList(c.contextVariables,80,!0,!1))):a.append(J.script.ScriptEvaluator.getErrorLineMessage(c.functionName,
c.scriptFileName,this.eval.getLinenumber(c),c.pc,J.script.ScriptEvaluator.statementAsString(this.viewer,c.statement,-9999,this.eval.debugHigh))),c=c.parentContext;b?null!=this.eval.contextVariables&&(a.append(this.getScriptID(null)),a.append(J.viewer.StateManager.getVariableList(this.eval.contextVariables,80,!0,!1))):a.append(this.eval.getErrorLineMessage2());return a.toString()},"~B");k(c$,"getScriptID",function(b){return"\n# "+(null==b?this.eval.functionName:"function "+b.functionName)+" (file "+
(null==b?this.eval.scriptFileName:b.scriptFileName)+(null==b?"":" context "+b.id)+")\n"},"J.script.ScriptContext");k(c$,"getShapePropertyIndex",function(b,a,c){return this.sm.getShapePropertyIndex(b,a,c)},"~N,~S,~N");k(c$,"tokenAt",function(b,a){return b<a.length?a[b]:null},"~N,~A");c$.tokAtArray=k(c$,"tokAtArray",function(b,a){return b<a.length&&null!=a[b]?a[b].tok:0},"~N,~A");k(c$,"assign",function(){var b=this.tokAt(1),a=this.atomExpressionAt(2).nextSetBit(0),c=-1,d=null;if(!(0>a)){4106==b?c=this.atomExpressionAt(++this.eval.iToken).nextSetBit(0):
d=this.parameterAsString(++this.eval.iToken);var e=++this.eval.iToken<this.slen?this.centerParameter(this.eval.iToken):null;if(!this.chk)switch(b){case 1141899265:this.eval.clearDefinedVariableAtomSets();this.assignAtom(a,e,d);break;case 1678770178:this.assignBond(a,(d+"p").charAt(0));break;case 4106:this.assignConnect(a,c)}}});k(c$,"assignAtom",function(b,a,c){c.equals("X")&&this.viewer.setRotateBondIndex(-1);var d=this.viewer.modelSet;if(d.atoms[b].modelIndex==d.modelCount-1){this.viewer.clearModelDependentObjects();
var e=d.getAtomCount();if(null==a)this.viewer.statusManager.modifySend(b,d.atoms[b].modelIndex,1,this.eval.fullCommand),d.assignAtom(b,c,!0),JU.PT.isOneOf(c,";Mi;Pl;X;")||d.setAtomNamesAndNumbers(b,-e,null),this.viewer.statusManager.modifySend(b,d.atoms[b].modelIndex,-1,"OK"),this.viewer.refresh(3,"assignAtom");else{var f=d.atoms[b],g=J.util.BSUtil.newAndSetBit(b);a=[a];var h=new JU.List;h.addLast(f);f=f.modelIndex;this.viewer.statusManager.modifySend(b,f,3,this.eval.fullCommand);try{g=this.viewer.addHydrogensInline(g,
h,a),b=g.nextSetBit(0),d.assignAtom(b,c,!1)}catch(j){if(!S(j,Exception))throw j;}d.setAtomNamesAndNumbers(b,-e,null);this.viewer.statusManager.modifySend(b,f,-3,"OK")}}},"~N,JU.P3,~S");k(c$,"assignBond",function(b,a){var c=-1;try{var d=this.viewer.modelSet,c=this.viewer.getAtomModelIndex(d.bonds[b].getAtomIndex1());this.viewer.statusManager.modifySend(b,c,2,this.eval.fullCommand);var e=d.setBondOrder(b,a);null==e||"0"==a?this.viewer.refresh(3,"setBondOrder"):this.viewer.addHydrogens(e,!1,!0);this.viewer.statusManager.modifySend(b,
c,-2,""+a)}catch(f){if(S(f,Exception))J.util.Logger.error("assignBond failed"),this.viewer.statusManager.modifySend(b,c,-2,"ERROR "+f);else throw f;}},"~N,~S");k(c$,"assignConnect",function(b,a){this.viewer.clearModelDependentObjects();var c=this.viewer.modelSet,d=JU.AU.newFloat2(1);d[0]=[b,a];var e=c.atoms[b].modelIndex;this.viewer.statusManager.modifySend(b,e,2,this.eval.fullCommand);c.connect(d);c.assignAtom(b,".",!0);c.assignAtom(a,".",!0);this.viewer.statusManager.modifySend(b,e,-2,"OK");this.viewer.refresh(3,
"assignConnect")},"~N,~N");k(c$,"calculate",function(){var b=!1,a=!1,c=null,d=null,e=-2147483648;if(2<=(this.eval.iToken=this.eval.slen))switch(this.eval.clearDefinedVariableAtomSets(),this.getToken(1).tok){case 1073741824:this.checkLength(2);break;case 1632634891:this.checkLength(2);if(this.chk)return;e=this.viewer.calculateFormalCharges(null);this.showString(J.i18n.GT.i(J.i18n.GT._("{0} charges modified"),e));return;case 1076887572:this.checkLength(2);this.chk||this.viewer.assignAromaticBonds();
return;case 1612189718:2!=this.eval.slen&&(c=(a=1641025539==this.tokAt(++this.eval.iToken))?this.viewer.getSelectedAtoms():this.atomExpressionAt(this.eval.iToken),!a&&1641025539!=this.tokAt(++this.eval.iToken)&&(d=this.atomExpressionAt(this.eval.iToken)));if(this.chk)return;e=this.viewer.autoHbond(c,d,!1);-2147483648!=e&&this.eval.scriptStatusOrBuffer(J.i18n.GT.i(J.i18n.GT._("{0} hydrogen bonds"),Math.abs(e)));return;case 1613758476:c=2==this.slen?null:this.atomExpressionAt(2);this.eval.checkLast(this.eval.iToken);
this.chk||this.viewer.addHydrogens(c,!1,!1);return;case 1112541196:this.eval.iToken=1;c=2==this.slen?null:this.atomExpressionAt(2);this.eval.checkLast(this.eval.iToken);this.chk||this.viewer.calculatePartialCharges(c);return;case 1073742102:this.pointGroup();return;case 1112539150:this.checkLength(2);this.chk||(this.viewer.calculateStraightness(),this.viewer.addStateScript("set quaternionFrame '"+this.viewer.getQuaternionFrame()+"'; calculate straightness",!1,!0));return;case 1641025539:c=4>this.slen?
null:this.atomExpressionAt(2);switch(this.tokAt(++this.eval.iToken)){case 1052714:break;case 1073741915:a=!0;break;case 0:a=this.viewer.getBoolean(603979826);break;default:this.invArg()}this.chk||this.showString(this.viewer.calculateStructures(c,a,!0));return;case 1708058:c=this.eval.iToken+1<this.slen?this.atomExpressionAt(++this.eval.iToken):null;d=this.eval.iToken+1<this.slen?this.atomExpressionAt(++this.eval.iToken):null;this.checkLength(++this.eval.iToken);this.chk||(e=this.viewer.calculateStruts(c,
d),0<e&&(this.setShapeProperty(1,"type",Integer.$valueOf(32768)),this.eval.setShapePropertyBs(1,"color",Integer.$valueOf(16777215),null),this.eval.setShapeTranslucency(1,"","translucent",0.5,null),this.setShapeProperty(1,"type",Integer.$valueOf(1023))),this.showString(J.i18n.GT.i(J.i18n.GT._("{0} struts mp.added"),e)));return;case 3145756:b=!0;case 1112539151:a=!1;switch(this.tokAt(2)){case 135266325:this.eval.iToken++;break;case 0:a=!b;break;case 1073741952:a=!0;this.eval.iToken++;break;default:a=
!0}c=this.eval.iToken+1<this.slen?this.atomExpressionAt(++this.eval.iToken):this.viewer.getSelectedAtoms();this.checkLength(++this.eval.iToken);this.chk||this.viewer.calculateSurface(c,a?3.4028235E38:-1);return}this.eval.errorStr2(53,"CALCULATE","aromatic? hbonds? hydrogen? formalCharge? partialCharge? pointgroup? straightness? structure? struts? surfaceDistance FROM? surfaceDistance WITHIN?")});k(c$,"pointGroup",function(){switch(this.tokAt(0)){case 4102:this.chk||this.showString(this.viewer.calculatePointGroup());
return;case 4148:this.chk||this.showString(this.viewer.getPointGroupAsString(!1,null,0,0));return}var b=2,a=1073742138==this.tokAt(b)?"":this.eval.optParameterAsString(b);a.equals("chemicalShift")&&(a="cs");var c=1,d=0;0<a.length&&this.isFloatParameter(++b)&&(d=this.intParameter(b++));1073742138==this.tokAt(b)&&(c=this.floatParameter(++b));this.chk||this.eval.runScript(this.viewer.getPointGroupAsString(!0,a,d,c))});k(c$,"mapProperty",function(){for(var b,a,c,d,e,f=0,g=0,h=0;;){if(1114638363==this.tokAt(1))b=
this.viewer.getSelectedAtoms(),a=this.atomExpressionAt(2),c=d="selected";else{b=this.atomExpressionAt(1);if(1048584!=this.tokAt(++this.eval.iToken)||!J.script.T.tokAttr(f=this.tokAt(++this.eval.iToken),1078984704))break;c=this.parameterAsString(this.eval.iToken);a=this.atomExpressionAt(++this.eval.iToken);if(1048584!=this.tokAt(++this.eval.iToken)||!J.script.T.tokAttr(g=this.tokAt(++this.eval.iToken),2048))break;d=this.parameterAsString(this.eval.iToken)}e=J.script.T.tokAttr(h=this.tokAt(this.eval.iToken+
1),1078984704)?this.parameterAsString(++this.eval.iToken):J.script.T.nameOf(h=1095763969);this.eval.checkLast(this.eval.iToken);if(this.chk)return;var j=null;this.showString("mapping "+c.toUpperCase()+" for "+b.cardinality()+" atoms to "+d.toUpperCase()+" for "+a.cardinality()+" atoms using "+e.toUpperCase());if(J.script.T.tokAttrOr(f,1095761920,1112539136)&&J.script.T.tokAttrOr(g,1095761920,1112539136)&&J.script.T.tokAttrOr(h,1095761920,1112539136)){var p=this.eval.getBitsetPropertyFloat(b,f|224,
NaN,NaN),r=this.eval.getBitsetPropertyFloat(b,h|224,NaN,NaN),f=this.eval.getBitsetPropertyFloat(a,h|224,NaN,NaN),m=1716520985==g,n=I(m?this.viewer.getAtomCount():f.length,0),j=new JU.BS;if(p.length==r.length){for(var k=new java.util.Hashtable,h=0;h<p.length;h++)k.put(Float.$valueOf(r[h]),Float.$valueOf(p[h]));p=-1;for(h=r=0;h<f.length;h++){var p=a.nextSetBit(p+1),q=k.get(Float.$valueOf(f[h]));null!=q&&(j.set(p),n[m?p:r]=q.floatValue(),r++)}m?this.viewer.setData(d,[d,n,j,Integer.$valueOf(0),Boolean.TRUE],
this.viewer.getAtomCount(),0,0,2147483647,0):this.viewer.setAtomProperty(j,g,0,0,null,n,null)}}if(null==j){c=this.getBitsetIdent(b,"{"+e+"=%["+e+"]}."+d+" = %["+c+"]",null,!1,2147483647,!1);b=new JU.SB;for(h=0;h<c.length;h++)0>c[h].indexOf("null")&&b.append(c[h]).appendC("\n");J.util.Logger.debugging&&J.util.Logger.debug(b.toString());c=J.util.BSUtil.copy(this.viewer.getSelectionSubset());this.viewer.setSelectionSubset(a);try{this.eval.runScript(b.toString())}catch(y){if(S(y,Exception))a=y,this.viewer.setSelectionSubset(c),
this.eval.errorStr(-1,"Error: "+a.getMessage());else if(S(y,Error))a=y,this.viewer.setSelectionSubset(c),this.eval.errorStr(-1,"Error: "+a.toString());else throw y;}this.viewer.setSelectionSubset(c)}this.showString("DONE");return}this.invArg()});k(c$,"minimize",function(){for(var b=null,a=2147483647,c=0,d=!1,e=!1,f=null,g=!1,h=this.viewer.getMinimizer(!1),j=1;j<this.slen;j++)switch(this.getToken(j).tok){case 1073741828:d=!0;continue;case 1073741874:case 1073742162:this.checkLength(2);if(this.chk||
null==h)return;h.setProperty(this.parameterAsString(j),null);return;case 1073741882:this.checkLength(2);if(this.chk||null==h)return;h.setProperty("clear",null);return;case 1073741894:1!=j&&this.invArg();a=b=0;c=Y(5,0);if(1073741882==this.tokAt(++j))this.checkLength(3);else{for(;4>b&&!this.isFloatParameter(j);)c[++b]=this.atomExpressionAt(j).nextSetBit(0),j=this.eval.iToken+1;c[0]=b;1==b&&this.invArg();a=this.floatParameter(this.eval.checkLast(j))}this.chk||this.viewer.getMinimizer(!0).setProperty("constraint",
[c,Y(b,0),Float.$valueOf(a)]);return;case 1073741905:c=this.floatParameter(++j);continue;case 1073741934:a=0;continue;case 1060869:1!=j&&this.invArg();f=this.atomExpressionAt(++j);0>f.nextSetBit(0)&&(f=null);j=this.eval.iToken;this.chk||this.viewer.getMinimizer(!0).setProperty("fixed",f);if(j+1==this.slen)return;continue;case 10:case 1048577:g=!0;case 135280132:135280132==this.eval.theTok&&j++;b=this.atomExpressionAt(j);j=this.eval.iToken;1073742072==this.tokAt(j+1)&&(j++,g=!0);continue;case 1073742148:e=
!0;break;case 266298:a=this.intParameter(++j);continue;default:this.invArg()}this.chk||this.viewer.minimize(a,c,b,f,0,d,g,e,!1)});k(c$,"modulation",function(){var b=null,a=!0,c=!1,d=null;switch(this.getToken(1).tok){case 1048588:a=!1;case 0:case 1048589:break;case 10:case 1048577:d=this.atomExpressionAt(1);switch(this.tokAt(this.eval.iToken+1)){case 1048588:a=!1;case 1048589:this.eval.iToken++}this.eval.checkLast(this.eval.iToken);break;case 1048586:case 8:b=this.eval.getPoint3f(1,!1);c=1048589==
this.tokAt(this.eval.iToken+1);break;case 3:b=this.floatParameter(1);b=JU.P3.new3(b,b,b);break;case 2:c=this.intParameter(1);b=JU.P3.new3(c,c,c);c=!0;break;case 1073742138:a=this.floatParameter(2);this.chk||this.viewer.setFloatProperty("modulationScale",a);return;default:this.invArg()}this.chk||this.viewer.setModulation(d,a,b,c)});k(c$,"setContactBitSets",function(b,a,c,d,e,f){var g,h;null==a?(a=J.util.BSUtil.setAll(this.viewer.getAtomCount()),J.util.BSUtil.andNot(a,this.viewer.getDeletedAtoms()),
a.andNot(b),g=!1):(h=J.util.BSUtil.copy(b),h.or(a),h=this.viewer.getModelBitSet(h,!1).cardinality(),g=1<h,f&&(1<h&&!this.eval.tQuiet)&&this.showString(J.i18n.GT._("Note: More than one model is involved in this contact!")));if(!b.equals(a)){if(f=!c||b.cardinality()<a.cardinality())h=this.viewer.getAtomsWithinRadius(d,b,g,Float.isNaN(d)?e:null),a.and(h);c&&(h=this.viewer.getAtomsWithinRadius(d,a,g,Float.isNaN(d)?e:null),b.and(h),f||(h=this.viewer.getAtomsWithinRadius(d,b,g,Float.isNaN(d)?e:null),a.and(h)),
h=J.util.BSUtil.copy(a),h.and(b),h.equals(b)?a.andNot(b):h.equals(a)&&b.andNot(a))}return a},"JU.BS,JU.BS,~B,~N,J.atomdata.RadiusData,~B");k(c$,"compare",function(){var b=!1,a=!1,c=!1,d=!1,e=!1,f=null,g=null,h=null,j=null,p=null,r=null;this.eval.iToken=0;var m=this.isFloatParameter(1)?this.floatParameter(++this.eval.iToken):NaN,n=this.atomExpressionAt(++this.eval.iToken),k=null,q=null;this.eval.isArrayParameter(++this.eval.iToken)?k=this.eval.getPointArray(this.eval.iToken,-1):1141899265!=this.tokAt(this.eval.iToken)&&
(q=this.atomExpressionAt(this.eval.iToken));var y=null,w=!1,s=null,v=J.util.BSUtil.copy(n);null!=q&&v.or(q);for(var v=d=null==k&&null!=q&&v.equals(n),u=this.eval.iToken+1;u<this.slen;++u)switch(this.getToken(u).tok){case 4115:v=!0;break;case 135267336:if(w=!0,4!=this.tokAt(u+1)){s="*";break}case 135267335:s=this.stringParameter(++u);break;case 1678770178:a=e=!0;s=this.parameterAsString(++u);s.equalsIgnoreCase("SMILES")&&(w=!0,s="*");break;case 3:case 2:m=Math.abs(this.floatParameter(u));break;case 269484080:break;
case 3158024:y=this.atomExpressionAt(++u);u=this.eval.iToken;break;case 10:case 1048577:null!=r&&this.invArg();var h=this.atomExpressionAt(this.eval.iToken),G=d?0:this.tokAt(this.eval.iToken+1),j=null==k&&this.eval.isArrayParameter(this.eval.iToken+1)?null:10==G||1048577==G?this.atomExpressionAt(++this.eval.iToken):J.util.BSUtil.copy(h);null!=y&&(h.and(y),null!=j&&j.and(y));null==j?k=this.eval.getPointArray(++this.eval.iToken,-1):j.and(q);null==p&&(p=new JU.List);p.addLast([h,j]);u=this.eval.iToken;
break;case 7:null!=p&&this.invArg();b=!0;f=this.getQuaternionArray(this.eval.theToken.getList(),1073742001);this.getToken(++u);g=this.getQuaternionArray(this.eval.theToken.getList(),1073742001);null==r&&(r=new JU.List);r.addLast([f,g]);break;case 1073742077:b=!0;break;case 135266320:case 1141899265:b=!1;break;case 528432:a=!0;break;case 4160:c=!0;break;default:this.invArg()}if(!this.chk){v&&(m=0);Float.isNaN(m)||0>m?m=1:!a&&!c&&(a=c=!0);d=0!=m;G=!b&&null==s||null!=k;null==p&&null==r&&(null==y?(h=
G?this.viewer.getAtomBitSet("spine"):new JU.BS,0>h.nextSetBit(0)?(h=n,j=q):(j=J.util.BSUtil.copy(h),h.and(n),j.and(q))):(h=J.util.BSUtil.copy(n),j=J.util.BSUtil.copy(q),h.and(y),j.and(y),h.and(n),j.and(q)),p=new JU.List,p.addLast([h,j]));if(v){n=this.viewer.getModelBitSet(n,!1);y=Array(n.cardinality());u=0;for(j=n.nextSetBit(0);0<=j;j=n.nextSetBit(j+1),u++)y[u]=this.viewer.getModelUndeletedAtomsBitSet(j)}else y=[n];for(j=0;j<y.length;j++){for(var n=y[j],B=I(2,0),x=null,H=new JU.List,E=null,K=v?new JU.List:
p,u=0;u<p.size();++u){var C=p.get(u);v&&K.addLast(C=[J.util.BSUtil.copy(C[0]),C[1]]);C[0].and(n)}var z=null,L=null;if(G){null!=k&&(K.clear(),K.addLast([h,k]));try{E=this.viewer.getCenterAndPoints(K,!0)}catch(M){if(S(M,Exception))this.invArg();else throw M;}x=J.util.Measure.calculateQuaternionRotation(E,B,!0);u=Float.isNaN(B[1])?NaN:Math.round(100*B[0])/100;B=Float.isNaN(B[1])?NaN:Math.round(100*B[1])/100;this.showString("RMSD "+u+" --\x3e "+B+" Angstroms")}else if(b){if(null==r)for(u=0;u<K.size();u++){C=
K.get(u);f=this.viewer.getAtomGroupQuaternions(C[0],2147483647);g=this.viewer.getAtomGroupQuaternions(C[1],2147483647);for(x=0;x<f.length&&x<g.length;x++)H.addLast(g[x].div(f[x]))}else for(x=0;x<f.length&&x<g.length;x++)H.addLast(g[x].div(f[x]));B[0]=0;f=H.toArray(Array(H.size()));x=J.util.Quaternion.sphereMean(f,B,1E-4);this.showString("RMSD = "+B[0]+" degrees")}else{u=new JU.M4;z=new JU.P3;if("*".equals(s)&&null!=n)try{s=this.viewer.getSmiles(n)}catch(T){if(S(T,Exception))this.eval.evalError(T.getMessage(),
null);else throw T;}if(e){var R;if(null==n||null==q||null==(R=this.getFlexFitList(n,q,s,!w)))break;this.viewer.setDihedrals(R,null,1)}B=this.getSmilesCorrelation(n,q,s,null,null,u,null,!w,!1,null,z,!1,!1);Float.isNaN(B)&&this.invArg();c&&(L=new JU.V3,u.getTranslation(L));a&&(x=new JU.M3,u.getRotationScale(x),x=J.util.Quaternion.newM(x));this.showString("RMSD = "+B+" Angstroms")}null!=E&&(z=E[0][0]);null==z&&(E=this.viewer.getCenterAndPoints(K,!0),z=E[0][0]);K=new JU.P3;B=NaN;c&&(null==L&&(L=JU.V3.newVsub(E[1][0],
z)),B=1E10);a&&(null==x&&this.eval.evalError("option not implemented",null),K.add2(z,x.getNormal()),B=x.getTheta(),0==B&&c&&(0.01<L.length()?B=1E10:a=c=d=!1));if(!Float.isNaN(B)&&!Float.isNaN(K.x)&&(E=null,a&&(c&&0!=m)&&(E=this.viewer.getAtomPointVector(n),u=J.script.ScriptMathProcessor.getMatrix4f(x.getMatrix(),L),E=J.util.Measure.transformPoints(E,u,z)),this.eval.useThreads()||(d=!1),this.viewer.rotateAboutPointsInternal(this.eval,z,K,B/m,B,d,n,L,E,null)&&d&&this.eval.isJS))throw new J.script.ScriptInterruption(this.eval,
"compare",1);}}});k(c$,"configuration",function(){var b;if(1==this.slen)b=this.viewer.setConformation(),this.viewer.addStateScriptRet("select",null,this.viewer.getSelectedAtoms(),null,"configuration",!0,!1);else{var a=this.intParameter(this.eval.checkLast(1));if(this.chk)return;b=this.viewer.getConformation(this.viewer.getCurrentModelIndex(),a-1,!0);this.viewer.addStateScript("configuration "+a+";",!0,!1)}this.chk||(this.setShapeProperty(1,"type",Integer.$valueOf(30720)),this.eval.setShapeSizeBs(1,
0,b),this.viewer.autoHbond(b,b,!0),this.viewer.select(b,!1,0,this.eval.tQuiet))});k(c$,"measure",function(){var b=this.eval,a=null,c=0,d=null;if(2==this.slen)switch(this.tokAt(1)){case 1048588:this.setShapeProperty(6,"hideAll",Boolean.TRUE);return;case 12291:this.chk||this.viewer.clearAllMeasurements();return}this.viewer.loadShape(6);switch(this.tokAt(1)){case 135267335:var e=this.stringParameter(3==this.slen?2:4);if(this.chk)return;var f=this.viewer.modelSet.atoms,a=this.viewer.getAtomCount(),c=
null;try{c=this.viewer.getSmilesMatcher().getCorrelationMaps(e,f,a,this.viewer.getSelectedAtoms(),!0,!1)}catch(g){if(S(g,Exception))b.evalError(g.getMessage(),null);else throw g;}if(null==c)return;this.setShapeProperty(6,"maps",c);return}switch(this.slen){case 2:switch(this.getToken(1).tok){case 0:case 1048589:this.viewer.loadShape(6);this.setShapeProperty(6,"hideAll",Boolean.FALSE);return;case 1073742001:this.chk||b.showStringPrint(this.viewer.getMeasurementInfoAsString(),!1);return;case 4:this.setShapeProperty(6,
"setFormats",this.stringParameter(1));return}b.errorStr(24,"ON, OFF, DELETE");break;case 3:switch(this.getToken(1).tok){case 12291:if(1048579==this.getToken(2).tok)this.chk||this.viewer.clearAllMeasurements();else{var h=this.intParameter(2)-1;this.chk||this.viewer.deleteMeasurement(h)}return}}for(var j=0,p=0,r=-1,m=-1,k=-1,Ra=Y(5,0),q=[3.4028235E38,3.4028235E38],y=!1,w=!1,s=!1,v=!0,u=null,G=null,e=269484114,B=f=null,x=new JU.List,H=new JU.BS,E=null,K=null,I=0,z=0,h=1;h<this.slen;++h)switch(this.getToken(h).tok){case 1074790550:1!=
h&&this.invArg();a=b.optParameterAsString(++h);continue;case 1073741824:b.errorStr(24,"ALL, ALLCONNECTED, DELETE");break;default:this.error(15);break;case 269484144:135266310!=this.tokAt(h+1)&&this.invArg();h++;s=!0;break;case 135266310:case 1073741834:case 1048579:w=1073741834==b.theTok;m=-1;y=!0;w&&s&&this.invArg();break;case 1766856708:c=J.util.C.getColix(b.getArgbParam(++h));h=b.iToken;break;case 1073742066:b.isPoint3f(++h)?(d=this.getPoint3f(h,!1),d=[1,d.x,d.y,d.z,0,0,0]):d=b.floatParameterSet(h,
7,7);h=b.iToken;break;case 1666189314:case 1073741916:z=M((1666189314==b.theTok?2E3:1E3)*this.floatParameter(++h));null!=a&&0>=z&&(z=-1);break;case 3:null!=u&&this.invArg();v=y=!0;k=(k+1)%2;q[k]=this.floatParameter(h);break;case 12291:269484114!=e&&this.invArg();e=12291;break;case 4114:var L=this.floatParameter(++h),R=this.parameterAsString(++h),T=this.parameterAsString(++h);this.chk||(B=this.viewer.getFont3D(R,T,L));break;case 2:L=this.intParameter(h);if(y)v=!0,k=(k+1)%2,q[k]=L;else{m=this.viewer.getAtomIndexFromAtomNumber(L);
if(!this.chk&&0>m)return;null!=E&&this.invArg();4<(Ra[0]=++j)&&b.bad();Ra[j]=m}break;case 1095761935:r=this.intParameter(++h);break;case 1048588:269484114!=e&&this.invArg();e=1048588;break;case 1048589:269484114!=e&&this.invArg();e=1048589;break;case 1073742114:v=y=!0;m=-1;break;case 1073741989:case 1073741990:G=Boolean.$valueOf(1073741989==b.theTok);y=!0;s=1073741990==b.theTok;break;case 1649412120:0<=k&&this.invArg();u=b.encodeRadiusParameter(h,!1,!0);u.values=q;h=b.iToken;y=s=!0;G=Boolean.$valueOf(!1);
1==I&&(I++,j++,L=J.util.BSUtil.copy(H),J.util.BSUtil.invertInPlace(L,this.viewer.getAtomCount()),L.and(this.viewer.getAtomsWithinRadius(5,H,!1,null)),x.addLast(L));break;case 10:case 1048577:case 1048586:case 8:case 1048583:(10==b.theTok||1048577==b.theTok)&&I++;0<=m&&this.invArg();b.expressionResult=Boolean.FALSE;E=this.centerParameter(h);if(C(b.expressionResult,JU.BS)&&(E=H=b.expressionResult,!this.chk&&0==H.length()))return;C(E,JU.P3)&&(j=new J.util.Point3fi,j.setT(E),j.modelIndex=r,E=j);4<(j=
++p)&&b.bad();h=b.iToken;x.addLast(E);break;case 4:f=this.stringParameter(h);break;case 1073742164:K=b.checkTicks(h,!1,!0,!0),h=b.iToken,e=1060866}(null!=u&&(0<=k||2!=j)||2>j&&null==a&&(null==K||1==j))&&b.bad();null!=f&&0!=f.indexOf(j+":")&&(f=j+":"+f);v&&q[1]<q[0]&&(q[1]=q[0],q[0]=3.4028235E38==q[1]?3.4028235E38:-200);if(!this.chk)if(null!=E||null!=K)null==u&&(u=new J.atomdata.RadiusData(q,0,null,null)),null==E&&(K.id="default"),null!=E&&(null!=f&&269484114==e)&&(e=1060866),b=null,null!=B&&(b=J.api.Interface.getOptionInterface("modelset.Text").newLabel(this.viewer.getGraphicsData(),
B,"",c,0,0,0,null)),null!=b&&(b.pymolOffset=d),this.setShapeProperty(6,"measure",this.newMeasurementData(a,x).set(e,null,u,f,null,K,w,s,G,y,z,c,b));else switch(b=null==a?Ra:a,e){case 12291:this.setShapeProperty(6,"delete",b);break;case 1048589:this.setShapeProperty(6,"show",b);break;case 1048588:this.setShapeProperty(6,"hide",b);break;default:this.setShapeProperty(6,null==f?"toggle":"toggleOn",b),null!=f&&this.setShapeProperty(6,"setFormats",f)}});k(c$,"getFlexFitList",function(b,a,c,d){var e=JU.AU.newInt2(2);
this.getSmilesCorrelation(b,a,c,null,null,null,null,d,!1,e,null,!1,!1);if(null==e[0])return null;b=this.viewer.getDihedralMap(e[0]);a=null==b?null:this.viewer.getDihedralMap(e[1]);if(null==a||a.length!=b.length)return null;e=I(b.length,3,0);c=this.viewer.modelSet.atoms;J.scriptext.ScriptExt.getTorsions(c,a,e,0);J.scriptext.ScriptExt.getTorsions(c,b,e,1);a=I(6*b.length,0);for(d=c=0;c<b.length;c++){var f=b[c];a[d++]=f[0];a[d++]=f[1];a[d++]=f[2];a[d++]=f[3];a[d++]=e[c][0];a[d++]=e[c][1]}return a},"JU.BS,JU.BS,~S,~B");
c$.getTorsions=k(c$,"getTorsions",function(b,a,c,d){for(var e=a.length;0<=--e;){var f=a[e],f=J.util.Measure.computeTorsion(b[f[0]],b[f[1]],b[f[2]],b[f[3]],!0);1==d&&(180<f-c[e][0]?f-=360:-180>=f-c[e][0]&&(f+=360));c[e][d]=f}},"~A,~A,~A,~N");k(c$,"getSmilesCorrelation",function(b,a,c,d,e,f,g,h,j,p,k,m,n){var C=null==p?0.1:3.4028235E38;try{null==d&&(d=new JU.List,e=new JU.List);var q=new JU.M4,y=new JU.P3,w=this.viewer.modelSet.atoms,s=this.viewer.getAtomCount(),v=this.viewer.getSmilesMatcher().getCorrelationMaps(c,
w,s,b,h,!0);null==v&&this.eval.evalError(this.viewer.getSmilesMatcher().getLastException(),null);if(0==v.length)return NaN;var u=v[0];for(b=0;b<u.length;b++)d.addLast(w[u[b]]);v=this.viewer.getSmilesMatcher().getCorrelationMaps(c,w,s,a,h,m);null==v&&this.eval.evalError(this.viewer.getSmilesMatcher().getLastException(),null);if(0==v.length)return NaN;J.util.Logger.info(v.length+" mappings found");if(n||!j){a=3.4028235E38;c=null;for(b=0;b<v.length;b++){e.clear();for(var G=0;G<v[b].length;G++)e.addLast(w[v[b][G]]);
var B=J.util.Measure.getTransformMatrix4(d,e,q,y,!1);J.util.Logger.info("getSmilesCorrelation stddev="+B);if(null!=g&&B<C){for(var x=new JU.BS,G=0;G<v[b].length;G++)x.set(v[b][G]);g.addLast(x)}B<a&&(c=v[b],null!=f&&f.setM4(q),null!=k&&k.setT(y),a=B)}null!=p&&(p[0]=u,p[1]=c);e.clear();for(b=0;b<c.length;b++)e.addLast(w[c[b]]);return a}for(b=0;b<v.length;b++)for(G=0;G<v[b].length;G++)e.addLast(w[v[b][G]])}catch(H){if(S(H,Exception))this.eval.evalError(H.getMessage(),null);else throw H;}return 0},"JU.BS,JU.BS,~S,JU.List,JU.List,JU.M4,JU.List,~B,~B,~A,JU.P3,~B,~B");
R(c$,"getSmilesMatches",function(b,a,c,d,e,f){if(this.chk)return f?new JU.BS:["({})"];if(0==b.length||b.equals("H"))try{return this.viewer.getSmilesOpt(c,0,0,b.equals("H"),!f,!1,!0,!0)}catch(g){if(S(g,Exception))this.eval.evalError(g.getMessage(),null);else throw g;}var h=!0,j;if(null==d){h=null==a;try{j=h?this.viewer.getSmilesMatcher().getSubstructureSetArray(b,this.viewer.modelSet.atoms,this.viewer.getAtomCount(),c,null,e,!1):this.viewer.getSmilesMatcher().find(b,a,e,!1)}catch(p){if(S(p,Exception))return this.eval.evalError(p.getMessage(),
null),null;throw p;}}else{j=new JU.List;b=this.getSmilesCorrelation(d,c,b,null,null,null,j,e,!1,null,null,!1,!1);if(Float.isNaN(b))return f?new JU.BS:[];this.showString("RMSD "+b+" Angstroms");j=j.toArray(Array(j.size()))}if(f){f=new JU.BS;for(b=0;b<j.length;b++)f.or(j[b]);if(h)return f;if(!e)return Integer.$valueOf(f.cardinality());h=Y(f.cardinality(),0);e=0;for(j=f.nextSetBit(0);0<=j;j=f.nextSetBit(j+1))h[e++]=j+1;return h}e=Array(j.length);for(b=0;b<j.length;b++)e[b]=h?J.util.Escape.eBS(j[b]):
J.util.Escape.eBond(j[b]);return e},"~S,~S,JU.BS,JU.BS,~B,~B");R(c$,"evaluate",function(b,a,c,d){switch(d){case 135266826:case 135266819:case 135266821:case 135266318:case 135266820:case 135266822:return this.evaluateMath(b,c,d);case 1276118017:case 1276117504:case 1276117507:case 1276117508:case 1276117511:case 1276383749:case 1276383249:return this.evaluateList(b,a.intValue,c);case 135266306:case 269484096:return this.evaluateArray(b,c,269484096==d);case 135266307:case 135270418:return this.evaluateQuaternion(b,
c,d);case 1276118529:return this.evaluateBin(b,c);case 1276117514:case 1276117515:return this.evaluateRowCol(b,c,d);case 1766856708:return this.evaluateColor(b,c);case 135270405:return this.evaluateCompare(b,c);case 135266310:return this.evaluateConnected(b,c);case 135267329:return this.evaluateCross(b,c);case 135270408:return this.evaluateData(b,c);case 1276118018:case 1276117505:if(269484241==a.tok)return this.evaluateDot(b,c,d,a.intValue);case 135266305:case 1746538509:return this.evaluateMeasure(b,
c,a.tok);case 1229984263:case 135271426:return this.evaluateLoad(b,c,d);case 1276118531:return this.evaluateFind(b,c);case 135368713:return this.evaluateUserFunction(b,a.value,c,a.intValue,269484241==a.tok);case 1288701959:case 1826248716:return this.evaluateLabel(b,a.intValue,c);case 1276121098:return this.evaluateGetProperty(b,c,269484241==a.tok);case 137363467:return this.evaluateHelix(b,c);case 135267841:case 135266319:case 135267842:return this.evaluatePlane(b,c,d);case 135287308:case 135271429:return this.evaluateScript(b,
c,d);case 1276117506:case 1276117510:case 1276117512:return this.evaluateString(b,a.intValue,c);case 135266320:return this.evaluatePoint(b,c);case 135304707:return this.evaluatePrompt(b,c);case 135267332:return this.evaluateRandom(b,c);case 1276118019:return this.evaluateReplace(b,c);case 135267335:case 135267336:case 1238369286:return this.evaluateSubstructure(b,c,d);case 135270423:return this.evaluateCache(b,c);case 1276121113:return this.evaluateModulation(b,c);case 1276117011:case 1276117012:return this.evaluateSort(b,
c,d);case 1297090050:return this.evaluateSymop(b,c,269484241==a.tok);case 1276117016:return this.evaluateTensor(b,c);case 135266325:return this.evaluateWithin(b,c);case 135402505:return this.evaluateContact(b,c);case 135270422:return this.evaluateWrite(b,c)}return!1},"J.script.ScriptMathProcessor,J.script.T,~A,~N");k(c$,"evaluateModulation",function(b,a){var c="D",d=NaN,e=null,f=-1;switch(a.length){case 0:break;case 1:f=0;break;case 2:c=J.script.SV.sValue(a[0]).toUpperCase();d=J.script.SV.fValue(a[1]);
break;default:return!1}0<=f&&(8==a[f].tok?e=a[f].value:d=J.script.SV.fValue(a[f]));null==e&&1E6>d&&(e=JU.P3.new3(d,d,d));d=J.script.SV.getBitSet(b.getX(),!1);return b.addXList(this.viewer.getModulationList(d,c,e))},"J.script.ScriptMathProcessor,~A");k(c$,"evaluateTensor",function(b,a){if(2<a.length)return!1;var c=J.script.SV.getBitSet(b.getX(),!1),d=0==a.length?null:J.script.SV.sValue(a[0]).toLowerCase(),e=this.viewer.getNMRCalculation();if("unique".equals(d))return b.addXBs(e.getUniqueTensorSet(c));
var f=2>a.length?null:J.script.SV.sValue(a[1]).toLowerCase();return b.addXList(e.getTensorInfo(d,f,c))},"J.script.ScriptMathProcessor,~A");k(c$,"evaluateCache",function(b,a){return 0<a.length?!1:b.addXMap(this.viewer.cacheList())},"J.script.ScriptMathProcessor,~A");k(c$,"evaluateCompare",function(b,a){if(2>a.length||5<a.length)return!1;var c,d=J.script.SV.sValue(a[a.length-1]),e=d.equalsIgnoreCase("stddev"),f=d.equalsIgnoreCase("ISOMER"),g=d.equalsIgnoreCase("BONDS"),h=!f&&a.length>(e?3:2),j=10==
a[0].tok?a[0].value:null,p=10==a[1].tok?a[1].value:null,k=null==j?J.script.SV.sValue(a[0]):"",m=null==p?J.script.SV.sValue(a[1]):"",n=new JU.M4;c=NaN;var C,q;if(h&&(null==j||null==p))return!1;if(g){if(4!=a.length)return!1;k=J.script.SV.sValue(a[2]);h=k.equalsIgnoreCase("SMILES");try{h&&(k=this.viewer.getSmiles(j))}catch(y){if(S(y,Exception))this.eval.evalError(y.getMessage(),null);else throw y;}var w=this.getFlexFitList(j,p,k,!h);return null==w?b.addXStr(""):b.addXAF(w)}try{if(f){if(3!=a.length)return!1;
if(null==j&&null==p)return b.addXStr(this.viewer.getSmilesMatcher().getRelationship(k,m).toUpperCase());var s=null==j?this.viewer.getSmilesMatcher().getMolecularFormula(k,!1):J.util.JmolMolecule.getMolecularFormula(this.viewer.getModelSet().atoms,j,!1),v=null==p?this.viewer.getSmilesMatcher().getMolecularFormula(m,!1):J.util.JmolMolecule.getMolecularFormula(this.viewer.getModelSet().atoms,p,!1);if(!s.equals(v))return b.addXStr("NONE");null!=j&&(k=this.getSmilesMatches("",null,j,null,!1,!0));var u;
u=null==p?0<this.viewer.getSmilesMatcher().areEqual(m,k):0<=this.getSmilesMatches(k,null,p,null,!1,!0).nextSetBit(0);if(!u){C=k+m;if(0<=C.indexOf("/")||0<=C.indexOf("\\")||0<=C.indexOf("@")){if(0<=k.indexOf("@")&&(null!=p||0<=m.indexOf("@")))if(k=this.viewer.getSmilesMatcher().reverseChirality(k),u=null==p?0<this.viewer.getSmilesMatcher().areEqual(k,m):0<=this.getSmilesMatches(k,null,p,null,!1,!0).nextSetBit(0))return b.addXStr("ENANTIOMERS");null==p?u=0<this.viewer.getSmilesMatcher().areEqual("/nostereo/"+
m,k):(w=this.getSmilesMatches("/nostereo/"+k,null,p,null,!1,!0),u=0<=w.nextSetBit(0));if(u)return b.addXStr("DIASTERIOMERS")}return b.addXStr("CONSTITUTIONAL ISOMERS")}if(null==j||null==p)return b.addXStr("IDENTICAL");c=this.getSmilesCorrelation(j,p,k,null,null,null,null,!1,!1,null,null,!1,!1);return b.addXStr(0.2>c?"IDENTICAL":"IDENTICAL or CONFORMATIONAL ISOMERS (RMSD="+c+")")}if(h){C=new JU.List;q=new JU.List;var d=J.script.SV.sValue(a[2]),G=d.equalsIgnoreCase("MAP"),h=d.equalsIgnoreCase("SMILES"),
B=G||d.equalsIgnoreCase("SMARTS");if(h||B)d=3<a.length?J.script.SV.sValue(a[3]):null;var x="H".equals(d)||"allH".equals(d)||"bestH".equals(d),H="all".equals(d)||"allH".equals(d),E="best".equals(d)||"bestH".equals(d);if(null==d||x||H||E)if(G||h)d="/noaromatic"+(H||E?"/":" nostereo/")+this.getSmilesMatches(x?"H":"",null,j,null,!1,!0);else return!1;else H=!0;c=this.getSmilesCorrelation(j,p,d,C,q,n,null,!h,G,null,null,!H&&!E,E);if(G){var K=C.size();if(0==K)return b.addXStr("");for(var I=ja(q.size()/K),
w=new JU.List,k=p=0;p<I;p++){var z=JU.AU.newInt2(K);w.addLast(z);for(m=0;m<K;m++,k++)z[m]=[C.get(m).index,q.get(k).index]}return!H?0<w.size()?b.addXAII(w.get(0)):b.addXStr(""):b.addXList(w)}}else C=this.eval.getPointVector(a[0],0),q=this.eval.getPointVector(a[1],0),null!=C&&null!=q&&(c=J.util.Measure.getTransformMatrix4(C,q,n,null,!1));return e||Float.isNaN(c)?b.addXFloat(c):b.addXM4(n)}catch(L){if(S(L,Exception))return this.eval.evalError(null==L.getMessage()?L.toString():L.getMessage(),null),!1;
throw L;}},"J.script.ScriptMathProcessor,~A");k(c$,"evaluateContact",function(b,a){if(1>a.length||3<a.length)return!1;var c=0,d=100;switch(a[0].tok){case 3:case 2:d=J.script.SV.fValue(a[c++]);break;case 10:break;default:return!1}if(c==a.length||!C(a[c].value,JU.BS))return!1;var e=J.util.BSUtil.copy(J.script.SV.bsSelectVar(a[c++]));if(this.chk)return b.addXBs(new JU.BS);c=c<a.length?J.util.BSUtil.copy(J.script.SV.bsSelectVar(a[c])):null;d=new J.atomdata.RadiusData(null,10<d?d/100:d,10<d?J.atomdata.RadiusData.EnumType.FACTOR:
J.atomdata.RadiusData.EnumType.OFFSET,J.constant.EnumVdw.AUTO);c=this.setContactBitSets(e,c,!0,NaN,d,!1);c.or(e);return b.addXBs(c)},"J.script.ScriptMathProcessor,~A");k(c$,"evaluateSort",function(b,a,c){if(1<a.length)return!1;if(1276117011==c){var d=0==a.length?0:a[0].asInt();return b.addXVar(b.getX().sortOrReverse(d))}c=b.getX();a=0==a.length?null:a[0];if(4==c.tok){var d=0,e=J.script.SV.sValue(c);if(null==a)return b.addXInt(0);a=J.script.SV.sValue(a);for(c=0;c<e.length;c++){c=e.indexOf(a,c);if(0>
c)break;d++}return b.addXInt(d)}var d=new JU.List,f=e=null,g=J.script.SV.getVariable(c.value).sortOrReverse(0).getList();if(null==g)return null==a?b.addXStr(""):b.addXInt(0);c=0;for(var h=g.size();c<=h;c++){var j=c==h?null:g.get(c);if(!(null!=a&&null!=j&&!J.script.SV.areEqual(j,a)))if(J.script.SV.areEqual(j,e))f.intValue++;else{if(null!=e){var p=new JU.List;p.addLast(e);p.addLast(f);d.addLast(J.script.SV.getVariableList(p))}f=J.script.SV.newI(1);e=j}}return null==a?b.addXVar(J.script.SV.getVariableList(d)):
d.isEmpty()?b.addXInt(0):b.addXVar(d.get(0).getList().get(1))},"J.script.ScriptMathProcessor,~A,~N");k(c$,"evaluateSymop",function(b,a,c){if(0==a.length)return!1;c=c?b.getX():null;if(null!=c&&10!=c.tok)return!1;c=null!=c?c.value:2<a.length&&10==a[1].tok?a[1].value:this.viewer.getAllAtoms();var d;switch(a[0].tok){case 4:d=J.script.SV.sValue(a[0]);break;case 12:d=a[0].escape();break;default:d=null}var e=null==d?a[0].asInt():0,f=1<a.length?b.ptValue(a[1],!0):null;if(2==a.length&&!Float.isNaN(f.x))return b.addXObj(this.viewer.getSymmetryInfo(c,
d,e,f,null,null,135266320));var g=(1==a.length?"":J.script.SV.sValue(a[a.length-1])).toLowerCase(),h=135176;1==a.length||g.equalsIgnoreCase("matrix")?h=12:g.equalsIgnoreCase("array")||g.equalsIgnoreCase("list")?h=1073742001:g.equalsIgnoreCase("description")?h=1826248716:g.equalsIgnoreCase("xyz")?h=1073741982:g.equalsIgnoreCase("translation")?h=1073742178:g.equalsIgnoreCase("axis")?h=1073741854:g.equalsIgnoreCase("plane")?h=135266319:g.equalsIgnoreCase("angle")?h=135266305:g.equalsIgnoreCase("axispoint")?
h=135266320:g.equalsIgnoreCase("center")&&(h=12289);return b.addXObj(this.viewer.getSymmetryInfo(c,d,e,f,null,g,h))},"J.script.ScriptMathProcessor,~A,~B");k(c$,"evaluateBin",function(b,a){if(3!=a.length)return!1;var c=b.getX(),d=13==c.tok;if(!d&&7!=c.tok)return b.addXVar(c);var e=J.script.SV.fValue(a[0]),f=J.script.SV.fValue(a[1]),g=J.script.SV.fValue(a[2]);if(d)c=c.value;else for(var h=c.getList(),c=I(h.size(),0),d=h.size();0<=--d;)c[d]=J.script.SV.fValue(h.get(d));for(var f=ja(Math.floor((f-e)/
g+0.01)),h=Y(f,0),j=c.length,d=0;d<j;d++){var p=ja(Math.floor((c[d]-e)/g));0>p?p=0:p>=f&&(p=f-1);h[p]++}return b.addXAI(h)},"J.script.ScriptMathProcessor,~A");k(c$,"evaluateHelix",function(b,a){if(1>a.length||5<a.length)return!1;var c=2<a.length?3:1,d=c>=a.length?"array":J.script.SV.sValue(a[c]),c=J.script.T.getTokFromName(d);if(2<a.length){var e=b.ptValue(a[0],!0),f=b.ptValue(a[1],!0);if(9!=a[2].tok)return!1;var g=J.util.Quaternion.newP4(a[2].value);switch(c){case 0:break;case 135266320:case 1073741854:case 1666189314:case 135266305:case 1746538509:return b.addXObj(J.util.Measure.computeHelicalAxis(null,
c,e,f,g));case 135266306:c=J.util.Measure.computeHelicalAxis(null,1073742001,e,f,g);if(null==c)break;return b.addXAS(c);default:return b.addXObj(J.util.Measure.computeHelicalAxis(d,135176,e,f,g))}}else switch(d=C(a[0].value,JU.BS)?a[0].value:this.eval.compareInt(1095761939,269484436,a[0].asInt()),c){case 135266320:return b.addXObj(this.viewer.getHelixData(d,135266320));case 1073741854:return b.addXObj(this.viewer.getHelixData(d,1073741854));case 1666189314:return b.addXObj(this.viewer.getHelixData(d,
1666189314));case 135266305:return b.addXFloat(this.viewer.getHelixData(d,135266305).floatValue());case 135176:case 1746538509:return b.addXObj(this.viewer.getHelixData(d,c));case 135266306:c=this.viewer.getHelixData(d,1073742001);if(null==c)break;return b.addXAS(c)}return!1},"J.script.ScriptMathProcessor,~A");k(c$,"evaluateDot",function(b,a,c,d){switch(a.length){case 1:if(1276117505==c)return!1;case 2:break;default:return!1}var e=b.getX(),f=a[0],g=7==f.tok?null:b.ptValue(f,!1),h=b.planeValue(f);
if(1276118018==c){var j=d&480,p=32==j||64==j,k=480==j;switch(e.tok){case 10:var m=J.script.SV.bsSelectVar(e),n=null;a=p&&2==a.length&&a[1].asBoolean();switch(f.tok){case 10:n=10==f.tok?J.script.SV.bsSelectVar(f):null;case 8:c=this.viewer.modelSet.atoms;if(a){k=NaN;f=2147483647;for(p=m.nextSetBit(0);0<=p;p=m.nextSetBit(p+1))if(a=null==n?c[p].distanceSquared(g):this.eval.getBitsetProperty(n,d,c[p],h,e.value,null,!1,e.index,!1).floatValue(),!(32==j?a>=k:a<=k))k=a,f=p;return b.addXBs(2147483647==f?new JU.BS:
J.util.BSUtil.newAndSetBit(f))}if(k){if(null==n){k=I(m.cardinality(),0);j=0;for(p=m.nextSetBit(0);0<=p;p=m.nextSetBit(p+1),j++)k[j]=c[p].distance(g);return b.addXAF(k)}d=I(m.cardinality(),n.cardinality(),0);j=0;for(p=m.nextSetBit(0);0<=p;p=m.nextSetBit(p+1),j++){e=0;for(g=n.nextSetBit(0);0<=g;g=n.nextSetBit(g+1),e++)d[j][e]=c[p].distance(c[g])}return b.addXAFF(d)}if(p){k=I(m.cardinality(),0);p=m.nextSetBit(0);for(j=0;0<=p;p=m.nextSetBit(p+1))k[j++]=this.eval.getBitsetProperty(n,d,c[p],h,e.value,null,
!1,e.index,!1).floatValue();return b.addXAF(k)}return b.addXObj(this.eval.getBitsetProperty(m,d,g,h,e.value,null,!1,e.index,!1))}}}return b.addXFloat(this.getDistance(b,e,f,c))},"J.script.ScriptMathProcessor,~A,~N,~N");k(c$,"getDistance",function(b,a,c,d){var e=b.ptValue(a,!0);a=b.planeValue(a);var f=b.ptValue(c,!0);b=b.planeValue(c);if(1276117505==d){if(null!=a&&null!=b)return a.x*b.x+a.y*b.y+a.z*b.z+a.w*b.w;null!=a&&(e=JU.P3.new3(a.x,a.y,a.z));null!=b&&(f=JU.P3.new3(b.x,b.y,b.z));return e.x*f.x+
e.y*f.y+e.z*f.z}return null==a?null==b?f.distance(e):J.util.Measure.distanceToPlane(b,e):J.util.Measure.distanceToPlane(a,f)},"J.script.ScriptMathProcessor,J.script.SV,J.script.SV,~N");k(c$,"evaluateMeasure",function(b,a,c){var d=0;switch(c){case 1746538509:c=new JU.List;for(var e=[3.4028235E38,3.4028235E38],f=null,g=null,h=!1,j=!1,p=0,k=!1,m=null,n=0,C=3.4028235E38,q=!1,y=!1,m=0;m<a.length;m++)switch(a[m].tok){case 10:var w=a[m].value;0==w.length()&&(k=!0);c.addLast(w);d++;n++;break;case 8:w=new J.util.Point3fi;
w.setT(a[m].value);c.addLast(w);d++;break;case 2:case 3:e[p++%2]=J.script.SV.fValue(a[m]);break;case 4:w=J.script.SV.sValue(a[m]);w.equalsIgnoreCase("vdw")||w.equalsIgnoreCase("vanderwaals")?C=(m+1<a.length&&2==a[m+1].tok?a[++m].asInt():100)/100:w.equalsIgnoreCase("notConnected")?j=!0:w.equalsIgnoreCase("connected")?h=!0:w.equalsIgnoreCase("minArray")?q=1<=n:w.equalsIgnoreCase("asArray")?y=1<=n:JU.PT.isOneOf(w.toLowerCase(),";nm;nanometers;pm;picometers;angstroms;ang;au;")||w.endsWith("hz")?g=w.toLowerCase():
f=d+":"+w;break;default:return!1}if(2>d||4<d||2<p||j&&h)return!1;if(k||3.4028235E38!=C&&(2!=n||2!=d))return b.addXStr("");m=3.4028235E38==C?new J.atomdata.RadiusData(e,0,null,null):new J.atomdata.RadiusData(null,C,J.atomdata.RadiusData.EnumType.FACTOR,J.constant.EnumVdw.AUTO);return b.addXObj(this.newMeasurementData(null,c).set(0,null,m,f,g,null,h,j,null,!0,0,0,null).getMeasurements(y,q));case 135266305:if(3!=(d=a.length)&&4!=d)return!1;break;default:if(2!=(d=a.length))return!1}c=Array(d);for(m=0;m<
d;m++)c[m]=b.ptValue(a[m],!0);switch(d){case 2:return b.addXFloat(c[0].distance(c[1]));case 3:return b.addXFloat(J.util.Measure.computeAngleABC(c[0],c[1],c[2],!0));case 4:return b.addXFloat(J.util.Measure.computeTorsion(c[0],c[1],c[2],c[3],!0))}return!1},"J.script.ScriptMathProcessor,~A,~N");k(c$,"newMeasurementData",function(b,a){return J.api.Interface.getOptionInterface("modelset.MeasurementData").init(b,this.viewer,a)},"~S,JU.List");k(c$,"evaluateUserFunction",function(b,a,c,d,e){var f=null;if(e&&
(f=b.getX(),10!=f.tok))return!1;b.wasX=!1;for(var g=new JU.List,h=0;h<c.length;h++)g.addLast(c[h]);if(e)return b.addXObj(this.eval.getBitsetProperty(J.script.SV.bsSelectVar(f),d,null,null,f.value,[a,g],!1,f.index,!1));a=this.eval.runFunctionRet(null,a,g,null,!0,!0,!1);return null==a?!1:b.addXVar(a)},"J.script.ScriptMathProcessor,~S,~A,~N,~B");k(c$,"evaluateFind",function(b,a){if(0==a.length)return!1;var c=b.getX(),d=J.script.SV.sValue(a[0]),e=1<a.length&&1048589!=a[1].tok&&1048588!=a[1].tok?J.script.SV.sValue(a[1]):
"",f=d.equalsIgnoreCase("SEQUENCE"),g=d.equalsIgnoreCase("SMILES"),h=d.equalsIgnoreCase("SMARTS"),j=d.equalsIgnoreCase("MF");try{if(g||h||10==c.tok){var k=g||h?2:1,r=k<a.length&&10==a[k].tok?a[k++].value:null,m="bonds".equalsIgnoreCase(J.script.SV.sValue(a[a.length-1])),n=m||1048589==a[a.length-1].tok,k=null;switch(c.tok){case 4:var C=J.script.SV.sValue(c);if(null!=r)return!1;k=e.equalsIgnoreCase("mf")?this.viewer.getSmilesMatcher().getMolecularFormula(C,h):this.getSmilesMatches(e,C,null,null,h,!n);
break;case 10:if(j)return b.addXStr(J.util.JmolMolecule.getMolecularFormula(this.viewer.getModelSet().atoms,c.value,!1));if(f)return b.addXStr(this.viewer.getSmilesOpt(c.value,-1,-1,!1,!0,n,n,!1));if(g||h)d=e;if(m)var q=this.viewer.getSmilesMatcher().getCorrelationMaps(d,this.viewer.modelSet.atoms,this.viewer.getAtomCount(),c.value,!g,!0),k=0<q.length?this.viewer.getDihedralMap(q[0]):Y(0,0);else k=this.getSmilesMatches(d,null,c.value,r,!g,!n)}null==k&&this.eval.error(22);return b.addXObj(k)}}catch(y){if(S(y,
Exception))this.eval.evalError(y.getMessage(),null);else throw y;}f=0<=e.indexOf("v");j=0<=e.indexOf("i");e=0<=e.indexOf("m");g=7==c.tok;h=2==a.length;if(g||h){r=this.getPatternMatcher();h=null;try{h=r.compile(d,j)}catch(w){if(S(w,Exception))this.eval.evalError(w.toString(),null);else throw w;}c=J.script.SV.listValue(c);J.util.Logger.debugging&&J.util.Logger.debug("finding "+d);d=new JU.BS;j=n=0;C=null;r=e?new JU.List:null;for(m=0;m<c.length;m++)if(q=c[m],C=h.matcher(q),k=C.find(),e&&k||!e&&k==!f)j++,
n=m,d.set(m),e&&r.addLast(f?q.substring(0,C.start())+q.substring(C.end()):C.group());if(!g)return e?b.addXStr(1==r.size()?r.get(0):""):f?b.addXBool(1==j):e?b.addXStr(0==j?"":C.group()):b.addXInt(0==j?0:C.start()+1);if(1==j)return b.addXStr(e?r.get(0):c[n]);f=Array(j);if(0<j)for(m=c.length;0<=--m;)d.get(m)&&(--j,f[j]=e?r.get(j):c[m]);return b.addXAS(f)}return b.addXInt(J.script.SV.sValue(c).indexOf(d)+1)},"J.script.ScriptMathProcessor,~A");k(c$,"getPatternMatcher",function(){return null==this.pm?this.pm=
J.api.Interface.getOptionInterface("util.PatternMatcher"):this.pm});k(c$,"evaluateGetProperty",function(b,a,c){var d=0,e=a.length>d?J.script.SV.sValue(a[d++]).toLowerCase():"",f=!1;e.equals("json")&&a.length>d&&(f=!0,e=J.script.SV.sValue(a[d++]));e.startsWith("$");c&&!e.equalsIgnoreCase("bondInfo")&&(e="atomInfo."+e);var g="";if(e.equalsIgnoreCase("fileContents")&&2<a.length){d=J.script.SV.sValue(a[1]);for(g=2;g<a.length;g++)d+="|"+J.script.SV.sValue(a[g]);g=d;d=a.length}else if(a.length>d)switch(a[d].tok){case 10:g=
J.script.SV.bsSelectVar(a[d++]);e.equalsIgnoreCase("bondInfo")&&(a.length>d&&10==a[d].tok)&&(g=[g,J.script.SV.bsSelectVar(a[d])]);break;case 4:this.viewer.checkPropertyParameter(e)&&(g=a[d++].value)}if(c){g=b.getX();if(10!=g.tok)return!1;g=J.script.SV.bsSelectVar(g).nextSetBit(0);if(0>g)return b.addXStr("");g=J.util.BSUtil.newAndSetBit(g)}g=this.viewer.getProperty(null,e,g);d<a.length&&(g=this.viewer.extractProperty(g,a,d));c&&C(g,JU.List)&&(g=0<g.size()?g.get(0):"");return b.addXObj(f?"{"+JU.PT.toJSON("value",
g)+"}":J.script.SV.isVariableType(g)?g:J.util.Escape.toReadable(e,g))},"J.script.ScriptMathProcessor,~A,~B");k(c$,"evaluatePlane",function(b,a,c){if(135267841==c&&3!=a.length||135267842==c&&2!=a.length&&3!=a.length||0==a.length||4<a.length)return!1;var d,e,f,g,h;switch(a.length){case 1:if(10==a[0].tok&&(c=J.script.SV.getBitSet(a[0],!1),3==c.cardinality())){a=this.viewer.getAtomPointVector(c);c=new JU.V3;h=new JU.V3;var j=new JU.V3;g=new JU.P4;J.util.Measure.getPlaneThroughPoints(a.get(0),a.get(1),
a.get(2),c,h,j,g);return b.addXPt4(g)}a=J.util.Escape.uP(J.script.SV.sValue(a[0]));return C(a,JU.P4)?b.addXPt4(a):b.addXStr(""+a);case 2:if(135267842==c){if(9!=a[1].tok)return!1;f=new JU.P3;c=new JU.V3;h=new JU.V3;g=a[1].value;if(9==a[0].tok)return a=J.util.Measure.getIntersectionPP(a[0].value,g),null==a?b.addXStr(""):b.addXList(a);e=b.ptValue(a[0],!1);return null==e?b.addXStr(""):b.addXPt(J.util.Measure.getIntersection(e,null,g,f,c,h))}case 3:case 4:switch(c){case 135267841:return b.addXPt4(this.eval.getHklPlane(JU.P3.new3(J.script.SV.fValue(a[0]),
J.script.SV.fValue(a[1]),J.script.SV.fValue(a[2]))));case 135267842:d=b.ptValue(a[0],!1);e=b.ptValue(a[1],!1);if(null==d||null==e)return b.addXStr("");e=JU.V3.newV(e);e.normalize();if(9==a[2].tok)return f=new JU.P3,c=new JU.V3,h=new JU.V3,d=J.util.Measure.getIntersection(d,e,a[2].value,f,c,h),null==d?b.addXStr(""):b.addXPt(d);f=b.ptValue(a[2],!1);if(null==f)return b.addXStr("");a=new JU.V3;J.util.Measure.projectOntoAxis(f,d,e,a);return b.addXPt(f)}switch(a[0].tok){case 2:case 3:if(3==a.length)return d=
J.script.SV.fValue(a[0]),f=J.script.SV.fValue(a[1]),a=J.script.SV.fValue(a[2]),c=JU.V3.new3(0,0,1),e=JU.P3.new3(0,1,0),a=J.util.Quaternion.newVA(e,a),a.getMatrix().rotate(c),e.set(0,0,1),a=J.util.Quaternion.newVA(e,f),a.getMatrix().rotate(c),e.setT(c),e.scale(d),g=new JU.P4,J.util.Measure.getPlaneThroughPoint(e,c,g),b.addXPt4(g);break;case 10:case 8:d=b.ptValue(a[0],!1);e=b.ptValue(a[1],!1);if(null==e)return!1;f=2<a.length&&(10==a[2].tok||8==a[2].tok)?b.ptValue(a[2],!1):null;c=JU.V3.newV(e);if(null==
f)return g=new JU.P4,2==a.length||!a[2].asBoolean()?(f=JU.P3.newP(d),f.add(e),f.scale(0.5),c.sub(d),c.normalize()):f=d,J.util.Measure.getPlaneThroughPoint(f,c,g),b.addXPt4(g);h=new JU.V3;j=new JU.V3;a=J.util.Measure.getDirectedNormalThroughPoints(d,e,f,4==a.length?b.ptValue(a[3],!0):null,c,h,j);return b.addXPt4(JU.P4.new4(c.x,c.y,c.z,a))}}if(4!=a.length)return!1;c=J.script.SV.fValue(a[0]);e=J.script.SV.fValue(a[1]);d=J.script.SV.fValue(a[2]);a=J.script.SV.fValue(a[3]);return b.addXPt4(JU.P4.new4(c,
e,d,a))},"J.script.ScriptMathProcessor,~A,~N");k(c$,"evaluatePoint",function(b,a){if(1!=a.length&&3!=a.length&&4!=a.length)return!1;switch(a.length){case 1:if(3==a[0].tok||2==a[0].tok)return b.addXInt(a[0].asInt());var c=J.script.SV.sValue(a[0]);7==a[0].tok&&(c="{"+c+"}");c=J.util.Escape.uP(c);return C(c,JU.P3)?b.addXPt(c):b.addXStr(""+c);case 3:return b.addXPt(JU.P3.new3(a[0].asFloat(),a[1].asFloat(),a[2].asFloat()));case 4:return b.addXPt4(JU.P4.new4(a[0].asFloat(),a[1].asFloat(),a[2].asFloat(),
a[3].asFloat()))}return!1},"J.script.ScriptMathProcessor,~A");k(c$,"evaluatePrompt",function(b,a){if(1!=a.length&&2!=a.length&&3!=a.length)return!1;var c=J.script.SV.sValue(a[0]),d=1<a.length&&7==a[1].tok?J.script.SV.listValue(a[1]):null,e=null!=d||1==a.length||3==a.length&&a[2].asBoolean(),f=null!=d?null:2<=a.length?J.script.SV.sValue(a[1]):"OK",c=""+this.viewer.prompt(c,f,d,e);return e&&null!=d?b.addXInt(Integer.parseInt(c)+1):b.addXStr(c)},"J.script.ScriptMathProcessor,~A");k(c$,"evaluateReplace",
function(b,a){if(2!=a.length)return!1;var c=b.getX(),d=J.script.SV.sValue(a[0]),e=J.script.SV.sValue(a[1]),f=7==c.tok?null:J.script.SV.sValue(c);if(null!=f)return b.addXStr(JU.PT.rep(f,d,e));c=J.script.SV.listValue(c);for(f=c.length;0<=--f;)c[f]=JU.PT.rep(c[f],d,e);return b.addXAS(c)},"J.script.ScriptMathProcessor,~A");k(c$,"evaluateString",function(b,a,c){if(1<c.length)return!1;var d=b.getX();if(7==d.tok&&1276117510!=a&&1276117512!=a)return b.addXVar(d),this.evaluateList(b,a,c);var e=1276117510==
a&&10==d.tok||1276117512==a&&7==d.tok?null:J.script.SV.sValue(d);c=1==c.length?J.script.SV.sValue(c[0]):1276117512==a?"":"\n";switch(a){case 1276117510:if(10==d.tok){d=J.script.SV.bsSelectVar(d);c="\n";var f=this.viewer.getModelCount(),e="";for(a=0;a<f;a++){var e=e+(0==a?"":"\n"),g=this.viewer.getModelUndeletedAtomsBitSet(a);g.and(d);e+=J.util.Escape.eBS(g)}}return b.addXAS(JU.PT.split(e,c));case 1276117506:return 0<e.length&&"\n"==e.charAt(e.length-1)&&(e=e.substring(0,e.length-1)),b.addXStr(JU.PT.rep(e,
"\n",c));case 1276117512:if(null!=e)return b.addXStr(JU.PT.trim(e,c));e=J.script.SV.listValue(d);for(a=e.length;0<=--a;)e[a]=JU.PT.trim(e[a],c);return b.addXAS(e)}return b.addXStr("")},"J.script.ScriptMathProcessor,~N,~A");k(c$,"evaluateList",function(b,a,c){var d=c.length,e=b.getX(),f;switch(a){case 1276383749:return 1==d&&b.addXVar(e.pushPop(c[0]));case 1276383249:return 0==d&&b.addXVar(e.pushPop(null));case 1276118017:if(1!=d&&2!=d)return!1;break;default:if(1!=d)return!1}var g=null,h=null;f=null;
if(2==d){d=4==c[0].tok?0:1;a=J.script.SV.sValue(c[d]);g=7==e.tok?J.script.SV.listValue(e):JU.PT.split(J.script.SV.sValue(e),"\n");f=c[1-d];h=7==f.tok?J.script.SV.listValue(f):JU.PT.split(J.script.SV.sValue(f),"\n");f=Array(d=Math.max(g.length,h.length));for(c=0;c<d;c++)f[c]=(c>=g.length?"":g[c])+a+(c>=h.length?"":h[c]);return b.addXAS(f)}f=0==d?J.script.SV.newV(1048579,"all"):c[0];c=1048579==f.tok;if(7!=e.tok&&4!=e.tok)return b.binaryOp(this.opTokenFor(a),e,f);var j=J.script.SV.isScalar(e),k=J.script.SV.isScalar(f),
r=null,m=null,n=e.getList(),C=f.getList();7==e.tok?d=n.size():j?d=2147483647:(g=JU.PT.split(J.script.SV.sValue(e),"\n"),r=I(d=g.length,0),JU.PT.parseFloatArrayData(g,r));if(c){g=0;if(7==e.tok)for(c=d;0<=--c;)g+=J.script.SV.fValue(n.get(c));else if(!j)for(c=d;0<=--c;)g+=r[c];return b.addXFloat(g)}if(1276117506==a&&4==f.tok){g=new JU.SB;if(j)g.append(J.script.SV.sValue(e));else for(c=0;c<d;c++)g.appendO(0<c?f.value:null).append(J.script.SV.sValue(n.get(c)));return b.addXStr(g.toString())}var q=null;
k?q=f:7==f.tok?d=Math.min(d,C.size()):(h=JU.PT.split(J.script.SV.sValue(f),"\n"),m=I(h.length,0),JU.PT.parseFloatArrayData(h,m),d=Math.min(d,m.length));var y=this.opTokenFor(a),w=Array(d),s=j?e:null,v;for(c=0;c<d;c++){v=k?q:7==f.tok?C.get(c):Float.isNaN(m[c])?J.script.SV.getVariable(J.script.SV.unescapePointOrBitsetAsVariable(h[c])):J.script.SV.newV(3,Float.$valueOf(m[c]));j||(s=7==e.tok?n.get(c):Float.isNaN(r[c])?J.script.SV.getVariable(J.script.SV.unescapePointOrBitsetAsVariable(g[c])):J.script.SV.newV(3,
Float.$valueOf(r[c])));if(1276117506==a&&7!=s.tok){var u=new JU.List;u.addLast(s);s=J.script.SV.getVariableList(u)}if(!b.binaryOp(y,s,v))return!1;w[c]=b.getX()}return b.addXAV(w)},"J.script.ScriptMathProcessor,~N,~A");k(c$,"opTokenFor",function(b){switch(b){case 1276118017:case 1276117506:return J.script.T.tokenPlus;case 1276117511:return J.script.T.tokenMinus;case 1276117507:return J.script.T.tokenTimes;case 1276117508:return J.script.T.tokenMul3;case 1276117504:return J.script.T.tokenDivide}return null},
"~N");k(c$,"evaluateRowCol",function(b,a,c){if(1!=a.length)return!1;a=a[0].asInt()-1;var d=b.getX();switch(d.tok){case 11:if(0>a||2<a)break;d=d.value;switch(c){case 1276117515:return c=I(3,0),d.getRow(a,c),b.addXAF(c);default:return c=I(3,0),d.getColumn(a,c),b.addXAF(c)}case 12:if(0>a||2<a)break;d=d.value;switch(c){case 1276117515:return c=I(4,0),d.getRow(a,c),b.addXAF(c);default:return c=I(4,0),d.getColumn(a,c),b.addXAF(c)}}return!1},"J.script.ScriptMathProcessor,~A,~N");k(c$,"evaluateArray",function(b,
a,c){var d=a.length;if(c&&(4==d||3==d)){var e=!0;for(c=0;c<d&&e;c++)e=7==a[c].tok&&a[c].getList().size()==d;if(e){var f=I(d*d,0),g=0;for(c=0;c<d&&e;c++)for(var h=a[c].getList(),j=0;j<d;j++){var k=J.script.SV.fValue(h.get(j));if(Float.isNaN(k)){e=!1;break}f[g++]=k}if(e)return 3==d?b.addXM3(JU.M3.newA9(f)):b.addXM4(JU.M4.newA16(f))}}d=Array(a.length);for(c=d.length;0<=--c;)d[c]=J.script.SV.newT(a[c]);return b.addXAV(d)},"J.script.ScriptMathProcessor,~A,~B");k(c$,"evaluateMath",function(b,a,c){if(135266318==
c)return 1==a.length&&4==a[0].tok?b.addXStr(new java.util.Date+"\t"+J.script.SV.sValue(a[0])):b.addXInt((System.currentTimeMillis()&2147483647)-(0==a.length?0:a[0].asInt()));if(1!=a.length)return!1;if(135266826==c)return 2==a[0].tok?b.addXInt(Math.abs(a[0].asInt())):b.addXFloat(Math.abs(a[0].asFloat()));a=J.script.SV.fValue(a[0]);switch(c){case 135266819:return b.addXFloat(180*Math.acos(a)/3.141592653589793);case 135266821:return b.addXFloat(Math.cos(3.141592653589793*a/180));case 135266820:return b.addXFloat(Math.sin(3.141592653589793*
a/180));case 135266822:return b.addXFloat(Math.sqrt(a))}return!1},"J.script.ScriptMathProcessor,~A,~N");k(c$,"evaluateQuaternion",function(b,a,c){var d=null,e=a.length,f=2147483647,g=!1;135270418==c&&(1<e&&(4==a[e-1].tok&&a[e-1].value.equalsIgnoreCase("relative"))&&(e--,g=!0),1<e&&(2==a[e-1].tok&&10==a[0].tok)&&(f=a[e-1].asInt(),0>=f&&(f=2147483646),e--));switch(e){case 0:case 1:case 4:break;case 2:if(135270418==c){if(7==a[0].tok&&(7==a[1].tok||1048589==a[1].tok))break;if(10==a[0].tok&&(2==a[1].tok||
10==a[1].tok))break}if(null==(d=b.ptValue(a[0],!1))||135270418!=c&&8==a[1].tok)return!1;break;case 3:if(135270418!=c)return!1;if(9==a[0].tok){if(8!=a[2].tok&&10!=a[2].tok)return!1;break}for(var h=0;3>h;h++)if(8!=a[h].tok&&10!=a[h].tok)return!1;break;default:return!1}var j=h=null,k=null;switch(e){case 0:return b.addXPt4(J.util.Quaternion.newQ(this.viewer.getRotationQuaternion()).toPoint4f());default:if(135270418==c&&7==a[0].tok){c=this.getQuaternionArray(a[0].getList(),1073742001);a=J.util.Quaternion.sphereMean(c,
null,1E-4);h=C(a,J.util.Quaternion)?a:null;break}else if(135270418==c&&10==a[0].tok)j=this.viewer.getAtomGroupQuaternions(a[0].value,f);else if(11==a[0].tok)h=J.util.Quaternion.newM(a[0].value);else if(9==a[0].tok)k=a[0].value;else if(k=J.script.SV.sValue(a[0]),k=J.util.Escape.uP(k.equalsIgnoreCase("best")?this.viewer.getOrientationText(1073741863,null):k),!C(k,JU.P4))return!1;135266307==c&&(h=J.util.Quaternion.newVA(JU.P3.new3(k.x,k.y,k.z),k.w));break;case 2:if(135270418==c){if(7==a[0].tok&&7==a[1].tok){c=
this.getQuaternionArray(a[0].getList(),1073742001);j=this.getQuaternionArray(a[1].getList(),1073742001);j=J.util.Quaternion.div(j,c,f,g);break}if(7==a[0].tok&&1048589==a[1].tok)return c=this.getQuaternionArray(a[0].getList(),1073742001),f=I(1,0),J.util.Quaternion.sphereMean(c,f,1E-4),b.addXFloat(f[0]);if(10==a[0].tok&&10==a[1].tok){c=this.viewer.getAtomGroupQuaternions(a[0].value,2147483647);j=this.viewer.getAtomGroupQuaternions(a[1].value,2147483647);j=J.util.Quaternion.div(j,c,f,g);break}}h=b.ptValue(a[1],
!1);k=b.planeValue(a[0]);h=null!=h?J.util.Quaternion.getQuaternionFrame(JU.P3.new3(0,0,0),d,h):J.util.Quaternion.newVA(d,J.script.SV.fValue(a[1]));break;case 3:if(9==a[0].tok)return f=8==a[2].tok?a[2].value:this.viewer.getAtomSetCenter(a[2].value),b.addXStr(J.util.Quaternion.newP4(a[0].value).draw("q",J.script.SV.sValue(a[1]),f,1));c=Array(3);for(h=0;3>h;h++)c[h]=8==a[h].tok?a[h].value:this.viewer.getAtomSetCenter(a[h].value);h=J.util.Quaternion.getQuaternionFrame(c[0],c[1],c[2]);break;case 4:135270418==
c?k=JU.P4.new4(J.script.SV.fValue(a[1]),J.script.SV.fValue(a[2]),J.script.SV.fValue(a[3]),J.script.SV.fValue(a[0])):h=J.util.Quaternion.newVA(JU.P3.new3(J.script.SV.fValue(a[0]),J.script.SV.fValue(a[1]),J.script.SV.fValue(a[2])),J.script.SV.fValue(a[3]))}if(null!=j){if(2147483647!=f){f=new JU.List;for(h=0;h<j.length;h++)f.addLast(j[h].toPoint4f());return b.addXList(f)}h=0<j.length?j[0]:null}return b.addXPt4((null==h?J.util.Quaternion.newP4(k):h).toPoint4f())},"J.script.ScriptMathProcessor,~A,~N");
k(c$,"evaluateRandom",function(b,a){if(2<a.length)return!1;var c=2>a.length?0:J.script.SV.fValue(a[0]),d=0==a.length?1:J.script.SV.fValue(a[a.length-1]);return b.addXFloat(Math.random()*(d-c)+c)},"J.script.ScriptMathProcessor,~A");k(c$,"evaluateCross",function(b,a){if(2!=a.length)return!1;var c=a[0],d=a[1];if(8!=c.tok||8!=d.tok)return!1;c=JU.V3.newV(c.value);d=JU.V3.newV(d.value);c.cross(c,d);return b.addXPt(JU.P3.newP(c))},"J.script.ScriptMathProcessor,~A");k(c$,"evaluateLoad",function(b,a,c){if(2<
a.length||1>a.length)return!1;var d=J.script.SV.sValue(a[0]),d=d.$replace("\\","/");a=2==a.length?a[1].asInt():-1;if(this.viewer.isJS&&d.startsWith("?")){if(1229984263==c)return b.addXStr("");d=this.eval.loadFileAsync("load()_",d,b.oPt,!0)}return b.addXStr(135271426==c?this.viewer.getFileAsString4(d,a,!1,!1,!0):this.viewer.getFilePath(d,!1))},"J.script.ScriptMathProcessor,~A,~N");k(c$,"evaluateWrite",function(b,a){return 0==a.length?!1:b.addXStr(this.write(a))},"J.script.ScriptMathProcessor,~A");
k(c$,"evaluateScript",function(b,a,c){if(135287308==c&&1!=a.length||0==a.length||2<a.length)return!1;var d=J.script.SV.sValue(a[0]),e=new JU.SB;switch(c){case 135271429:a=2==a.length?J.script.SV.sValue(a[1]):".";a.equals(".")||e.append(this.viewer.jsEval(a+"\u0001"+d));(a.equals(".")||a.equals("*"))&&this.eval.runScriptBuffer(d,e);break;case 135287308:e.append(this.viewer.jsEval(d))}var d=e.toString(),f;return Float.isNaN(f=JU.PT.parseFloatStrict(d))?b.addXStr(d):0<=d.indexOf(".")?b.addXFloat(f):
b.addXInt(JU.PT.parseInt(d))},"J.script.ScriptMathProcessor,~A,~N");k(c$,"evaluateData",function(b,a){if(1!=a.length&&2!=a.length&&4!=a.length)return!1;var c=J.script.SV.sValue(a[0]),d=2==a.length?J.script.SV.sValue(a[1]):"";if(4==a.length){var d=a[1].asInt(),e=a[2].asInt(),f=a[3].asInt(),c=J.util.Parser.parseFloatArrayFromMatchAndField(c,null,0,0,null,d,e,null,f);return b.addXStr(J.util.Escape.escapeFloatA(c,!1))}if(0==c.indexOf("data2d_"))return c=this.viewer.getDataFloat2D(c),null==c?b.addXStr(""):
2==a.length&&2==a[1].tok?(d=a[1].intValue,0>d&&(d+=c.length),0<=d&&d<c.length?b.addXStr(J.util.Escape.escapeFloatA(c[d],!1)):b.addXStr("")):b.addXStr(J.util.Escape.escapeFloatAA(c,!1));if(0==c.indexOf("property_")){c=this.viewer.getDataFloat(c);if(null==c)return b.addXStr("");d=0==d.indexOf("property_")?this.viewer.getDataFloat(d):null;if(null!=d){c=JU.AU.arrayCopyF(c,-1);for(e=Math.min(c.length,d.length);0<=--e;)c[e]+=d[e]}return b.addXStr(J.util.Escape.escapeFloatA(c,!1))}return 1==a.length?(c=
this.viewer.getData(c),b.addXStr(null==c?"":""+c[1])):b.addXStr(this.viewer.getData(c,d))},"J.script.ScriptMathProcessor,~A");k(c$,"evaluateLabel",function(b,a,c){var d=2>c.length?b.getX():null,e=0==c.length?"%U":J.script.SV.sValue(c[0]);a=J.script.T.tokAttr(a,480);if(null==d){if(2>c.length||7!=c[1].tok)return b.addXStr(J.script.SV.sprintfArray(c));d=c[1].getList();c=[c[0],null];e=Array(d.size());for(a=e.length;0<=--a;)c[1]=d.get(a),e[a]=J.script.SV.sprintfArray(c);return b.addXAS(e)}c=J.script.SV.getBitSet(d,
!0);return null==c?b.addXObj(J.script.SV.sprintf(J.util.Txt.formatCheck(e),d)):b.addXObj(this.getBitsetIdent(c,e,d.value,!0,d.index,a))},"J.script.ScriptMathProcessor,~N,~A");k(c$,"evaluateWithin",function(b,a){if(1>a.length||5<a.length)return!1;var c=a.length,d=0,e=a[0].value,f=""+e,g=a[0].tok;4==g&&(g=J.script.T.getTokFromName(f));var h=1649412120==g;h&&(d=100,e=null);var j=!1,k=!1,r=h||3==g||2==g,m=null;switch(g){case 1048580:return 3!=c||!C(a[1].value,JU.BS)||!C(a[2].value,JU.BS)?!1:b.addXBs(this.viewer.getBranchBitSet(a[2].value.nextSetBit(0),
a[1].value.nextSetBit(0),!0));case 135267336:case 1238369286:case 135267335:d=null;f=!0;switch(c){case 2:break;case 3:if(f=10==a[2].tok)d=a[2].value;break;default:f=!1}f||this.eval.error(22);return b.addXObj(this.getSmilesMatches(J.script.SV.sValue(a[1]),null,d,null,135267335==g,b.asBitSet))}if(C(e,String)){if(0==g){g=1048614;if(2<c)return!1;c=2}}else if(r){h||(d=J.script.SV.fValue(a[0]));if(2>c)return!1;switch(g=a[1].tok){case 1048589:case 1048588:j=a[1].asBoolean();c=0;break;case 4:g=J.script.SV.sValue(a[1]);
if(g.startsWith("$"))return b.addXBs(this.getAtomsNearSurface(d,g.substring(1)));k=g.equalsIgnoreCase("group");g=(h=g.equalsIgnoreCase("vanderwaals"))?1649412120:1087373318}}else return!1;var n=e=null;switch(c){case 1:switch(g){case 137363467:case 3145760:case 1679429641:return b.addXBs(this.viewer.getAtomBits(g,null));case 1073741864:return b.addXBs(this.viewer.getAtomBits(g,""));case 1048614:return b.addXBs(this.viewer.getAtomBits(1087373320,f))}return!1;case 2:switch(g){case 1048614:g=1087373320;
break;case 1087375362:case 1087375361:case 1073741864:case 1087373320:return b.addXBs(this.viewer.getAtomBits(g,J.script.SV.sValue(a[a.length-1])))}break;case 3:switch(g){case 1048589:case 1048588:case 1087373318:case 1649412120:case 135266319:case 135267841:case 1048582:break;case 1087373320:f=J.script.SV.sValue(a[2]);break;default:return!1}}c=a.length-1;C(a[c].value,JU.P4)?n=a[c].value:C(a[c].value,JU.P3)&&(e=a[c].value,J.script.SV.sValue(a[1]).equalsIgnoreCase("hkl")&&(n=this.eval.getHklPlane(e)));
if(0<c&&null==n&&null==e&&!C(a[c].value,JU.BS))return!1;if(null!=n)return b.addXBs(this.viewer.getAtomsNearPlane(d,n));if(null!=e)return b.addXBs(this.viewer.getAtomsNearPt(d,e));c=10==a[c].tok?J.script.SV.bsSelectVar(a[c]):null;if(1087373320==g)return b.addXBs(this.viewer.getSequenceBits(f,c));null==c&&(c=new JU.BS);if(!r)return b.addXBs(this.viewer.getAtomBits(g,c));if(k)return b.addXBs(this.viewer.getGroupsWithin(M(d),c));h&&(m=new J.atomdata.RadiusData(null,10<d?d/100:d,10<d?J.atomdata.RadiusData.EnumType.FACTOR:
J.atomdata.RadiusData.EnumType.OFFSET,J.constant.EnumVdw.AUTO));return b.addXBs(this.viewer.getAtomsWithinRadius(d,c,j,m))},"J.script.ScriptMathProcessor,~A");k(c$,"getAtomsNearSurface",function(b,a){var c=[a,null,null];if(this.chk)return new JU.BS;if(this.eval.getShapePropertyData(24,"getVertices",c))return this.viewer.getAtomsNearPts(b,c[1],c[2]);c[1]=Integer.$valueOf(0);c[2]=Integer.$valueOf(-1);return this.eval.getShapePropertyData(22,"getCenter",c)?this.viewer.getAtomsNearPt(b,c[2]):new JU.BS},
"~N,~S");k(c$,"evaluateColor",function(b,a){var c=0<a.length?J.script.SV.sValue(a[0]):"";if(c.equalsIgnoreCase("hsl")&&2==a.length){var d=JU.P3.newP(J.script.SV.ptValue(a[1])),e=I(3,0);J.util.ColorEncoder.RGBtoHSL(d.x,d.y,d.z,e);d.set(360*e[0],100*e[1],100*e[2]);return b.addXPt(d)}var f=c.startsWith("$"),g=f?null:this.viewer.getColorEncoder(c);if(!f&&null==g)return b.addXStr("");var d=1<a.length?J.script.SV.fValue(a[1]):3.4028235E38,h=2<a.length?J.script.SV.fValue(a[2]):3.4028235E38,e=3<a.length?
J.script.SV.fValue(a[3]):3.4028235E38,j=3.4028235E38!=e||3.4028235E38!=d&&3.4028235E38==h;3.4028235E38==h&&0==c.length&&(e=d,h=this.viewer.getCurrentColorRange(),d=h[0],h=h[1]);if(f){g=[c.substring(1),null];if(!this.viewer.getShapePropertyData(24,"colorEncoder",g))return b.addXStr("");g=g[1]}else g.setRange(d,h,d>h);c=g.getColorKey();return j?b.addXPt(JU.CU.colorPtFromInt2(g.getArgb(3.4028235E38==h?d:e))):b.addXVar(J.script.SV.getVariableMap(c))},"J.script.ScriptMathProcessor,~A");k(c$,"evaluateConnected",
function(b,a){if(5<a.length)return!1;for(var c=-2147483648,d=2147483647,e=0,f=3.4028235E38,g=65535,h=null,j=null,k=!1,r=!1,m=0;m<a.length;m++){var n=a[m];switch(n.tok){case 10:if((r=C(n.value,J.modelset.BondSet))&&null!=h)return!1;if(null==h)h=J.script.SV.bsSelectVar(n);else if(null==j)j=J.script.SV.bsSelectVar(n);else return!1;break;case 4:g=J.script.SV.sValue(n);g=g.equalsIgnoreCase("hbond")?30720:J.script.ScriptEvaluator.getBondOrderFromString(g);if(131071==g)return!1;break;case 3:k=!0;default:var I=
n.asInt(),n=n.asFloat();if(2147483647!=d)return!1;-2147483648==c?(c=Math.max(I,0),e=n):(d=I,f=n)}}-2147483648==c?(c=1,d=100,e=0.1,f=1E8):2147483647==d&&(d=c,f=e,e=0.1);null==h&&(h=this.viewer.getAllAtoms());k&&null==j&&(j=h);return null!=j?(c=new JU.BS,this.viewer.makeConnections(e,f,g,1087373321,h,j,c,r,!1,0),b.addXVar(J.script.SV.newV(10,new J.modelset.BondSet(c,this.viewer.getAtomIndices(this.viewer.getAtomBits(1678770178,c)))))):b.addXBs(this.viewer.getAtomsConnected(c,d,g,h))},"J.script.ScriptMathProcessor,~A");
k(c$,"evaluateSubstructure",function(b,a,c){if(0==a.length)return!1;var d=new JU.BS,e=J.script.SV.sValue(a[0]);if(0<e.length)try{var f=2==a.length&&10==a[1].tok?J.script.SV.bsSelectVar(a[1]):null,d=this.viewer.getSmilesMatcher().getSubstructureSet(e,this.viewer.getModelSet().atoms,this.viewer.getAtomCount(),f,135267336!=c,!1)}catch(g){if(S(g,Exception))this.eval.evalError(g.getMessage(),null);else throw g;}return b.addXBs(d)},"J.script.ScriptMathProcessor,~A,~N");k(c$,"getMinMaxPoint",function(b,
a){var c=null,d=null,e=0;C(b,Array)?(c=b,e=c.length):C(b,JU.List)&&(d=b,e=d.size());if(null!=d||null!=c){for(var f=new JU.P3,g=I(e,0),h=!0,j=0;3>j&&h;j++){for(var k=0;k<e;k++){var r=null==c?J.script.SV.ptValue(d.get(k)):c[k];if(null==r){h=!1;break}switch(j){case 0:g[k]=r.x;break;case 1:g[k]=r.y;break;case 2:g[k]=r.z}}if(!h)break;k=this.getMinMax(g,a);if(C(k,Float))switch(k=k.floatValue(),j){case 0:f.x=k;break;case 1:f.y=k;break;case 2:f.z=k}else break}return f}return"NaN"},"~O,~N");k(c$,"getMinMaxQuaternion",
function(b,a){var c;switch(a){case 32:case 64:case 128:case 160:return"NaN"}for(;;){c=this.getQuaternionArray(b,1073742001);if(null==c)break;var d=I(1,0);c=J.util.Quaternion.sphereMean(c,d,1E-4);switch(a){case 96:return c;case 192:return Float.$valueOf(d[0])}break}return"NaN"},"JU.List,~N");k(c$,"getQuaternionArray",function(b,a){var c;switch(a){case 135270418:c=b;break;case 9:c=Array(b.length);for(var d=0;d<b.length;d++)c[d]=J.util.Quaternion.newP4(b[d]);break;case 1073742001:c=Array(b.size());for(d=
0;d<b.size();d++){var e=J.script.SV.pt4Value(b.get(d));if(null==e)return null;c[d]=J.util.Quaternion.newP4(e)}break;default:return null}return c},"~O,~N");R(c$,"getMinMax",function(b,a){for(var c=null,d=null,e=0;;){if(JU.PT.isAF(b)){if(c=b,e=c.length,0==e)break}else if(C(b,JU.List)){d=b;e=d.size();if(0==e)break;var f=d.get(0);if(4==f.tok&&f.value.startsWith("{")){c=J.script.SV.ptValue(f);if(C(c,JU.P3))return this.getMinMaxPoint(d,a);if(C(c,JU.P4))return this.getMinMaxQuaternion(d,a);break}}else break;
switch(a){case 32:f=3.4028235E38;break;case 64:f=-3.4028235E38;break;default:f=0}for(var g=0,h=0;0<=--e;){var j=null==c?J.script.SV.fValue(d.get(e)):c[e];if(!Float.isNaN(j))switch(h++,a){case 160:case 192:g+=j*j;case 128:case 96:f+=j;break;case 32:j<f&&(f=j);break;case 64:j>f&&(f=j)}}if(0==h)break;switch(a){case 96:f/=h;break;case 192:if(1==h)break;f=Math.sqrt((g-f*f/h)/(h-1));break;case 160:f=g}return Float.$valueOf(f)}return"NaN"},"~O,~N");k(c$,"capture",function(){if(!this.chk&&!this.viewer.allowCapture())this.showString("Cannot capture on this platform");
else{var b=this.viewer.getInt(553648132),a=10,c=0,d="",e=this.viewer.captureParams,f=!this.viewer.getAnimationReplayMode().name().equals("ONCE"),g=this.tokAt(1),h="";switch(g){case 0:c=1150985;break;case 4:d=this.eval.optParameterAsString(1);if(0==d.length){c=1150985;break}d.endsWith(".gif")||(d+=".gif");var g=null,c="y",j;switch(this.tokAt(2)){case 1073742129:f=!0;j=3;c=2==this.tokAt(3)?"y":this.eval.optParameterAsString(j++).toLowerCase();g=0==this.tokAt(j)?5:this.intParameter(j++);g=JU.PT.rep("; rotate Y 10 10;delay 2.0; rotate Y -10 -10; delay 2.0;rotate Y -10 -10; delay 2.0;rotate Y 10 10;delay 2.0",
"10",""+g);break;case 1611141175:f=!0;j=3;c=this.eval.optParameterAsString(j).toLowerCase();0<c.length&&j++;g="; rotate Y 360 30;delay 15.0;";2==this.tokAt(j)&&(h=" "+(b=this.intParameter(j++)));break;case 3:a=this.floatParameter(2);break;case 2:b=this.intParameter(2)}if(null!=g){this.chk||this.viewer.setNavigationMode(!1);if(""===c||0>"xyz".indexOf(c))c="y";g=JU.PT.rep(g,"Y",c);g="capture "+JU.PT.esc(d)+h+g+";capture;";this.eval.script(0,null,g);return}null!=e&&new java.util.Hashtable;c=1073742032;
e=new java.util.Hashtable;f||this.showString(J.i18n.GT.o(J.i18n.GT._("Note: Enable looping using {0}"),["ANIMATION MODE LOOP"]));this.showString(J.i18n.GT.o(J.i18n.GT._("Animation delay based on: {0}"),["ANIMATION FPS "+b]));e.put("captureFps",Integer.$valueOf(b));break;case 1073741874:case 1048589:case 1048588:this.checkLength(2);c=g;break;default:this.invArg()}this.chk||null==e||(e.put("type","GIF"),e.put("fileName",d),e.put("quality",Integer.$valueOf(-1)),e.put("endTime",Long.$valueOf(System.currentTimeMillis()+
Clazz_floatToLong(1E3*a))),e.put("captureMode",Integer.$valueOf(c)),e.put("captureLooping",f?Boolean.TRUE:Boolean.FALSE),b=this.viewer.processWriteOrCapture(e),J.util.Logger.info(b))}});k(c$,"console",function(){switch(this.getToken(1).tok){case 1048588:this.chk||this.viewer.showConsole(!1);break;case 1048589:this.chk||this.viewer.showConsole(!0);break;case 1073741882:this.chk||this.viewer.clearConsole();break;case 135270422:this.showString(this.stringParameter(2));break;default:this.invArg()}});
k(c$,"centerAt",function(){var b=this.getToken(1).tok;switch(b){case 1073741826:case 96:case 1679429641:break;default:this.invArg()}var a=JU.P3.new3(0,0,0);5==this.slen?(a.x=this.floatParameter(2),a.y=this.floatParameter(3),a.z=this.floatParameter(4)):this.eval.isCenterParameter(2)?(a=this.centerParameter(2),this.eval.checkLast(this.eval.iToken)):this.checkLength(2);this.chk||this.viewer.setCenterAt(b,a)});k(c$,"stereo",function(){for(var b=J.constant.EnumStereoMode.DOUBLE,a=-5,c=!1,d=null,e=0,f=
1;f<this.slen;++f)if(this.eval.isColorParam(f))1<e&&this.eval.bad(),0==e&&(d=Y(2,0)),c||(a=3),d[e]=this.eval.getArgbParam(f),0==e++&&(d[1]=~d[0]),f=this.eval.iToken;else switch(this.getToken(f).tok){case 1048589:this.eval.checkLast(this.eval.iToken=1);this.eval.iToken=1;break;case 1048588:this.eval.checkLast(this.eval.iToken=1);b=J.constant.EnumStereoMode.NONE;break;case 2:case 3:a=this.floatParameter(f);c=!0;break;case 1073741824:if(c||(a=3),b=J.constant.EnumStereoMode.getStereoMode(this.parameterAsString(f)),
null!=b)break;default:this.invArg()}this.chk||this.viewer.setStereoMode(d,b,a)});k(c$,"connect",function(b){var a=I(2,0),c=Array(2);c[0]=c[1]=this.viewer.getSelectedAtoms();var d=NaN;this.eval.colorArgb[0]=-2147483648;var e=0,f=131071,g=1073742026,h=!1,j=!1,k=!1,r=3.4028235E38,m=!1,n=0,C=0,q=new JU.BS,y=!1,w=0,s=0,v=0,u=!1;if(1==this.slen)this.chk||this.viewer.rebondState(this.eval.isStateScript);else{for(;b<this.slen;++b){switch(this.getToken(b).tok){case 1048589:case 1048588:this.checkLength(2);
this.chk||this.viewer.rebondState(this.eval.isStateScript);return;case 2:case 3:if(0<n){(j||m)&&this.eval.error(23);f=J.util.JmolEdge.getBondOrderFromFloat(this.floatParameter(b));131071==f&&this.invArg();j=!0;break}2<++C&&this.eval.bad();var G=this.floatParameter(b);269484210==this.tokAt(b+1)&&(G=-G/100,b++);a[e++]=G;break;case 10:case 1048577:(2<n||y&&0<n)&&this.eval.bad();(j||m)&&this.invArg();c[n++]=this.atomExpressionAt(b);y=this.eval.isBondSet;if(2==n){for(var G=this.eval.iToken,B=b;B<G;B++)if(1073741824==
this.tokAt(B)&&this.parameterAsString(B).equals("_1")){w=b;break}this.eval.iToken=G}b=this.eval.iToken;break;case 1087373318:u=!0;break;case 1766856708:case 603979967:case 1073742074:m=!0;r=this.eval.getColorTrans(b,!1);b=this.eval.iToken;break;case 1074790662:d=1073741852==this.tokAt(2);this.checkLength(d?3:2);this.chk||this.viewer.setPdbConectBonding(d,this.eval.isStateScript);return;case 1073741830:case 1073741852:case 1073741904:case 1073742025:case 1073742026:k=!0;++b!=this.slen&&this.invArg();
g=this.eval.theTok;1073741852==g&&!(131071==f||2048==f||515==f)&&this.invArg();break;case 1708058:m||(this.eval.colorArgb[0]=16777215,r=0.5,d=this.viewer.getFloat(570425406),m=!0),k||(g=1073742026),k=!0;case 1073741824:if(this.eval.isColorParam(b)){s=-b;break}case 1076887572:case 1612189718:f=this.parameterAsString(b);131071==(f=J.script.ScriptEvaluator.getBondOrderFromString(f))&&this.invArg();j&&this.eval.error(18);j=!0;switch(f){case 33:switch(this.tokAt(b+1)){case 3:f=J.script.ScriptEvaluator.getPartialBondOrderFromFloatEncodedInt(this.st[++b].intValue);
break;case 2:f=this.intParameter(++b)}break;case 2048:2==this.tokAt(b+1)&&(f=this.intParameter(++b)<<11,v=this.floatParameter(++b))}break;case 1666189314:d=this.floatParameter(++b);m=!0;break;case 1048587:case 12291:++b!=this.slen&&this.invArg();g=12291;h=!0;m=!1;break;default:s=b}0<b&&(s==-b||s==b&&this.eval.isColorParam(b)?(m=!0,this.eval.colorArgb[0]=this.eval.getArgbParam(b),b=this.eval.iToken):s==b&&this.invArg())}if(!this.chk){2>e&&(0==e&&(a[0]=1E8),a[1]=a[0],a[0]=0.1);m&&(j||(f=65535),k||(g=
1073742025));j=e=0;if(0<w){v=new JU.BS;this.eval.definedAtomSets.put("_1",v);u=c[0];for(k=u.nextSetBit(0);0<=k;k=u.nextSetBit(k+1))v.set(k),c=this.viewer.makeConnections(a[0],a[1],f,g,v,this.atomExpressionAt(w),q,y,!1,0),e+=Math.abs(c[0]),j+=c[1],v.clear(k)}else c=this.viewer.makeConnections(a[0],a[1],f,g,c[0],c[1],q,y,u,v),e+=Math.abs(c[0]),j+=c[1];a=this.eval.doReport();h?a&&this.eval.scriptStatusOrBuffer(J.i18n.GT.i(J.i18n.GT._("{0} connections deleted"),j)):(m&&(this.viewer.selectBonds(q),Float.isNaN(d)||
this.eval.setShapeSizeBs(1,Math.round(2E3*d),null),this.eval.finalizeObject(1,this.eval.colorArgb[0],r,0,!1,null,0,q),this.viewer.selectBonds(null)),a&&this.eval.scriptStatusOrBuffer(J.i18n.GT.o(J.i18n.GT._("{0} new bonds; {1} modified"),[Integer.$valueOf(e),Integer.$valueOf(j)])))}}},"~N");k(c$,"cache",function(){var b=this.tokAt(1),a=null,c=2;switch(b){case 1276118017:case 1073742119:a=this.eval.optParameterAsString(c++);case 1073741882:this.checkLength(c);this.chk||("all".equals(a)&&(a=null),a=
this.viewer.cacheFileByName(a,1276118017==b),this.showString(0>a?"cache cleared":a+" bytes "+(1276118017==b?" cached":" removed")));break;default:this.invArg()}});Fb(c$,"ERROR_invalidArgument",22)})})(Clazz,Clazz.newArray,Clazz.newBooleanArray,Clazz.newByteArray,Clazz.newCharArray,Clazz.newDoubleArray,Clazz.newFloatArray,Clazz.newIntArray,Clazz.newLongArray,Clazz.newShortArray,Clazz.prepareCallback,Clazz.decorateAsClass,Clazz.isClassDefined,Clazz.defineEnumConstant,Clazz.cloneFinals,Clazz.inheritArgs,
Clazz.pu$h,Clazz.declareInterface,Clazz.declarePackage,Clazz.makeConstructor,Clazz.overrideConstructor,Clazz.load,Clazz.defineMethod,Clazz.innerTypeInstance,Clazz.instanceOf,Clazz.p0p,Clazz.makeFunction,Clazz.superConstructor,Clazz.defineStatics,Clazz.registerSerializableFields,Clazz.declareType,Clazz.superCall,Clazz.overrideMethod,Clazz.declareAnonymous,Clazz.checkPrivateMethod,Clazz.prepareFields,Clazz.instantialize,Clazz.doubleToInt,Clazz.declarePackage,Clazz.instanceOf,Clazz.load,Clazz.instantialize,
Clazz.decorateAsClass,Clazz.floatToInt,Clazz.makeConstructor,Clazz.defineEnumConstant,Clazz.exceptionOf,Clazz.newIntArray,Clazz.defineStatics,Clazz.newFloatArray,Clazz.declareType,Clazz.prepareFields,Clazz.superConstructor,Clazz.newByteArray,Clazz.declareInterface,Clazz.p0p,Clazz.pu$h,Clazz.newShortArray,Clazz.innerTypeInstance,Clazz.isClassDefined,Clazz.prepareCallback,Clazz.newArray,Clazz.castNullAs,Clazz.floatToShort,Clazz.superCall,Clazz.decorateAsType,Clazz.newBooleanArray,Clazz.newCharArray,
Clazz.implementOf,Clazz.newDoubleArray,Clazz.overrideConstructor,Clazz.clone,Clazz.doubleToShort,Clazz.getInheritedLevel,Clazz.getParamsType,Clazz.isAF,Clazz.isAI,Clazz.isAS,Clazz.isASS,Clazz.isAP,Clazz.isAFloat,Clazz.isAII,Clazz.isAFF,Clazz.isAFFF,Clazz.tryToSearchAndExecute,Clazz.getStackTrace,Clazz.inheritArgs);
