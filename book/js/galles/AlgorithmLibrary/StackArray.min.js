// Copyright 2011 David Galles, University of San Francisco. All rights reserved.
//
// Redistribution and use in source and binary forms, with or without modification, are
// permitted provided that the following conditions are met:
//
// 1. Redistributions of source code must retain the above copyright notice, this list of
// conditions and the following disclaimer.
//
// 2. Redistributions in binary form must reproduce the above copyright notice, this list
// of conditions and the following disclaimer in the documentation and/or other materials
// provided with the distribution.
//
// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED
// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND
// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR
// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON
// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF
// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
// The views and conclusions contained in the software and documentation are those of the
// authors and should not be interpreted as representing official policies, either expressed
// or implied, of the University of San Francisco

function StackArray(t,i,h){this.init(t,i,h)}function init(){var t=initCanvas();currentAlg=new StackArray(t,canvas.width,canvas.height)}var ARRAY_START_X=100,ARRAY_START_Y=200,ARRAY_ELEM_WIDTH=50,ARRAY_ELEM_HEIGHT=50,ARRRAY_ELEMS_PER_LINE=15,ARRAY_LINE_SPACING=130,TOP_POS_X=180,TOP_POS_Y=100,TOP_LABEL_X=130,TOP_LABEL_Y=100,PUSH_LABEL_X=50,PUSH_LABEL_Y=30,PUSH_ELEMENT_X=120,PUSH_ELEMENT_Y=30,SIZE=30;StackArray.prototype=new Algorithm,StackArray.prototype.constructor=StackArray,StackArray.superclass=Algorithm.prototype,StackArray.prototype.init=function(t,i,h){StackArray.superclass.init.call(this,t,i,h),this.addControls(),this.nextIndex=0,this.commands=[],this.setup(),this.initialIndex=this.nextIndex},StackArray.prototype.addControls=function(){this.controls=[],this.pushField=addControlToAlgorithmBar("Text",""),this.pushField.onkeydown=this.returnSubmit(this.pushField,this.pushCallback.bind(this),6),this.pushButton=addControlToAlgorithmBar("Button","Dodaj"),this.pushButton.onclick=this.pushCallback.bind(this),this.controls.push(this.pushField),this.controls.push(this.pushButton),this.popButton=addControlToAlgorithmBar("Button","Odstrani"),this.popButton.onclick=this.popCallback.bind(this),this.controls.push(this.popButton),this.clearButton=addControlToAlgorithmBar("Button","Sprazni sklad"),this.clearButton.onclick=this.clearCallback.bind(this),this.controls.push(this.clearButton)},StackArray.prototype.enableUI=function(t){for(var i=0;i<this.controls.length;i++)this.controls[i].disabled=!1},StackArray.prototype.disableUI=function(t){for(var i=0;i<this.controls.length;i++)this.controls[i].disabled=!0},StackArray.prototype.setup=function(){this.nextIndex=0,this.arrayID=new Array(SIZE),this.arrayLabelID=new Array(SIZE);for(var t=0;SIZE>t;t++)this.arrayID[t]=this.nextIndex++,this.arrayLabelID[t]=this.nextIndex++;this.topID=this.nextIndex++,this.topLabelID=this.nextIndex++,this.arrayData=new Array(SIZE),this.top=0,this.leftoverLabelID=this.nextIndex++,this.commands=new Array;for(var t=0;SIZE>t;t++){var i=t%ARRRAY_ELEMS_PER_LINE*ARRAY_ELEM_WIDTH+ARRAY_START_X,h=Math.floor(t/ARRRAY_ELEMS_PER_LINE)*ARRAY_LINE_SPACING+ARRAY_START_Y;this.cmd("CreateRectangle",this.arrayID[t],"",ARRAY_ELEM_WIDTH,ARRAY_ELEM_HEIGHT,i,h),this.cmd("CreateLabel",this.arrayLabelID[t],t,i,h+ARRAY_ELEM_HEIGHT),this.cmd("SetForegroundColor",this.arrayLabelID[t],"#0000FF")}this.cmd("CreateLabel",this.topLabelID,"Vrh",TOP_LABEL_X,TOP_LABEL_Y),this.cmd("CreateRectangle",this.topID,0,ARRAY_ELEM_WIDTH,ARRAY_ELEM_HEIGHT,TOP_POS_X,TOP_POS_Y),this.cmd("CreateLabel",this.leftoverLabelID,"",PUSH_LABEL_X,PUSH_LABEL_Y),this.highlight1ID=this.nextIndex++,this.highlight2ID=this.nextIndex++,this.animationManager.StartNewAnimation(this.commands),this.animationManager.skipForward(),this.animationManager.clearHistory()},StackArray.prototype.reset=function(){this.top=0,this.nextIndex=this.initialIndex},StackArray.prototype.pushCallback=function(t){if(this.top<SIZE&&""!=this.pushField.value){var i=this.pushField.value;this.pushField.value="",this.implementAction(this.push.bind(this),i)}},StackArray.prototype.popCallback=function(t){this.top>0&&this.implementAction(this.pop.bind(this),"")},StackArray.prototype.clearCallback=function(t){this.implementAction(this.clearData.bind(this),"")},StackArray.prototype.clearData=function(t){return this.commands=new Array,this.clearAll(),this.commands},StackArray.prototype.push=function(t){this.commands=new Array;var i=this.nextIndex++,h=this.nextIndex++;this.arrayData[this.top]=t,this.cmd("SetText",this.leftoverLabelID,""),this.cmd("CreateLabel",i,"Dodajam: ",PUSH_LABEL_X,PUSH_LABEL_Y),this.cmd("CreateLabel",h,t,PUSH_ELEMENT_X,PUSH_ELEMENT_Y),this.cmd("Step"),this.cmd("CreateHighlightCircle",this.highlight1ID,"#0000FF",TOP_POS_X,TOP_POS_Y),this.cmd("Step");var s=this.top%ARRRAY_ELEMS_PER_LINE*ARRAY_ELEM_WIDTH+ARRAY_START_X,e=Math.floor(this.top/ARRRAY_ELEMS_PER_LINE)*ARRAY_LINE_SPACING+ARRAY_START_Y;return this.cmd("Move",this.highlight1ID,s,e+ARRAY_ELEM_HEIGHT),this.cmd("Step"),this.cmd("Move",h,s,e),this.cmd("Step"),this.cmd("Settext",this.arrayID[this.top],t),this.cmd("Delete",h),this.cmd("Delete",this.highlight1ID),this.cmd("SetHighlight",this.topID,1),this.cmd("Step"),this.top=this.top+1,this.cmd("SetText",this.topID,this.top),this.cmd("Delete",i),this.cmd("Step"),this.cmd("SetHighlight",this.topID,0),this.commands},StackArray.prototype.pop=function(t){this.commands=new Array;var i=this.nextIndex++,h=this.nextIndex++;this.cmd("SetText",this.leftoverLabelID,""),this.cmd("CreateLabel",i,"Odstranjujem ...",PUSH_LABEL_X,PUSH_LABEL_Y),this.cmd("SetHighlight",this.topID,1),this.cmd("Step"),this.top=this.top-1,this.cmd("SetText",this.topID,this.top),this.cmd("Step"),this.cmd("SetHighlight",this.topID,0),this.cmd("CreateHighlightCircle",this.highlight1ID,"#0000FF",TOP_POS_X,TOP_POS_Y),this.cmd("Step");var s=this.top%ARRRAY_ELEMS_PER_LINE*ARRAY_ELEM_WIDTH+ARRAY_START_X,e=Math.floor(this.top/ARRRAY_ELEMS_PER_LINE)*ARRAY_LINE_SPACING+ARRAY_START_Y;return this.cmd("Move",this.highlight1ID,s,e+ARRAY_ELEM_HEIGHT),this.cmd("Step"),this.cmd("CreateLabel",h,this.arrayData[this.top],s,e),this.cmd("Settext",this.arrayID[this.top],""),this.cmd("Move",h,PUSH_ELEMENT_X,PUSH_ELEMENT_Y),this.cmd("Step"),this.cmd("Delete",h),this.cmd("Delete",i),this.cmd("Delete",this.highlight1ID),this.cmd("SetText",this.leftoverLabelID,"Odstranjeno: "+this.arrayData[this.top]),this.commands},StackArray.prototype.clearAll=function(){this.commands=new Array;for(var t=0;t<this.top;t++)this.cmd("SetText",this.arrayID[t],"");return this.top=0,this.cmd("SetText",this.topID,"0"),this.commands};var currentAlg;