function UIElement(e,t,n,r,i,s,o,u,a,f){this.x=e;this.y=t;this.oldX=n;this.oldY=r;this.x2=e+i;this.y2=t+s;this.oldX2=n+i;this.oldY2=r+s;this.type=o;this.ref=u}function Bead(){this.position=[0,0];this.oldPosition=[0,0];this.value=0;this.active=false;this.uniqueID=-1}function AbacusCtrl(e,t){this.type=e;this.beadLines=8;this.beadPerLine=this.type?7:5;this.beadSep=this.type?4:3;this.beadHeight=40*t;this.beadSpacing=80*t;this.beadWidth=60*t;this.nodes=new Array;this.init=function(){this.nodes.length=0;var e=0;for(var t=0;t<this.beadLines;t++){for(var n=0;n<this.beadPerLine;n++){var r=new Bead;r.position[0]=(this.beadLines-1)*this.beadSpacing+20-t*this.beadSpacing;r.position[1]=this.beadHeight+20+this.beadPerLine*this.beadHeight-n*this.beadHeight;r.oldPosition[0]=r.position[0];r.oldPosition[1]=r.position[1];r.value=1;if(n>this.beadSep){r.position[1]=this.beadHeight+20+this.beadPerLine*this.beadHeight-(n*this.beadHeight+2*this.beadHeight);r.oldPosition[1]=r.position[1];r.value=5}r.uniqueID=e;this.nodes.push(r);e++}}};this.getBeadsCount=function(){return this.nodes.length};this.getBeadPositionX=function(e){return this.nodes[e].position[0]};this.getBeadPositionY=function(e){return this.nodes[e].position[1]};this.getOldBeadPositionX=function(e){return this.nodes[e].oldPosition[0]};this.getOldBeadPositionY=function(e){return this.nodes[e].oldPosition[1]};this.setOldBeadPositionY=function(e,t){this.nodes[e].oldPosition[1]=t};this.checkBeadActive=function(e){return this.nodes[e].active};this.checkBeadValue=function(e){return this.nodes[e].value};this.activated=function(e){var t=Math.floor(e/this.beadPerLine);var n=e-t*this.beadPerLine;var r=this.nodes[e].active;this.nodes[e].active=!r;var i=1;if(n>this.beadSep)i=-1;var s=i*-1*this.beadHeight;if(r)s=i*this.beadHeight;this.nodes[e].position[1]+=s;if(n<=this.beadSep){for(var o=0;o<this.beadPerLine;o++){var u=t*this.beadPerLine+o;if(o<=this.beadSep&&o!==n){if(!r&&o>n||r&&o<n){if(this.nodes[u].active===r){this.nodes[u].oldPosition[1]=this.nodes[u].position[1];this.nodes[u].position[1]+=s;this.nodes[u].active=!this.nodes[u].active}}}}}else{for(var o=0;o<this.beadPerLine;o++){var u=t*this.beadPerLine+o;if(o>this.beadSep&&o!==n){if(!r&&o<n||r&&o>n){if(this.nodes[u].active===r){this.nodes[u].oldPosition[1]=this.nodes[u].position[1];this.nodes[u].position[1]+=s;this.nodes[u].active=!this.nodes[u].active}}}}}}}function Abacus(e,t,n){function p(){all=true;var e=r.getBeadsCount();for(var t=0;t<e;t++){var n=r.getBeadPositionY(t);var i=r.getOldBeadPositionY(t);if(i!=n){all=false;r.setOldBeadPositionY(t,i+ -((i-n)/Math.abs(i-n))*1)}}h.update();if(!all){setTimeout(p,5)}}function d(e,t,n){ctx.fillStyle="rgba(255,255,255,1.0)";ctx.textAlign="left";ctx.font="10pt sans-serif";ctx.fillText(e,t-22,n-8);ctx.lineWidth=1}function v(e,t){var n=r.getBeadPositionX(e);var i=r.getBeadPositionY(e);var s=r.getOldBeadPositionX(e);var a=r.getOldBeadPositionY(e);var c=new UIElement(n,i,s,a,r.beadWidth,r.beadHeight-Math.round(r.beadHeight/10),0,e,0,0);t.fillStyle="rgba(60,60,60,0.3)";S(t,c.oldX+4,c.oldY+4,c.oldX2-c.oldX,c.oldY2-c.oldY,r.beadHeight-4);t.fillStyle=o;if(e===f){t.fillStyle=u}S(t,c.oldX,c.oldY,c.oldX2-c.oldX,c.oldY2-c.oldY,r.beadHeight-4);if(uvod_bool&&e<10){text_izpis=1;if((e+1)%5===0){text_izpis=5}text_izpis*=Math.pow(10,Math.floor(e/5));d(text_izpis,c.oldX2,c.oldY2)}t.fillStyle="rgba(255, 255, 255, 1.0)";l.push(c);if(false){t.fillStyle="rgba(0,0,0,1.0)";t.textAlign="left";t.font="10pt sans-serif";t.fillText("1",c.x+6,c.y2-11);t.lineWidth=1}}function m(e){var t=r.getBeadsCount();for(var n=0;n<t;n++){v(n,e,false)}}function g(e){var t=-1;for(var n in l){if(l[n].type!==2){if(l[n].x-1<e.x&&l[n].x2+1>e.x&&l[n].y-1<e.y&&l[n].y2+1>e.y){t=n}}}return t}function y(e){var t=E(e);if(!e.altKey&&e.which===1){var n=g(t);if(n!==-1){if(l[n].type===0){var i=l[n].ref;r.activated(i)}}p()}e.preventDefault()}function b(e){}function w(e){var t=E(e);f=-1;var n=a;a=g(t);if(a!==-1){f=l[a].ref}if(n!==a)h.update();oldPos=t;e.preventDefault()}function E(e){var t=i;var n=0,r=0,s,o;if(t.offsetParent!==undefined){do{n+=t.offsetLeft;r+=t.offsetTop}while(t=t.offsetParent)}s=e.pageX-n;o=e.pageY-r;return{x:s,y:o}}function S(e,t,n,r,i,s){var o=e.lineWidth;var u=e.strokeStyle;e.strokeStyle=e.fillStyle;e.lineJoin="round";e.lineWidth=s;e.strokeRect(t+s/2,n+s/2,r-s,i-s);e.fillRect(t+s/2,n+s/2,r-s,i-s);e.lineWidth=o;e.strokeStyle=u}var r=new AbacusCtrl(t,n);var n=n;var i;var s=e;var o="rgba(46,145,178,1.0)";var u="rgba(255,165,0,1.0)";var a=-1;var f=-1;var l=new Array;var c=0;var h=this;this.init=function(){r.init();i=document.createElement("canvas");if(!i)console.log("Abacus error: can not create a canvas element");i.id=e+"_Abacus";i.width=r.beadSpacing/2+r.beadLines*r.beadSpacing;i.height=r.beadHeight*2+(r.beadPerLine+2)*r.beadHeight;document.body.appendChild(i);var t=document.getElementById(s);if(!t)console.log("Abacus error: can not find an element with the given name: "+s);t.appendChild(i);i.onmousedown=function(e){y(e)};i.onmousemove=function(e){w(e)};i.onmouseup=function(e){b(e)};this.update()};this.check=function(e){if(c===e){return true}else{return false}};this.setAll=function(e){uvod_bool=true;switch(e){case 0:r.activated(1);arAc=[1];console.log("prvi");break;case 1:r.activated(3);r.activated(4);console.log("drugi");arac=[4];break;case 2:r.activated(1);console.log("tretji");arac=[1,4];break;case 3:r.activated(9);console.log("cetrti");arac=[1,4,9];break;case 4:r.activated(8);console.log("peti");arac=[1,4,8,9];break;default:uvod_bool=false;arAc=[];console.log("Wrong number of test!")}p()};this.resetAll=function(){var e=r.getBeadsCount();for(var t=0;t<e;t++){if(r.checkBeadActive(t)&&r.checkBeadValue(t)==1||r.checkBeadActive(t)&&r.checkBeadValue(t)==5)r.activated(t)}p()};this.update=function(){i.width=i.width;l.length=0;ctx=i.getContext("2d");ctx.strokeStyle="#000000";ctx.lineWidth=Math.floor(r.beadSpacing/20)+1;for(var e=0;e<r.beadLines;e++){var t=(r.beadLines-1)*r.beadSpacing+20+r.beadWidth/2-e*r.beadSpacing;var n=20+(r.beadPerLine+2)*r.beadHeight;ctx.beginPath();ctx.moveTo(t,20);ctx.lineTo(t,n);ctx.stroke()}for(var s=0;s<3;s++){var n=20;if(s===1)n=20+(r.beadPerLine-r.beadSep)*r.beadHeight;if(s===2)n=20+(r.beadPerLine+2)*r.beadHeight;ctx.beginPath();ctx.moveTo(20,n);ctx.lineTo(r.beadLines*r.beadSpacing+20,n);ctx.stroke()}ctx.lineWidth=1;m(ctx);ctx.fillStyle="rgba(0,0,0,1.0)";ctx.textAlign="center";ctx.font="20pt sans-serif";var o=50+(r.beadPerLine+2)*r.beadHeight;c=0;for(var e=0;e<r.beadLines;e++){var u=-30+r.beadLines*r.beadSpacing-e*r.beadSpacing;var a=0;for(var s=0;s<r.beadPerLine;s++){var f=e*r.beadPerLine+s;if(r.nodes[f].active){a+=r.nodes[f].value}}var h;if(r.type===0){h=a.toString(10)}else{h=a.toString(16)}c+=Math.pow(10,e)*a}}}var ctx;var arAc;var uvod_bool=false