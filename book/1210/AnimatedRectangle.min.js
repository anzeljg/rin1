// Copyright 2011 David Galles, University of San Francisco. All rights reserved.
//
// Redistribution and use in source and binary forms, with or without modification, are
// permitted provided that the following conditions are met:
//
// 1. Redistributions of source code must retain the above copyright notice, this list of
// conditions and the following disclaimer.
//
// 2. Redistributions in binary form must reproduce the above copyright notice, this list
// of conditions and the following disclaimer in the documentation and/or other materials
// provided with the distribution.
//
// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED
// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND
// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR
// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON
// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF
// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
// The views and conclusions contained in the software and documentation are those of the
// authors and should not be interpreted as representing official policies, either expressed
// or implied, of the University of San Francisco

// Values for xJust / yJust:  "center", "left", "right", "top", "bottom"

function UndoDeleteRectangle(e,t,n,r,i,s,o,u,a,f,l,c){this.objectID=e;this.posX=n;this.posY=r;this.width=i;this.height=s;this.xJustify=o;this.yJustify=u;this.backgroundColor=a;this.foregroundColor=f;this.nodeLabel=t;this.layer=c;this.highlighted=l}AnimatedRectangle=function(e,t,n,r,i,s,o,u){this.w=n;this.h=r;this.xJustify=i;this.yJustify=s;this.label=t;this.labelColor=u;this.backgroundColor=o;this.foregroundColor=u;this.labelColor=this.foregroundColor;this.highlighted=false;this.objectID=e;this.nullPointer=false;this.alpha=1;this.addedToScene=true};AnimatedRectangle.prototype=new AnimatedObject;AnimatedRectangle.prototype.constructor=AnimatedRectangle;AnimatedRectangle.prototype.setNull=function(e){this.nullPointer=e};AnimatedRectangle.prototype.getNull=function(){return this.nullPointer};AnimatedRectangle.prototype.left=function(){if(this.xJustify=="left"){return this.x}else if(this.xJustify=="center"){return this.x-this.w/2}else{return this.x-this.w}};AnimatedRectangle.prototype.centerX=function(){if(this.xJustify=="center"){return this.x}else if(this.xJustify=="left"){return this.x+this.w/2}else{return this.x-this.w/2}};AnimatedRectangle.prototype.centerY=function(){if(this.yJustify=="center"){return this.y}else if(this.yJustify=="top"){return this.y+this.h/2}else{return this.y-this.w/2}};AnimatedRectangle.prototype.top=function(){if(this.yJustify=="top"){return this.y}else if(this.yJustify=="center"){return this.y-this.h/2}else{return this.y-this.h}};AnimatedRectangle.prototype.bottom=function(){if(this.yJustify=="top"){return this.y+this.h}else if(this.yJustify=="center"){return this.y+this.h/2}else{return this.y}};AnimatedRectangle.prototype.right=function(){if(this.xJustify=="left"){return this.x+this.w}else if(this.xJustify=="center"){return this.x+this.w/2}else{return this.x}};AnimatedRectangle.prototype.getHeadPointerAttachPos=function(e,t){return this.getClosestCardinalPoint(e,t)};AnimatedRectangle.prototype.setWidth=function(e){this.w=e};AnimatedRectangle.prototype.setHeight=function(e){this.h=e};AnimatedRectangle.prototype.getWidth=function(){return this.w};AnimatedRectangle.prototype.getHeight=function(){return this.h};AnimatedRectangle.prototype.draw=function(e){if(!this.addedToScene){return}var t;var n;var r;var i;e.globalAlpha=this.alpha;if(this.xJustify=="left"){t=this.x;r=this.x+this.w/2}else if(this.xJustify=="center"){t=this.x-this.w/2;r=this.x}else if(this.xJustify=="right"){t=this.x-this.w;r=this.x-this.w/2}if(this.yJustify=="top"){n=this.y;i=this.y+this.h/2}else if(this.yJustify=="center"){n=this.y-this.h/2;i=this.y}else if(this.yJustify=="bottom"){n=this.y-this.h;i=this.y-this.h/2}e.lineWidth=1;if(this.highlighted){e.strokeStyle="#ff0000";e.fillStyle="#ff0000";e.beginPath();e.moveTo(t-this.highlightDiff,n-this.highlightDiff);e.lineTo(t+this.w+this.highlightDiff,n-this.highlightDiff);e.lineTo(t+this.w+this.highlightDiff,n+this.h+this.highlightDiff);e.lineTo(t-this.highlightDiff,n+this.h+this.highlightDiff);e.lineTo(t-this.highlightDiff,n-this.highlightDiff);e.closePath();e.stroke();e.fill()}e.strokeStyle=this.foregroundColor;e.fillStyle=this.backgroundColor;e.beginPath();e.moveTo(t,n);e.lineTo(t+this.w,n);e.lineTo(t+this.w,n+this.h);e.lineTo(t,n+this.h);e.lineTo(t,n);e.closePath();e.stroke();e.fill();if(this.nullPointer){e.beginPath();e.moveTo(t,n);e.lineTo(t+this.w,n+this.h);e.closePath();e.stroke()}e.fillStyle=this.labelColor;e.textAlign="center";e.font="10px sans-serif";e.textBaseline="middle";e.lineWidth=1;e.fillText(this.label,this.x,this.y)};AnimatedRectangle.prototype.setText=function(e,t){this.label=e};AnimatedRectangle.prototype.createUndoDelete=function(){return new UndoDeleteRectangle(this.objectID,this.label,this.x,this.y,this.w,this.h,this.xJustify,this.yJustify,this.backgroundColor,this.foregroundColor,this.highlighted,this.layer)};AnimatedRectangle.prototype.setHighlight=function(e){this.highlighted=e};UndoDeleteRectangle.prototype=new UndoBlock;UndoDeleteRectangle.prototype.constructor=UndoDeleteRectangle;UndoDeleteRectangle.prototype.undoInitialStep=function(e){e.addRectangleObject(this.objectID,this.nodeLabel,this.width,this.height,this.xJustify,this.yJustify,this.backgroundColor,this.foregroundColor);e.setNodePosition(this.objectID,this.posX,this.posY);e.setLayer(this.objectID,this.layer);e.setHighlight(this.objectID,this.highlighted)}